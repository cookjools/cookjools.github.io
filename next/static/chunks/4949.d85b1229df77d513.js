"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4949],{44949:function(e,t,n){n.r(t),n.d(t,{default:function(){return f}});var i=n(43777),r=n(47903),o=n(58262),a=n(47891),s=n(75285),l=(0,s.b)(((e,t)=>{!function(i,r){var o=r.jQuery;"object"==typeof e?t.exports=o?i(r,o):function(e){return i(r,e)}:"function"==typeof define&&n.amdO?define(["jquery"],(function(e){return i(r,e)})):i(r,!1)}((function(e,t){var n=!1===t;if(!(t=t||e.jQuery)||!t.fn)throw"JsViews requires jQuery";var i,r,o,a,s,l,u,c,p,f,h,d,g,v,_,y,m,E,I,T,b,A,O,C,S="v0.9.83",L=/^(!*?)(?:null|true|false|\d[\d.]*|([\w$]+|\.|~([\w$]+)|#(view|([\w$]+))?)([\w$.^]*?)(?:[.[^]([\w$]+)\]?)?)$/g,x=/(\()(?=\s*\()|(?:([([])\s*)?(?:(\^?)(!*?[#~]?[\w$.^]+)?\s*((\+\+|--)|\+|-|&&|\|\||===|!==|==|!=|<=|>=|[<>%*:?\/]|(=))\s*|(!*?[#~]?[\w$.^]+)([([])?)|(,\s*)|(\(?)\\?(?:(')|("))|(?:\s*(([)\]])(?=\s*[.^]|\s*$|[^([])|[)\]])([([]?))|(\s+)/g,N=/[ \t]*(\r\n|\n|\r)/g,R=/\\(['"])/g,P=/['"\\]/g,w=/(?:\x08|^)(onerror:)?(?:(~?)(([\w$_\.]+):)?([^\x08]+))\x08(,)?([^\x08]+)/gi,M=/^if\s/,D=/<(\w+)[>\s]/,U=/[\x00`><\"'&=]/,V=/^on[A-Z]|^convert(Back)?$/,j=/^\#\d+_`[\s\S]*\/\d+_`$/,k=/[\x00`><"'&=]/g,G=0,F={"&":"&amp;","<":"&lt;",">":"&gt;","\0":"&#0;","'":"&#39;",'"':"&#34;","`":"&#96;","=":"&#61;"},H="html",B="object",q="data-jsv-tmpl",Y="jsvTmpl",K="For #index in nested block use #getIndex().",W={},X=e.jsrender,z=X&&t&&!t.render,Q={template:{compile:function e(n,i,r,o){function s(i){var a,s;if(""+i===i||i.nodeType>0&&(l=i)){if(!l)if(/^\.\/[^\\:*?"<>]*$/.test(i))(s=f[n=n||i])?i=s:l=document.getElementById(i);else if(t.fn&&!v.rTmpl.test(i))try{l=t(document).find(i)[0]}catch{}l&&(o?i=l.innerHTML:((a=l.getAttribute(q))?a!==Y?(i=f[a],delete f[a]):t.fn&&(i=t.data(l)[Y]):(n=n||(t.fn?Y:i),i=e(n,l.innerHTML,r,o)),i.tmplName=n=n||a,n!==Y&&(f[n]=i),l.setAttribute(q,n),t.fn&&t.data(l,Y,i))),l=void 0}else i.fn||(i=void 0);return i}var l,u,c=i=i||"";if(0===o&&(o=void 0,c=s(c)),(o=o||(i.markup?i:{})).tmplName=n,r&&(o._parentTmpl=r),!c&&i.markup&&(c=s(i.markup))&&c.fn&&(c=c.markup),void 0!==c)return c.fn||i.fn?c.fn&&(u=c):(i=ce(c,o),me(c.replace(P,"\\$&"),i)),u||(u=ie((function(){return u.render.apply(u,arguments)}),i),function(e){var t,n,i;for(t in Q)e[n=t+"s"]&&(i=e[n],e[n]={},a[n](i,e))}(u)),n&&!r&&n!==Y&&(W[n]=u),u}},tag:{compile:function(e,t,n){var i,r,o,a=new v._tg;function s(){this._={inline:!0,unlinked:!0},this.tagName=e}if(c(t)?t={depends:t.depends,render:t}:""+t===t&&(t={template:t}),r=t.baseTag)for(o in t.flow=!!t.flow,t.baseTag=r=""+r===r?n&&n.tags[r]||g[r]:r,a=ie(a,r),t)a[o]=J(r[o],t[o]);else a=ie(a,t);return void 0!==(i=a.template)&&(a.template=""+i===i?f[i]||f(i):i),!1!==a.init&&((s.prototype=a).constructor=a._ctr=s),n&&(a._parentTmpl=n),a}},viewModel:{compile:function(e,n){var i,r,o=this,a=n.getters,s=n.extend,l=n.id,c=t.extend({_is:e||"unnamed",unmap:I,merge:E},s),f="",h="",d=a?a.length:0,g=t.observable,v={};function _(e){r.apply(this,e)}function y(){return new _(arguments)}function m(e,t){var n,i,r,s,l,u=a.length;for(n=0;n<u;n++)i=void 0,(s=a[n])+""!==s&&(s=(i=s).getter),void 0===(l=e[s])&&i&&void 0!==(r=i.defaultVal)&&(l=le(r,e)),t(l,i&&o[i.type],s)}function E(e){e=e+""===e?JSON.parse(e):e;var t,n,i,r,o,a,s,c,f,h,d=this;if(p(d)){for(c={},h=[],i=e.length,r=d.length,t=0;t<i;t++){for(f=e[t],s=!1,n=0;n<r&&!s;n++)c[n]||(a=d[n],l&&(c[n]=s=l+""===l?f[l]&&(v[l]?a[l]():a[l])===f[l]:l(a,f)));s?(a.merge(f),h.push(a)):h.push(y.map(f))}g?g(d).refresh(h,!0):d.splice.apply(d,[0,d.length].concat(h))}else for(o in m(e,(function(e,t,n){t?d[n]().merge(e):d[n](e)})),e)o!==u&&!v[o]&&(d[o]=e[o])}function I(){var e,n,i,r,s,l,c=this;if(p(c))return ue(c);for(e={},r=a.length,i=0;i<r;i++)s=void 0,(n=a[i])+""!==n&&(n=(s=n).getter),l=c[n](),e[n]=s&&l&&o[s.type]?p(l)?ue(l):l.unmap():l;for(n in c)"_is"!==n&&!v[n]&&n!==u&&("_"!==n.charAt(0)||!v[n.slice(1)])&&!t.isFunction(c[n])&&(e[n]=c[n]);return e}for(_.prototype=c,i=0;i<d;i++)!function(e){e=e.getter||e,v[e]=i+1;var t="_"+e;f+=(f?",":"")+e,h+="this."+t+" = "+e+";\n",c[e]=c[e]||function(n){if(!arguments.length)return this[t];g?g(this).setProperty(e,n):this[t]=n},g&&(c[e].set=c[e].set||function(e){this[t]=e})}(a[i]);return(r=new Function(f,h.slice(0,-1))).prototype=c,c.constructor=r,y.map=function(t){var n,i,r,o=t=t+""===t?JSON.parse(t):t,a=[];if(p(t)){for(i=(t=t||[]).length,n=0;n<i;n++)a.push(this.map(t[n]));return a._is=e,a.unmap=I,a.merge=E,a}if(t)for(r in m(t,(function(e,t){t&&(e=t.map(e)),a.push(e)})),o=this.apply(this,a),t)r!==u&&!v[r]&&(o[r]=t[r]);return o},y.getters=a,y.extend=s,y.id=l,y}},helper:{},converter:{}};function $(e,t){return function(){var n,i=this,r=i.base;return i.base=e,n=t.apply(i,arguments),i.base=r,n}}function J(e,t){return c(t)&&((t=$(e?e._d?e:$(te,e):te,t))._d=1),t}function Z(e,t){for(var n in t.props)V.test(n)&&(e[n]=J(e[n],t.props[n]))}function ee(e){return e}function te(){return""}function ne(e){this.name=(t.link?"JsViews":"JsRender")+" Error",this.message=e||this.name}function ie(e,t){for(var n in t)e[n]=t[n];return e}function re(e,t,n){return e?p(e)?re.apply(a,e):(_.delimiters=[e,t,A=n?n.charAt(0):A],E=e.charAt(0),I=e.charAt(1),T=t.charAt(0),b=t.charAt(1),e="\\"+E+"(\\"+A+")?\\"+I,t="\\"+T+"\\"+b,r="(?:(\\w+(?=[\\/\\s\\"+T+"]))|(\\w+)?(:)|(>)|(\\*))\\s*((?:[^\\"+T+"]|\\"+T+"(?!\\"+b+"))*?)",v.rTag="(?:"+r+")",r=new RegExp("(?:"+e+r+"(\\/)?|\\"+E+"(\\"+A+")?\\"+I+"(?:(?:\\/(\\w+))\\s*|!--[\\s\\S]*?--))"+t,"g"),v.rTmpl=new RegExp("<.*>|([^\\\\]|^)[{}]|"+e+".*"+t),m):_.delimiters}function oe(){var e=this.get("item");return e?e.index:void 0}function ae(){return this.index}function se(e,t,n,i,r,o,a,s){var l,u,c,p=this,f="array"===t;p.content=s,p.views=f?[]:{},p.parent=n,p.type=t||"top",p.data=i,p.tmpl=r,c=p._={key:0,useKey:f?0:1,id:""+G++,onRender:a,bnds:{}},p.linked=!!a,n?(l=n.views,(u=n._).useKey?(l[c.key="_"+u.useKey++]=p,p.index=K,p.getIndex=oe):l.length===(c.key=p.index=o)?l.push(p):l.splice(o,0,p),p.ctx=e||n.ctx):p.ctx=e}function le(e,n){return t.isFunction(e)?e.call(n):e}function ue(e){var t,n=[],i=e.length;for(t=0;t<i;t++)n.push(e[t].unmap());return n}function ce(e,n){var i,r=y._wm||{},o=ie({tmpls:[],links:{},bnds:[],_is:"template",render:de},n);return o.markup=e,n.htmlTag||(i=D.exec(e),o.htmlTag=i?i[1].toLowerCase():""),(i=r[o.htmlTag])&&i!==r.div&&(o.markup=t.trim(o.markup)),o}function pe(e,t){var n=e+"s";a[n]=function i(r,o,s){var l,u,c,p;if(r&&typeof r===B&&!r.nodeType&&!r.markup&&!r.getTgt&&!("viewModel"===e&&r.getters||r.extend)){for(c in r)i(c,r[c],o);return o||a}return void 0===o&&(o=r,r=void 0),r&&""+r!==r&&(s=o,o=r,r=void 0),p=s?"viewModel"===e?s:s[n]=s[n]||{}:i,u=t.compile,null===o?r&&delete p[r]:(o=u?u.call(p,r,o,s,0):o,r&&(p[r]=o)),u&&o&&(o._is=e),o&&(l=v.onStore[e])&&l(r,o,u),o}}function fe(e){m[e]=function(t){return arguments.length?(_[e]=t,m):_[e]}}function he(e){function t(t,n){this.tgt=e.getTgt(t,n)}return c(e)&&(e={getTgt:e}),e.baseMap&&(e=ie(ie({},e.baseMap),e)),e.map=function(e,n){return new t(e,n)},e}function de(e,t,n,i,r,a){var s,l,u,c,f,h,d,g,_=i,m="";if(!0===t?(n=t,t=void 0):typeof t!==B&&(t=void 0),(u=this.tag)?(f=this,c=(_=_||f.view).getTmpl(u.template||f.tmpl),arguments.length||(e=_)):c=this,c){if(!i&&e&&"view"===e._is&&(_=e),_&&e===_&&(e=_.data),h=!_,C=C||h,_||((t=t||{}).root=e),!C||y.useViews||c.useViews||_&&_!==o)m=ge(c,e,t,n,_,r,a,u);else{if(_?(d=_.data,g=_.index,_.index=K):((_=o).data=e,_.ctx=t),p(e)&&!n)for(s=0,l=e.length;s<l;s++)_.index=s,_.data=e[s],m+=c.fn(e[s],_,v);else _.data=e,m+=c.fn(e,_,v);_.data=d,_.index=g}h&&(C=void 0)}return m}function ge(e,t,n,i,r,o,a,s){function l(e){(I=ie({},n))[E]=e}var u,c,f,h,d,g,_,y,m,E,I,T,b="";if(s&&(m=s.tagName,T=s.tagCtx,n=n?Oe(n,s.ctx):s.ctx,e===r.content?_=e!==r.ctx._wrp?r.ctx._wrp:void 0:e!==T.content?e===s.template?(_=T.tmpl,n._wrp=T.content):_=T.content||r.content:_=r.content,!1===T.props.link&&((n=n||{}).link=!1),(E=T.props.itemVar)&&("~"!==E.charAt(0)&&ye("Use itemVar='~myItem'"),E=E.slice(1))),r&&(a=a||r._.onRender,n=Oe(n,r.ctx)),!0===o&&(g=!0,o=0),a&&(n&&!1===n.link||s&&s._.noVws)&&(a=void 0),y=a,!0===a&&(y=void 0,a=r._.onRender),n=e.helpers?Oe(e.helpers,n):n,I=n,p(t)&&!i)for(f=g?r:void 0!==o&&r||new se(n,"array",r,t,e,o,a,_),r&&r._.useKey&&(f._.bnd=!s||s._.bnd&&s),E&&(f.it=E),E=f.it,u=0,c=t.length;u<c;u++)E&&l(t[u]),h=new se(I,"item",f,t[u],e,(o||0)+u,a,f.content),d=e.fn(t[u],h,v),b+=f._.onRender?f._.onRender(d,h):d;else E&&l(t),f=g?r:new se(I,m||"data",r,t,e,o,a,_),s&&!s.flow&&(f.tag=s,s.view=f),b+=e.fn(t,f,v);return y?y(b,f):b}function ve(e,t,n){var i=void 0!==n?c(n)?n.call(t.data,e,t):n||"":"{Error: "+e.message+"}";return _.onError&&void 0!==(n=_.onError.call(t.data,e,n&&i,t))&&(i=n),t&&!t.linkCtx?h.html(i):i}function _e(e){throw new v.Err(e)}function ye(e){_e("Syntax error\n"+e)}function me(e,t,n,i,o){function a(t){(t-=g)&&y.push(e.substr(g,t).replace(N,"\\n"))}function s(t,n){t&&(t+="}}",ye((n?"{{"+n+"}} block has {{/"+t+" without {{"+t:"Unmatched or missing {{/"+t)+", in template:\n"+e))}var l,u,c,p,f,h=_.allowCode||t&&t.allowCode||!0===m.allowCode,d=[],g=0,v=[],y=d,I=[,,d];if(h&&t._is&&(t.allowCode=h),n&&(void 0!==i&&(e=e.slice(0,-i.length-2)+T),e=E+e+b),s(v[0]&&v[0][2].pop()[0]),e.replace(r,(function(r,l,u,f,d,_,m,E,T,b,A,O){(m&&l||T&&!u||E&&":"===E.slice(-1)||b)&&ye(r),_&&(d=":",f=H);var C=(l||n)&&[[]],S="",L="",x="",P="",D="",U="",j="",k="",G=!(T=T||n&&!o)&&!d;u=u||(E=E||"#data",d),a(O),g=O+r.length,m?h&&y.push(["*","\n"+E.replace(/^:/,"ret+= ").replace(R,"$1")+";\n"]):u?("else"===u&&(M.test(E)&&ye('for "{{else if expr}}" use "{{else expr}}"'),C=I[7]&&[[]],I[8]=e.substring(I[8],O),I=v.pop(),y=I[2],G=!0),E&&be(E.replace(N," "),C,t).replace(w,(function(e,t,n,i,r,o,a,s){return i="'"+r+"':",a?(L+=o+",",P+="'"+s+"',"):n?(x+=i+"j._cp("+o+',"'+s+'",view),',U+=i+"'"+s+"',"):t?j+=o:("trigger"===r&&(k+=o),S+=i+o+",",D+=i+"'"+s+"',",p=p||V.test(r)),""})).slice(0,-1),C&&C[0]&&C.pop(),c=[u,f||!!i||p||"",G&&[],Ie(P||(":"===u?"'#data',":""),D,U),Ie(L||(":"===u?"data,":""),S,x),j,k,C||0],y.push(c),G&&(v.push(I),(I=c)[8]=g)):A&&(s(A!==I[0]&&"else"!==I[0]&&A,I[0]),I[8]=e.substring(I[8],O),I=v.pop()),s(!I&&A),y=I[2]})),a(e.length),(g=d[d.length-1])&&s(""+g!==g&&+g[8]===g[8]&&g[0]),n){for(u=Ae(d,e,n),f=[],l=d.length;l--;)f.unshift(d[l][7]);Ee(u,f)}else u=Ae(d,t);return u}function Ee(e,t){var n,i,r=0,o=t.length;for(e.deps=[],e.paths=[];r<o;r++)for(n in e.paths.push(i=t[r]),i)"_jsvto"!==n&&i.hasOwnProperty(n)&&i[n].length&&!i[n].skp&&(e.deps=e.deps.concat(i[n]))}function Ie(e,t,n){return[e.slice(0,-1),t.slice(0,-1),n.slice(0,-1)]}function Te(e,t){return"\n\t"+(t?t+":{":"")+"args:["+e[0]+"]"+(e[1]||!t?",\n\tprops:{"+e[1]+"}":"")+(e[2]?",\n\tctx:{"+e[2]+"}":"")}function be(e,t,n){var i,r,a,s,l,u=t&&t[0],c={bd:u},p={0:c},f=0,h=(n?n.links:u&&(u.links=u.links||{}))||o.tmpl.links,d=0,g={},v={},_=(e+(n?" ":"")).replace(x,(function(o,_,y,m,E,b,A,O,C,S,x,N,R,P,w,M,D,U,V,j){m&&!O&&(E=m+E),b=b||"",y=y||_||N,E=E||C;var k,G,F,H,B,q=")";if("["===(S=S||D||"")&&(S="[j._sq(",q=")]"),!A||l||s){if(u&&M&&!l&&!s&&(!i||a||r)&&(k=v[d-1],j.length-1>V-(k||0))){if(k=j.slice(k,V+o.length),!0!==G)if(F=r||p[d-1].bd,(H=F[F.length-1])&&H.prm){for(;H.sb&&H.sb.prm;)H=H.sb;B=H.sb={path:H.sb,bnd:H.bnd}}else F.push(B={path:F.pop()});(G=h[M=I+":"+k+" onerror=''"+T])||(h[M]=!0,h[M]=G=me(M,n,!0)),!0!==G&&B&&(B._jsv=G,B.prm=c.bd,B.bnd=B.bnd||B.path&&B.path.indexOf("^")>=0)}return l?(l=!R)?o:N+'"':s?(s=!P)?o:N+'"':(y?(v[d]=V++,c=p[++d]={bd:[]},y):"")+(U?d?"":(f=j.slice(f,V),(i?(i=a=r=!1,"\b"):"\b,")+f+(f=V+o.length,u&&t.push(c.bd=[]),"\b")):O?(d&&ye(e),u&&t.pop(),i=E,a=m,f=V+o.length,u&&((u=c.bd=t[i]=[]).skp=!m),E+":"):E?E.split("^").join(".").replace(L,(function(e,n,o,a,s,l,p,f){var h="."===o;if(o&&(E=E.slice(n.length),/^\.?constructor$/.test(f||E)&&ye(e),h||(e=(a?'view.hlp("'+a+'")':s?"view":"data")+(f?(l?"."+l:a||s?"":"."+o)+(p||""):(f=a?"":s?l||"":o,"")),e=n+("view.data"===(e+=f?"."+f:"").slice(0,9)?e.slice(5):e)),u)){if(F="linkTo"===i?r=t._jsvto=t._jsvto||[]:c.bd,H=h&&F[F.length-1]){if(H._jsv){for(;H.sb;)H=H.sb;H.bnd&&(E="^"+E.slice(1)),H.sb=E,H.bnd=H.bnd||"^"===E.charAt(0)}}else F.push(E);v[d]=V+(h?1:0)}return e}))+(S?(c=p[++d]={bd:[]},g[d]=q,S):b):b||(w?(w=g[d]||w,g[d]=!1,c=p[--d],w+(S?(c=p[++d],g[d]=q,S):"")):x?(g[d]||ye(e),","):_?"":(l=R,s=P,'"')))}ye(e)}));return!d&&_||ye(e)}function Ae(e,t,n){var i,r,o,a,s,l,u,c,p,f,h,d,v,m,E,I,T,b,A,O,C,S,L,x,P,w,M,D,U,V=0,j=y.useViews||t.useViews||t.tags||t.templates||t.helpers||t.converters,k="",G={},F=e.length;for(""+t===t?(T=n?'data-link="'+t.replace(N," ").slice(1,-1)+'"':t,t=0):(T=t.tmplName||"unnamed",t.allowCode&&(G.allowCode=!0),t.debug&&(G.debug=!0),f=t.bnds,I=t.tmpls),i=0;i<F;i++)if(""+(r=e[i])===r)k+='\n+"'+r+'"';else if("*"===(o=r[0]))k+=";\n"+r[1]+"\nret=ret";else{if(a=r[1],O=!n&&r[2],s=Te(r[3],"params")+"},"+Te(d=r[4]),M=r[5],U=r[6],C=r[8]&&r[8].replace(R,"$1"),(x="else"===o)?h&&h.push(r[7]):(V=0,f&&(h=r[7])&&(h=[h],V=f.push(1))),j=j||d[1]||d[2]||h||/view.(?!index)/.test(d[0]),(P=":"===o)?a&&(o=a===H?">":a+o):(O&&((b=ce(C,G)).tmplName=T+"/"+o,b.useViews=b.useViews||j,Ae(O,b),j=b.useViews,I.push(b)),x||(A=o,j=j||o&&(!g[o]||!g[o].flow),L=k,k=""),S=(S=e[i+1])&&"else"===S[0]),D=M?";\ntry{\nret+=":"\n+",v="",m="",P&&(h||U||a&&a!==H)){if((w=new Function("data,view,j,u"," // "+T+" "+V+" "+o+"\nreturn {"+s+"};"))._er=M,w._tag=o,n)return w;Ee(w,h),p=!0,v=(E='c("'+a+'",view,')+V+",",m=")"}if(k+=P?(n?(M?"try{\n":"")+"return ":D)+(p?(p=void 0,j=c=!0,E+(h?(f[V-1]=w,V):"{"+s+"}")+")"):">"===o?(u=!0,"h("+d[0]+")"):(!0,"((v="+d[0]+")!=null?v:"+(n?"null)":'"")'))):(l=!0,"\n{view:view,tmpl:"+(O?I.length:"0")+","+s+"},"),A&&!S){if(k="["+k.slice(0,-1)+"]",E='t("'+A+'",view,this,',n||h){if((k=new Function("data,view,j,u"," // "+T+" "+V+" "+A+"\nreturn "+k+";"))._er=M,k._tag=A,h&&Ee(f[V-1]=k,h),n)return k;v=E+V+",undefined,",m=")"}k=L+D+E+(V||k)+")",h=0,A=0}M&&(j=!0,k+=";\n}catch(e){ret"+(n?"urn ":"+=")+v+"j._err(e,view,"+M+")"+m+";}"+(n?"":"ret=ret"))}k="// "+T+"\nvar v"+(l?",t=j._tag":"")+(c?",c=j._cnvt":"")+(u?",h=j._html":"")+(n?";\n":',ret=""\n')+(G.debug?"debugger;":"")+k+(n?"\n":";\nreturn ret;"),!1!==_.debugMode&&(k="try {\n"+k+"\n}catch(e){\nreturn j._err(e, view);\n}");try{k=new Function("data,view,j,u",k)}catch(B){ye("Compiled template code:\n\n"+k+'\n: "'+B.message+'"')}return t&&(t.fn=k,t.useViews=!!j),k}function Oe(e,t){return e&&e!==t?t?ie(ie({},t),e):e:t&&ie({},t)}function Ce(e){return F[e]||(F[e]="&#"+e.charCodeAt(0)+";")}function Se(e,n,i){var r=this.jquery&&(this[0]||_e("Unknown template")),o=r.getAttribute(q);return de.call(o?t.data(r)[Y]:f(r),e,n,i)}function Le(e){return null!=e?U.test(e)&&(""+e).replace(k,Ce)||e:""}if(a={jsviews:S,sub:{View:se,Err:ne,tmplFn:me,parse:be,extend:ie,extendCtx:Oe,syntaxErr:ye,onStore:{},addSetting:fe,settings:{allowCode:!1},advSet:te,_ths:Z,_tg:function(){},_cnvt:function(e,t,n,i){var r,o,a="number"==typeof n&&t.tmpl.bnds[n-1],s=t.linkCtx;return void 0!==i?n=i={props:{},args:[i]}:a&&(n=a(t.data,t,v)),o=n.args[0],(e||a)&&((r=s&&s.tag)||(r=ie(new v._tg,{_:{inline:!s,bnd:a,unlinked:!0},tagName:":",cvt:e,flow:!0,tagCtx:n}),s&&(s.tag=r,r.linkCtx=s),n.ctx=Oe(n.ctx,(s?s.view:t).ctx)),r._er=i&&o,Z(r,n),n.view=t,r.ctx=n.ctx||r.ctx||{},n.ctx=void 0,o=r.cvtArgs("true"!==e&&e)[0],o=a&&t._.onRender?t._.onRender(o,t,r):o),o??""},_tag:function(e,n,i,r,a,s){var l,u,c,p,f,d,g,_,y,m,E,I,T,b,A,O,C,S,L="",x=(n=n||o).linkCtx||0,N=n.ctx,R=i||n.tmpl,P="number"==typeof r&&n.tmpl.bnds[r-1];for("tag"===e._is?(e=(l=e).tagName,r=l.tagCtxs,l.template):(u=n.getRsc("tags",e)||_e("Unknown tag: {{"+e+"}} "),u.template),void 0!==s?(L+=s,r=s=[{props:{},args:[]}]):P&&(r=P(n.data,n,v)),g=r.length,d=0;d<g;d++)y=r[d],(!x||!x.tag||d&&!x.tag._.inline||l._er)&&((E=R.tmpls&&y.tmpl)&&(E=y.content=R.tmpls[E-1]),y.index=d,y.tmpl=E,y.render=de,y.view=n,y.ctx=Oe(y.ctx,N)),(i=y.props.tmpl)&&(y.tmpl=n.getTmpl(i)),l||(l=new u._ctr,I=!!l.init,l.parent=f=N&&N.tag,l.tagCtxs=r,C=l.dataMap,x&&(l._.inline=!1,x.tag=l,l.linkCtx=x),(l._.bnd=P||x.fn)?l._.arrVws={}:l.dataBoundOnly&&_e("{^{"+e+"}} tag must be data-bound")),r=l.tagCtxs,C=l.dataMap,y.tag=l,C&&r&&(y.map=r[d].map),l.flow||(m=y.ctx=y.ctx||{},c=l.parents=m.parentTags=N&&Oe(m.parentTags,N.parentTags)||{},f&&(c[f.tagName]=f),c[l.tagName]=m.tag=l);if(!(l._er=s)){for(Z(l,r[0]),l.rendering={},d=0;d<g;d++)y=l.tagCtx=r[d],O=y.props,A=l.cvtArgs(),(T=O.dataMap||C)&&(A.length||O.dataMap)&&((!(b=y.map)||b.src!==A[0]||a)&&(b&&b.src&&b.unmap(),b=y.map=T.map(A[0],O,void 0,!l._.bnd)),A=[b.tgt]),l.ctx=y.ctx,d||(I&&(l.template,l.init(y,x,l.ctx),I=void 0),x&&(x.attr=l.attr=x.attr||l.attr),p=l.attr,l._.noVws=p&&p!==H),_=void 0,l.render&&(_=l.render.apply(l,A),n.linked&&_&&l.linkedElem&&!j.test(_)&&(_=ge(t.templates(_),A[0],void 0,void 0,n,void 0,void 0,l))),A.length||(A=[n]),void 0===_&&(S=A[0],l.contentCtx&&(S=l.contentCtx(S)),_=y.render(S,!0)||(a?void 0:"")),L=L?L+(_||""):_;l.rendering=void 0}return l.tagCtx=r[0],l.ctx=l.tagCtx.ctx,l._.noVws&&l._.inline&&(L="text"===p?h.html(L):""),P&&n._.onRender?n._.onRender(L,n,l):L},_er:_e,_err:ve,_html:Le,_cp:ee,_sq:function(e){return"constructor"===e&&ye(""),e}},settings:{delimiters:re,advanced:function(e){return e?(ie(y,e),v.advSet(),m):y}},getCtx:ee,map:he},(ne.prototype=new Error).constructor=ne,oe.depends=function(){return[this.get("item"),"index"]},ae.depends="index",se.prototype={get:function(e,t){!t&&!0!==e&&(t=e,e=void 0);var n,i,r,o,a=this,s=!t||"root"===t;if(e){if(!(o=t&&a.type===t&&a))if(n=a.views,a._.useKey){for(i in n)if(o=t?n[i].get(e,t):n[i])break}else for(i=0,r=n.length;!o&&i<r;i++)o=t?n[i].get(e,t):n[i]}else if(s)for(;a.parent;)o=a,a=a.parent;else for(;a&&!o;)o=a.type===t?a:void 0,a=a.parent;return o},getIndex:ae,getRsc:function(e,t){for(var n,i,r=this;void 0===n&&r;)n=(i=r.tmpl&&r.tmpl[e])&&i[t],r=r.parent;return n||a[e][t]},getTmpl:function(e){return e&&(e.fn?e:this.getRsc("templates",e)||f(e))},hlp:function(t,n){var i,r,o=this,s=o.ctx;if(s&&(s=s[t]),void 0===s&&(s=d[t]),s&&s._cp){if(n)return(r=v._ceo(s[1].deps)).unshift(s[0]),r._cp=!0,r;s=a.getCtx(s)}return s&&c(s)&&!s._wrp&&(i=function(){return s.apply(this&&this!==e?this:o,arguments)},i._wrp=o,ie(i,s)),i||s},_is:"view"},v=a.sub,m=a.settings,!(X||t&&t.render)){for(i in Q)pe(i,Q[i]);for(O in h=a.converters,d=a.helpers,g=a.tags,v._tg.prototype={baseApply:function(e){return this.base.apply(this,e)},cvtArgs:function(e){var t=this,n=t.tagCtx,i=n.view,r=n.args;return e=(e=e||t.convert)&&(""+e===e?i.getRsc("converters",e)||_e("Unknown converter: '"+e+"'"):e),r=r.length||n.index?e?r.slice():r:[i.data],e&&(e.depends&&(t.depends=v.getDeps(t.depends,t,e.depends,e)),r[0]=e.apply(t,r)),r}},o=v.topView=new se,t?(t.fn.render=Se,u=t.expando,t.observable&&(ie(v,t.views.sub),a.map=t.views.map)):(t={},n&&(e.jsrender=t),t.renderFile=t.__express=t.compile=function(){throw"Node.js: use npm jsrender, or jsrender-node.js"},t.isFunction=function(e){return"function"==typeof e},t.isArray=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},v._jq=function(e){e!==t&&(ie(e,t),(t=e).fn.render=Se,delete t.jsrender,u=t.expando)},t.jsrender=S),(_=v.settings).allowCode=!1,c=t.isFunction,t.render=W,t.views=a,t.templates=f=a.templates,_)fe(O);(m.debugMode=function(e){return void 0===e?_.debugMode:(_.debugMode=e,_.onError=e+""===e?new Function("","return '"+e+"';"):c(e)?e:void 0,m)})(!1),y=_.advanced={useViews:!1,_jsv:!1},g({if:{render:function(e){var t=this,n=t.tagCtx,i=t.rendering.done||!e&&(arguments.length||!n.index)?"":(t.rendering.done=!0,t.selected=n.index,n.render(n.view,!0));return i},flow:!0},for:{render:function(e){var t,n=!arguments.length,i=this,r=i.tagCtx,o="",a=0;return i.rendering.done||(void 0!==(t=n?r.view.data:e)&&(o+=r.render(t,n),a+=p(t)?t.length:1),(i.rendering.done=a)&&(i.selected=r.index)),o},flow:!0},props:{baseTag:"for",dataMap:he((function(e){var t,n,i=[];if(typeof e===B)for(t in e)n=e[t],t!==u&&e.hasOwnProperty(t)&&!c(n)&&i.push({key:t,prop:n});return i})),flow:!0},include:{flow:!0},"*":{render:ee,flow:!0},":*":{render:ee,flow:!0},dbg:d.dbg=h.dbg=function(e){try{throw console.log("JsRender dbg breakpoint: "+e),"dbg breakpoint"}catch{}return this.base?this.baseApply(arguments):e}}),h({html:Le,attr:Le,url:function(e){return null!=e?encodeURI(""+e):null===e?e:""}})}if(_=v.settings,p=(t||X).isArray,m.delimiters("{{","}}","^"),z&&X.views.sub._jq(t),a=t.views,v=a.sub,c=t.isFunction,p=t.isArray,u=t.expando,!t.observe){var xe=t.event.special,Ne=[].slice,Re=[].splice,Pe=[].concat,we=parseInt,Me=/\S+/g,De=v.propChng=v.propChng||"propertyChange",Ue=v.arrChng=v.arrChng||"arrayChange",Ve={},je=De+".observe",ke=1,Ge=1,Fe=1,He=t.hasData,Be=t.data,qe={},Ye=function(e){return e._cId=e._cId||".obs"+Ge++},Ke=function(e,t){return this._data=t,this._ns=e,this},We=function(e,t){return this._data=t,this._ns=e,this},Xe=function(e){return p(e)?[e]:e},ze=function(e,t,n){var i,r,o=t,a=o,s=(e=e?p(e)?e:[e]:[])&&e.length,l=[];for(i=0;i<s;i++)r=e[i],c(r)?l=l.concat(ze(r.call(t,t,n),t)):""+r===r?(a!==o&&l.push(o=a),l.push(r)):(t=a=r,a!==o&&l.push(o=a));return l},Qe=function(e,t){for(var n in e)return;delete Ve[t]},$e=function(e,t){function n(e){return typeof e===B&&(h[0]||f&&p(e))}if(!e.data||!e.data.off){var i,r,o,a=t.oldValue,s=t.value,l=e.data,u=l.observeAll,c=l.cb,f=!c.noArray,h=l.paths,d=l.ns;e.type===Ue?(c.array||c).call(l,e,t):(l.prop===t.path||"*"===l.prop)&&(u?(i=u._path+"."+t.path,r=u.filter,o=[e.target].concat(u.parents()),n(a)&&Je(f,d,[a],h,c,!0,r,[o],i),n(s)&&Je(f,d,[s],h,c,void 0,r,[o],i)):(n(a)&&Je(f,d,[a],h,c,!0),n(s)&&Je(f,d,[s],h,c)),l.cb(e,t))}},Je=function(){var e=Pe.apply([],arguments);return s.apply(e.shift(),e)},Ze=function(e,t,n){tt(this._ns,this._data,e,t,[],"root",n)},et=function(e,t){Ze.call(this,e,t,!0)},tt=function(e,t,n,i,r,o,a,c){function f(e,t){for(g=e.length,_=o+"[]";g--;)h(e,g,t,1)}function h(t,r,o,a){var s,p;r!==u&&(s=l._fltr(_,t[r],y,i))&&(p=y.slice(),a&&m&&p[0]!==m&&p.unshift(m),tt(e,s,n,i||(a?void 0:0),p,_,o,c))}function d(e,t){switch(o=e.data.observeAll._path,m=e.target,t.change){case"insert":f(t.items);break;case"remove":f(t.items,!0);break;case"set":_=o+"."+t.path,h(t,"oldValue",!0),h(t,"value")}m=void 0,n.apply(this,arguments)}var g,v,_,y,m,E,I=!c||c.un||!a;if(t&&typeof t===B){if(y=[t].concat(r),v=p(t)?"":"*",c&&I&&He(t)&&c[E=Be(t).obId])return void c[E]++;if(c||(c={un:a}),n){if(v||0!==i)if(d._cId=Ye(n),I)s(e,t,v,d,a,i,y,o),E=Be(t).obId,c[E]=(c[E]||0)+1;else{if(--c[Be(t).obId])return;s(e,t,v,d,a,i,y,o)}}else c&&(c[Be(t).obId]=1),s(e,t,v,void 0,a,i,y,o);if(v)for(g in t)_=o+"."+g,h(t,g,a);else f(t,a)}},nt=function(e){return e.indexOf(".")<0&&e.indexOf("[")<0};s=function(){function e(){function r(e,i,r,o){var a,s,l=He(H),u=Xe(H),c=w,p=M;if(e=n?e+"."+n:e,!E&&(o||r))for(C=(C=(C=l&&t._data(H))&&C.events)&&C[r?Ue:De],A=C&&C.length;A--;)if((O=C[A]&&C[A].data)&&(o&&O.ns!==n||!o&&O.ns===n&&O.cb&&O.cb._cId===I._cId))return;E||o?t(u).off(e,$e):((s=r?{}:{fullPath:y,paths:i?[i]:[],prop:_}).ns=n,s.cb=I,M&&(s.observeAll={_path:p,path:function(){return a=c.length,p.replace(/[[.]/g,(function(e){return a--,"["===e?"["+t.inArray(c[a-1],c[a]):"."}))},parents:function(){return c},filter:D}),t(u).on(e,null,s,$e),N&&(N[Be(H).obId||Be(H,"obId",ke++)]=H))}function a(t){var n=F;return t.ob=S(t,n),t.cb=function(r,o){var a=t.ob,l=t.sb,u=S(t,n);u!==a&&(typeof a===B&&(s(a,!0),(l||i&&p(a))&&e([a],l,I,S,!0)),t.ob=u,typeof u===B&&(s(u),(l||i&&p(u))&&e([u],l,I,S))),I(r,o)}}function s(e,t,n,o){if(i){var a=H,s=M;H=e,o&&(H=e[o],M+="."+o),D&&H&&(H=l._fltr(M,H,o?[e].concat(w):w,D)),H&&(n||p(H))&&r(Ue+".observe"+(I?Ye(I):""),void 0,!0,t),H=a,M=s}}var f,h,d,g,_,y,m,E,I,T,b,A,O,C,S,L,x,N,R,P,w,M,D,U,V,j=je,k=1!=this?Pe.apply([],arguments):Ne.call(arguments),G=k.pop()||!1,F=k.shift(),H=F,q=k.length;if(G+""===G&&(M=G,w=k.pop(),D=k.pop(),G=!!k.pop(),q-=3),G===!!G&&(E=G,G=k[q-1],G=!q||G+""===G||G&&!c(G)?void 0:(q--,k.pop()),E&&!q&&c(F)&&(G=F,F=void 0)),I=G,q&&c(k[q-1])&&(L=S=I,I=k.pop(),q--),!E||!I||I._cId){for(j+=I?(b=I._inId||"",E?I._cId+b:(T=Ye(I))+b):"",T&&!E&&(N=Ve[T]=Ve[T]||{}),V=(U=n&&n.match(Me)||[""]).length;V--;){if(n=U[V],F&&(!(y=k[0])||y+""!==y)&&(p(F)?s(F,E,!0):E&&r(j,"")),E&&!q&&!F)for(h in Ve)for(O in h=Ve[h])H=h[O],p(H)?s(H,E,E):r(j,"");for(R=0,f=0;f<q;f++)if(""!==(y=k[f])){if(y&&y._cp&&(S=v._gccb(y[0]),o=F=y[0].data,y=y[1]),H=F,""+y===y){if((g=y.split("^"))[1]&&(R=g[0].split(".").length,R=(y=g.join(".")).split(".").length-R),S&&(x=S(y,F,R),S=L),x){q+=x.length-1,Re.apply(k,[f--,1].concat(x));continue}g=y.split(".")}else c(y)||(y&&y._jsv?((P=E?y.cb:a(y)).noArray=!i,P._cId=I._cId,P._inId=P._inId||".obIn"+Fe++,(y.bnd||y.prm&&y.prm.length||!y.sb)&&e([H],y.path,[o],y.prm,P,S,E),y.sb&&e([y.ob],y.sb,I,S,E),y=o,H=void 0):H=y),g=[F=y];for(;H&&void 0!==(_=g.shift());)if(typeof H===B){if(""+_===_){if(""===_)continue;if(g.length<R+1&&!H.nodeType){if(!E&&(C=He(H)&&t._data(H))){for(C=(C=C.events)&&C[De],A=C&&C.length,d=0;A--;)(O=C[A].data)&&O.ns===n&&O.cb._cId===I._cId&&O.cb._inId===I._inId&&(O.prop===_||"*"===O.prop||"**"===O.prop)&&((h=g.join("."))&&O.paths.push(h),d++);if(d){H=H[_];continue}}if("*"===_||"**"===_){if(!E&&C&&C.length&&r(j,"",!1,!0),"*"===_)for(h in r(j,""),H)h!==u&&s(H,E,void 0,h);else t.observable(n,H)[(E?"un":"")+"observeAll"](I);break}_&&r(j+".p_"+_,g.join("^"))}M&&(M+="."+_),_=H[_]}if(c(_)){(m=_.depends)&&e([H],ze(m,H,I),I,S,E);break}H=_,E&&H===F&&(f>q-2||k[f+1]+""!==k[f+1])&&r(j,"")}s(H,E)}}return T&&Qe(N,T),{cbId:T,bnd:N}}}var n,i=0!=this,r=Ne.call(arguments),o=r[0];return o+""===o&&i&&(n=o,r.shift(),o=r[0]),e.apply(1,r)},l=function(e,t){return 1===arguments.length&&(t=e,e=""),p(t)?new We(e,t):new Ke(e,t)},v.getDeps=function(){var e=arguments;return function(){for(var t,n,i=[],r=e.length;r--;)t=e[r--],(n=e[r])&&(i=i.concat(c(n)?n(t,t):n));return i}},t.observable=l,l._fltr=function(e,t,n,i){if(!i||!c(i)||i(e,t,n))return typeof(t=c(t)?t.set&&t.call(n[0]):t)===B&&t},l.Object=Ke,l.Array=We,t.observe=l.observe=s,t.unobserve=l.unobserve=function(){return[].push.call(arguments,!0),s.apply(this,arguments)},l._apply=Je,Ke.prototype={_data:null,observeAll:Ze,unobserveAll:et,data:function(){return this._data},setProperty:function(e,t,n){var i,r,o,a=(e=e||"")+""!==e,s=this,l=s._data;if(l)if(a)if(n=t,p(e))for(i=e.length;i--;)r=e[i],s.setProperty(r.name,r.value,void 0===n||n);else for(i in e)s.setProperty(i,e[i],n);else if(e!==u){for(o=e.split(/[.^]/);l&&o.length>1;)l=l[o.shift()];l&&s._setProperty(l,o[0],t,n)}return s},removeProperty:function(e){return this.setProperty(e,qe),this},_setProperty:function(e,t,n,i){var r,o,a,s=t?e[t]:e;c(s)&&s.set&&(e=e._wrp||e,r=!0===(o=s).set?o:o.set,s=o.call(e)),(s!==n||i&&s!=n)&&(!(s instanceof Date)||s>n||s<n)&&(r?(r.call(e,n),n=o.call(e)):(a=n===qe)?void 0!==s?(delete e[t],n=void 0):t=void 0:t&&(e[t]=n),t&&this._trigger(e,{change:"set",path:t,value:n,oldValue:s,remove:a}))},_trigger:function(e,n){t(e).triggerHandler(De+(this._ns?"."+/^\S+/.exec(this._ns)[0]:""),n)}},We.prototype={_data:null,observeAll:Ze,unobserveAll:et,data:function(){return this._data},insert:function(e,t){var n=this._data;return 1===arguments.length&&(t=e,e=n.length),(e=we(e))>-1&&((t=p(t)?t:[t]).length&&this._insert(e,t)),this},_insert:function(e,t){var n=this._data,i=n.length;e>i&&(e=i),Re.apply(n,[e,0].concat(t)),this._trigger({change:"insert",index:e,items:t},i)},remove:function(e,t){var n,i=this._data;return void 0===e&&(e=i.length-1),e=we(e),(t=t?we(t):0===t?0:1)>0&&e>-1&&((t=(n=i.slice(e,e+t)).length)&&this._remove(e,t,n)),this},_remove:function(e,t,n){var i=this._data,r=i.length;i.splice(e,t),this._trigger({change:"remove",index:e,items:n},r)},move:function(e,t,n){return n=n?we(n):0===n?0:1,e=we(e),t=we(t),n>0&&e>-1&&t>-1&&e!==t&&this._move(e,t,n),this},_move:function(e,t,n){var i,r=this._data,o=r.length,a=e+n-o;a>0&&(n-=a),n&&(i=r.splice(e,n),t>r.length&&(t=r.length),Re.apply(r,[t,0].concat(i)),this._trigger({change:"move",oldIndex:e,index:t,items:i},o))},refresh:function(e,t){function n(){o&&(l.insert(r-o,u),h+=o,i+=o,o=0,u=[])}var i,r,o,a,s,l=this,u=[],c=l._data,p=c.slice(),f=c.length,h=f,d=e.length;for(l._srt=!0,r=o=0;r<d;r++)if((a=e[r])===c[r-o])n();else{for(i=r-o;i<h&&a!==c[i];i++);if(i<h){for(n(),s=0;s++<d-i&&e[r+s]===c[i+s];);l.move(i,r,s),r+=s-1}else o++,u.push(a)}return n(),h>r&&l.remove(r,h-r),l._srt=void 0,l._trigger({change:"refresh",oldItems:p},f),l},_trigger:function(e,n){var i=this,r=i._data,o=r.length,a=t([r]);i._srt?e.refresh=!0:o!==n&&a.triggerHandler(De,{change:"set",path:"length",value:o,oldValue:n}),a.triggerHandler(Ue+(i._ns?"."+/^\S+/.exec(i._ns)[0]:""),e)}},xe[De]=xe[Ue]={remove:function(e){var n,i,r,o,a,s=e.data;if(s&&(s.off=!0,s=s.cb)&&(n=Ve[s._cId])){for(o=(r=t._data(this).events[e.type]).length;o--&&!i;)i=(a=r[o].data)&&a.cb&&a.cb._cId===s._cId;i||(delete n[Be(this).obId],Qe(n,s._cId))}}},a.map=function(e){function n(t,n,i,r){var o,a=this;this.src&&this.unmap(),typeof t===B&&(a.src=t,a.tgt=i||a.tgt||[],a.options=n||a.options,a.update(),r||(e.obsSrc&&l(a.src).observeAll(a.obs=function(t,n){o||(o=!0,e.obsSrc(a,t,n),o=void 0)},a.srcFlt),e.obsTgt&&l(a.tgt).observeAll(a.obt=function(t,n){o||(o=!0,e.obsTgt(a,t,n),o=void 0)},a.tgtFlt)))}return c(e)&&(e={getTgt:e}),e.baseMap&&(e=t.extend({},e.baseMap,e)),e.map=function(e,t,i,r){return new n(e,t,i,r)},(n.prototype={srcFlt:e.srcFlt||nt,tgtFlt:e.tgtFlt||nt,update:function(t){var n=this;l(n.tgt).refresh(e.getTgt(n.src,n.options=t||n.options))},unmap:function(){var e=this;e.src&&(e.obs&&l(e.src).unobserveAll(e.obs,e.srcFlt),e.obt&&l(e.tgt).unobserveAll(e.obt,e.tgtFlt),e.src=void 0)},map:n,_def:e}).constructor=n,e},v.advSet=function(){v._gccb=this._gccb,e._jsv=_.advanced._jsv?{cbBindings:Ve}:void 0}}if(m=a.settings,_=v.settings,y=_.advanced,h=a.converters,t.templates=f=a.templates,g=a.tags,D=/<(?!script)(\w+)[>\s]/,t.link)return t;_.trigger=!0;var it,rt,ot,at,st,lt,ut,ct,pt="data-jsv",ft="change.jsv",ht="onBeforeChange",dt="onAfterChange",gt="onAfterCreate",vt="checked",_t="checkbox",yt="radio",mt="none",Et="SCRIPT",It="true",Tt='"><\/script>',bt='<script type="jsv',At=pt+"-df",Ot="script,["+pt+"]",Ct={value:"val",input:"val",html:H,text:"text"},St={from:"value",to:"value"},Lt=0,xt=t.cleanData,Nt=m.delimiters,Rt=document.createDocumentFragment(),Pt=document.querySelector,wt={ol:1,ul:1,table:1,tbody:1,thead:1,tfoot:1,tr:1,colgroup:1,dl:1,select:1,optgroup:1,svg:1,svg_ns:1},Mt={tr:"table"},Dt={br:1,img:1,input:1,hr:1,area:1,base:1,col:1,link:1,meta:1,command:1,embed:1,keygen:1,param:1,source:1,track:1,wbr:1},Ut={},Vt={},jt=1,kt=/^#(view\.?)?/,Gt=/((\/>)|<\/(\w+)>|)(\s*)([#\/]\d+(?:_|(\^)))`(\s*)(<\w+(?=[\s\/>]))?|\s*(?:(<\w+(?=[\s\/>]))|<\/(\w+)>(\s*)|(\/>)\s*|(>)|$)/g,Ft=/(#)()(\d+)(_)/g,Ht=/(#)()(\d+)([_^])/g,Bt=/(?:(#)|(\/))(\d+)(_)/g,qt=/(#)()(\d+)(\^)/g,Yt=/(?:(#)|(\/))(\d+)([_^])([-+@\d]+)?/g,Kt=/&(\d+)\+?/g,Wt=e.getComputedStyle;if(!(l=t.observable))throw requiresStr+"JsObservable";function Xt(e,n,i){for(var r,o,a,s,u,p,f,h,d,g,v,_,y,m,E,I,T,b=e.target,A=b._jsvBnd;d=Kt.exec(A);)if((d=Vt[d[1]])&&(m=d.to)){if(h=(a=d.linkCtx).view,y=a.tag||h.tag,f=t(b),v=h.hlp(ht),_=h.hlp(dt),o=en(b),r=Ct[o],void 0===i&&(i=c(o)?o(b):r?f[r]():f.attr(o)),u=m[1],m=(m=m[0])+""===m?[a.data,m]:m,u&&(s=c(u)?u:h.getRsc("converters",u)),"SELECT"===a.elem.nodeName&&(a.elem._jsvSel=i=i||(a.elem.multiple?[]:i)),s&&(i=s.call(y,i)),g=h.linkCtx,h.linkCtx=a,E={change:"change",oldValue:a._val,value:i},(!v||!(!1===v.call(a,e,E)))&&(!y||!y.onBeforeChange||!(!1===y.onBeforeChange(e,E)))&&void 0!==i&&(p=m[0],void 0!==i&&p)){if(p._jsv)for(T=a._ctxCb,I=p,p=a.data,I._cpCtx&&(p=I.data,T=I._cpCtx);I&&I.sb;)p=T(I,p),I=I.sb;y&&(y._.chging=!0),l(p).setProperty(m[1],i),_&&_.call(a,e,E),y&&(y.onAfterChange&&y.onAfterChange(e,E),y._.chging=void 0),a._val=i}h.linkCtx=g}}function zt(e,n,i){var r,o,a,s,l,u,p=this,f=p.tag,h=p.data,d=p.elem,g=p.convert,_=d.parentNode,y=p.view,m=y.linkCtx,E=y.hlp(ht);if(y.linkCtx=p,_&&(!E||!n||!1!==E.call(p,e,n))&&(!n||"*"===e.data.prop||e.data.prop===n.path)){if(n&&(p.eventArgs=n),n||p._toLk){if(p._toLk=0,i._er)try{o=i(h,y)}catch(I){l=i._er,o=[{props:{},args:[u=ve(I,y,new Function("data,view","return "+l+";")(h,y))]}]}else o=i(h,y,v);if(r=function(e,n,i,r){var o,a,s,l,u=i&&i.parentElem||n.elem;if(void 0!==e){if(l=t(u),r=i&&i.attr||r,c(e)&&_e(n.expr+": missing parens"),s=/^css-/.test(r)&&r.slice(4))o=t.style(u,s),+e===e&&(o=parseInt(o));else if("link"!==r){if("value"===r)u.type===_t&&(o=l.prop(r=vt));else if(r===yt){if(u.value!==""+e)return r;o=l.prop(vt)}void 0===o&&(o=(a=Ct[r])?l[a]():l.attr(r))}n._val=o}return r}(o,p,f=p.tag,p.attr||en(d,!0,void 0!==g)),f){if(s=l||f._er,o=o[0]?o:[o],a=!s&&n&&f.onUpdate&&!1===f.onUpdate(e,n,o),mn(f,o,s),a||r===mt)return gn(f,e,n),rn(p,h,d),void(y.linkCtx=m);if(f._.chging)return;f.onUnbind&&f.onUnbind(f.tagCtx,p,f.ctx,e,n),o=":"===f.tagName?v._cnvt(f.cvt,y,o[0]):v._tag(f,y,y.tmpl,o,!0,u)}else i._tag&&(o=(g=""===g?It:g)?v._cnvt(g,y,o[0]||o):v._tag(i._tag,y,y.tmpl,o,!0,u),On(f=p.tag,!0),r=p.attr||r);$t(o,p,r,f)&&n&&(E=y.hlp(dt))&&E.call(p,e,n),p._noUpd=0,f&&(f._er=l,gn(f,e,n))}rn(p,h,d),y.linkCtx=m}}function Qt(e,t){e._df=t,e[(t?"set":"remove")+"Attribute"](At,"")}function $t(n,i,r,o){var a,s,l,u,c,f,h,d,g,v,_,y,m,E,I=r!==mt&&void 0!==n&&!i._noUpd,T=i.data,b=o&&o.parentElem||i.elem,A=b.parentNode,O=t(b),C=i.view,S=i._val,L=C.linkCtx,x=o;if(o&&(o._.unlinked=!0,o.parentElem=o.parentElem||i.expr||o._elCnt?b:A,s=o._prv,l=o._nxt),I)return"visible"===r&&(r="css-display"),/^css-/.test(r)?("visible"===i.attr&&(m=(b.currentStyle||Wt.call(e,b,"")).display,n?(n=b._jsvd||m)===mt&&!(n=Ut[y=b.nodeName])&&(_=document.createElement(y),document.body.appendChild(_),n=Ut[y]=(_.currentStyle||Wt.call(e,_,"")).display,document.body.removeChild(_)):(b._jsvd=m,n=mt)),(x=x||S!==n)&&t.style(b,r.slice(4),n)):"link"!==r&&(/^data-/.test(r)&&t.data(b,r.slice(5),n),r===vt?(f=!0,n=n&&"false"!==n):r===yt?(f=!0,r=vt,n=b.value===""+n):"selected"===r||"disabled"===r||"multiple"===r||"readonly"===r?n=n&&"false"!==n?r:null:"value"===r&&"SELECT"===b.nodeName&&(b._jsvSel=p(n)?n:""+n),(a=Ct[r])?r===H?(C.linkCtx=i,o&&o._.inline?(c=o.nodes(!0),o._elCnt&&(s&&s!==l?bn(s,l,b,o._tgId,"^",!0):(h=b._df)&&(d=o._tgId+"^",g=h.indexOf("#"+d)+1,v=h.indexOf("/"+d),g&&v>0&&(v>(g+=d.length)&&(Qt(b,h.slice(0,g)+h.slice(v)),An(h.slice(g,v))))),s=s?s.previousSibling:l?l.previousSibling:b.lastChild),t(c).remove(),u=C.link(C.data,b,s,l,n,o&&{tag:o._tgId,lazyLink:o.tagCtx.props.lazyLink})):((I=I&&S!==n)&&O.empty(),I&&(u=C.link(T,b,s,l,n,o&&{tag:o._tgId}))),C.linkCtx=L):((x=x||S!==n)&&("text"===r&&b.children&&!b.children[0]?void 0!==b.textContent?b.textContent=n:b.innerText=null===n?"":n:O[a](n)),(E=A._jsvSel)&&("value"===r||!O.attr("value"))&&(b.selected=t.inArray(""+n,p(E)?E:[E])>-1)):(x=x||S!==n)&&O[f?"prop":"attr"](r,void 0!==n||f?n:null),i._val=n),u||x}function Jt(e,t){var n=this,i=n.hlp(ht),r=n.hlp(dt);if(!i||!1!==i.call(this,e,t)){if(t){var o=t.change,a=t.index,s=t.items;switch(n._.srt=t.refresh,o){case"insert":n.addViews(a,s);break;case"remove":n.removeViews(a,s.length);break;case"move":n.removeViews(t.oldIndex,s.length,void 0,!0),n.addViews(a,s);break;case"refresh":n._.srt=void 0,n.fixIndex(0)}}r&&r.call(this,e,t)}}function Zt(e){var n,i,r=e.type,o=e.data,a=e._.bnd;!e._.useKey&&a&&((i=e._.bndArr)&&(t([i[1]]).off(Ue,i[0]),e._.bndArr=void 0),a!==!!a?r?a._.arrVws[e._.id]=e:delete a._.arrVws[e._.id]:r&&o&&(n=function(t){t.data&&t.data.off||Jt.apply(e,arguments)},t([o]).on(Ue,n),e._.bndArr=[n,o]))}function en(e,t,n){var i=e.nodeName.toLowerCase(),r=y._fe[i]||e.contentEditable===It&&{to:H,from:H};return r?t?"input"===i&&e.type===yt?yt:r.to:r.from:t?n?"text":H:""}function tn(e,n,i,r,o,a,s){var l,u,c,p,f,h=e.parentElem,d=e._prv,g=e._nxt,v=e._elCnt;if(d&&d.parentNode!==h&&_e("Missing parentNode"),s)for(f in p=e.nodes(),v&&d&&d!==g&&bn(d,g,h,e._.id,"_",!0),e.removeViews(void 0,void 0,!0),u=g,v&&(d=d?d.previousSibling:g?g.previousSibling:h.lastChild),t(p).remove(),e._.bnds)In(f);else{if(n){if(!(c=r[n-1]))return!1;d=c._nxt}v?d=(u=d)?u.previousSibling:h.lastChild:u=d.nextSibling}l=i.render(o,a,e._.useKey&&s,e,s||n,!0),e.link(o,h,d,u,l,c)}function nn(e,t,n){var i,r;return n?(r="^`",On(n,!0),(i=n._tgId)||(Vt[i=jt++]=n,n._tgId=""+i)):(r="_`",On(ut[i=t._.id]=t)),"#"+i+r+(e??"")+"/"+i+r}function rn(e,t,n){var i,r,o,a,s,u,p,f,h=e.tag,d=e.convertBack,g=[],v=e._bndId||""+jt++,_=e._hdl;if(e._bndId=void 0,h&&(g=h.depends||g,g=c(g)?h.depends(h):g,a=h.linkedElem),!e._depends||""+e._depends!=""+g){if(e._depends&&l._apply(!1,[t],e._depends,_,!0),s=e.fn.deps.slice(),h&&h.boundProps)for(r=h.boundProps.length;r--;)for(p=h.boundProps[r],o=h._.bnd.paths.length;o--;)(f=h._.bnd.paths[o][p])&&f.skp&&(s=s.concat(f));for(r=s.length;r--;)(u=s[r])._jsv&&(s[r]=ie({},u));if((i=l._apply(!1,[t],s,g,_,e._ctxCb)).elem=n,i.linkCtx=e,i._tgId=v,n._jsvBnd=n._jsvBnd||"",n._jsvBnd+="&"+v,e._depends=g,e.view._.bnds[v]=v,Vt[v]=i,a)for(r=a.length;r--;)a[r]._jsvLkEl=h,yn(i,h,a[r]),a[r]._jsvBnd="&"+i._tgId+"+";else void 0!==d&&yn(i,h,n,d);h&&!h.flow&&!h._.inline&&(n.setAttribute(pt,(n.getAttribute(pt)||"")+"#"+v+"^/"+v+"^"),h._tgId=""+v)}}function on(e,t,n,i,r,o,a){return an(this,e,t,n,i,r,o,a)}function an(e,n,i,r,a,s,l,u){if(!0===r?(a=r,r=void 0):r="object"!=typeof r?void 0:ie({},r),e&&n){n=n.jquery?n:t(n),it||(it=document.body,t(it).on(ft,Xt).on("blur","[contenteditable]",Xt));for(var c,p,f,h,d,g,v,_,y,m=nn,E=r&&"replace"===r.target,I=n.length;I--;){if(v=n[I],(y=(s=s||ot(v))===o)&&(o.data=(o.ctx=r||{}).root=i),""+e===e)ln(e,v,s,void 0,!0,i,r);else{if(void 0!==e.markup)E&&(g=v.parentNode),f=e.render(i,r,a,s,void 0,m),g?(l=v.previousSibling,u=v.nextSibling,t.cleanData([v],!0),g.removeChild(v),v=g):(l=u=void 0,t(v).empty());else{if(!0!==e||s!==o)break;_={lnk:1}}if(v._df&&!u){for(c=0,p=(h=fn(v._df,!0,Ft)).length;c<p;c++)d=h[c],(d=ut[d.id])&&void 0!==d.data&&d.parent.removeViews(d._.key,void 0,!0);Qt(v)}s.link(i,v,l,u,f,_,r)}y&&(o.data=o.ctx=void 0)}}return n}function sn(e,n,i,r,o,a,s,l){function u(e,t){var i,r,o,a,s,l,u,c=[];if(e){for("@"===e._tkns.charAt(0)&&(t=I.previousSibling,I.parentNode.removeChild(I),I=void 0),m=e.length;m--;){if(o=(b=e[m]).ch,i=b.path)for(_=i.length-1;r=i.charAt(_--);)"+"===r?"-"===i.charAt(_)?(_--,t=t.previousSibling):t=t.parentNode:t=t.lastChild;"^"===o?(d=Vt[s=b.id])&&(u=t&&(!I||I.parentNode!==t),(!I||u)&&(d.parentElem=t),b.elCnt&&u&&Qt(t,(b.open?"#":"/")+s+o+(t._df||"")),c.push([u?null:I,b])):(T=ut[s=b.id])&&(T.parentElem||(T.parentElem=t||I&&I.parentNode||n,T._.onRender=nn,T._.onArrayChange=Jt,Zt(T)),a=T.parentElem,b.open?(T._elCnt=b.elCnt,t&&!I?Qt(t,"#"+s+o+(t._df||"")):(T._prv||Qt(a,cn(a._df,"#"+s+o)),T._prv=I)):(!t||I&&I.parentNode===t?I&&(T._nxt||Qt(a,cn(a._df,"/"+s+o)),T._nxt=I):(Qt(t,"/"+s+o+(t._df||"")),T._nxt=void 0),(l=T.ctx&&T.ctx[gt]||le)&&l.call(T.ctx.tag,T)))}for(m=c.length;m--;)oe.push(c[m])}return!e||e.elCnt}function c(e){var t,n,i;if(e)for(m=e.length,_=0;_<m;_++)if(b=e[_],n=d=Vt[b.id].linkCtx.tag,i=d.tagName===P,!d.flow||i){if(!R){for(t=1;n=n.parent;)t++;U=U||t}(R||t===U)&&(!P||i)&&N.push(d)}}function p(){var a,l,p="",f={},_=st+(te?",["+At+"]":"");for(E=Pt?n.querySelectorAll(_):t(_,n).get(),v=E.length,i&&i.innerHTML&&(O=Pt?i.querySelectorAll(_):t(_,i).get(),i=O.length?O[O.length-1]:i),U=0,g=0;g<v;g++)if(I=E[g],i&&!$)$=I===i;else{if(r&&I===r){te&&(p+=pn(I));break}if(I.parentNode)if(te){if(p+=pn(I),I._df){for(a=g+1;a<v&&I.contains(E[a]);)a++;f[a-1]=I._df}f[g]&&(p+=f[g]||"")}else ee&&(b=fn(I,void 0,Bt))&&(b=b[0])&&(J=J?b.id!==J&&J:b.open&&b.id),!J&&ue(fn(I))&&I.getAttribute(at)&&oe.push([I])}if(te&&((l=(p+=n._df||"").indexOf("#"+te.id)+1)&&(p=p.slice(l+te.id.length)),(l=p.indexOf("/"+te.id))+1&&(p=p.slice(0,l)),c(fn(p,void 0,qt))),void 0===o&&n.getAttribute(at)&&oe.push([n]),hn(i,K),hn(r,K),te)Z&&Z.resolve();else{for(K&&re+z&&(I=r,re&&(r?u(fn(re+"+",!0),r):u(fn(re,!0),n)),u(fn(z,!0),n),r&&(p=r.getAttribute(pt),(v=p.indexOf(Q)+1)&&(p=p.slice(v+Q.length-1)),r.setAttribute(pt,z+p))),v=oe.length,g=0;g<v;g++)I=oe[g],A=I[1],I=I[0],A?(d=Vt[A.id])&&((h=d.linkCtx)&&((d=h.tag).linkCtx=h),A.open?(I&&(d.parentElem=I.parentNode,d._prv=I),d._elCnt=A.elCnt,T=d.tagCtx.view,ln(void 0,d._prv,T,A.id)):(d._nxt=I,d._.unlinked&&(w=d.tagCtx,T=w.view,gn(d)))):ln(I.getAttribute(at),I,ot(I),void 0,ee,e,s);Z&&Z.resolve()}}var f,h,d,g,v,_,m,E,I,T,b,A,O,C,S,L,x,N,R,P,w,M,U,V,j,k,G,F,H,B,q,Y,K,W,X,z,Q,$,J,Z,ee,te,ne=this,ie=ne._.id+"_",re="",oe=[],ae=[],se=[],le=ne.hlp(gt),ue=u;if(a&&(Z=a.lazyLink&&t.Deferred(),a.tmpl?S="/"+a._.id+"_":(ee=a.lnk,a.tag&&(ie=a.tag+"^",a=!0),(te=a.get)&&(ue=c,N=te.tags,R=te.deep,P=te.name)),a=!0===a),n=n?""+n===n?t(n)[0]:n.jquery?n[0]:n:ne.parentElem||document.body,M=!y.noValidate&&n.contentEditable!==It,F=n.tagName.toLowerCase(),K=!!wt[F],i=i&&dn(i,K),r=r&&dn(r,K)||null,null!=o){if(B=q=document.createElement("div"),Q=z="",X="http://www.w3.org/2000/svg"===n.namespaceURI?"svg_ns":(G=D.exec(o))&&G[1]||"",K){for(x=r;x&&!(L=fn(x));)x=x.nextSibling;(Y=L?L._tkns:n._df)&&(C=S||"",(a||!S)&&(C+="#"+ie),(_=Y.indexOf(C))+1&&(_+=C.length,Q=z=Y.slice(0,_),Y=Y.slice(_),L?x.setAttribute(pt,Y):Qt(n,Y)))}if(H=void 0,o=(""+o).replace(Gt,(function(e,t,n,i,r,a,s,l,u,c,p,h,g,v){var _,y,m="";return v?(f=0,e):(d=u||c||"",i=i||p,n=n||g,H&&!n&&(!e||i||d||a&&!f)&&(H=void 0,F=ae.shift()),(i=i||n)&&(f=0,H=void 0,M&&(n||g?!Dt[F]&&!/;svg;|;math;/.test(";"+ae.join(";")+";")&&(_="'<"+F+".../"):Dt[i]?_="'</"+i:(!ae.length||i!==F)&&(_="Mismatch: '</"+i),_&&ye(_+">' in:\n"+o)),W=K,F=ae.shift(),K=wt[F],p=p?"</"+p+">":"",W&&(re+=z,z="",K?re+="-":(m=p+bt+"@"+re+Tt+(h||""),re=se.shift()))),K?(a?z+=a:t=p||g||"",d&&(t+=d,z&&(t+=" "+pt+'="'+z+'"',z=""))):t=a?t+m+r+(f?"":bt+a+Tt)+l+d:m||e,M&&s&&(f&&ye("{^{ within elem markup ("+f+' ). Use data-link="..."'),"#"===a.charAt(0)?ae.unshift(a.slice(1)):a.slice(1)!==(y=ae.shift())&&ye("Closing tag for {^{...}} under different elem: <"+y+">")),d&&(f=d,ae.unshift(F),F=d.slice(1),M&&ae[0]&&ae[0]===Mt[F]&&_e("Parent of <tr> must be <tbody>"),H=Dt[F],(K=wt[F])&&!W&&(se.unshift(re),re=""),W=K,re&&K&&(re+="+")),t)})),M&&ae.length&&ye("Mismatched '<"+F+"...>' in:\n"+o),l)return;for(Rt.appendChild(q),V=(X=lt[X]||lt.div)[0],B.innerHTML=X[1]+o+X[2];V--;)B=B.lastChild;for(Rt.removeChild(q),j=document.createDocumentFragment();k=B.firstChild;)j.appendChild(k);n.insertBefore(j,r)}return Z?setTimeout(p,0):p(),Z&&Z.promise()}function ln(e,n,i,r,o,a,s){var l,u,c,p,f,h,d,g,_,y,m,A=[];if(r)un(d=(g=(g=Vt[r]).linkCtx?g.linkCtx.tag:g).linkCtx||{type:"inline",data:i.data,elem:g._elCnt?g.parentElem:n,view:i,ctx:i.ctx,attr:H,fn:g._.bnd,tag:g,_bndId:r},d.fn);else if(e&&n){for(a=o?a:i.data,l=i.tmpl,e=function(e,n){return(e=t.trim(e).replace(P,"\\$&")).slice(-1)!==T?e=I+":"+e+(n?":":"")+T:e}(e,en(n)),m=rt.lastIndex=0;u=rt.exec(e);)A.push(u),m=rt.lastIndex;for(m<e.length&&ye(e);u=A.shift();){for(_=rt.lastIndex,c=u[1],f=u[3];A[0]&&"else"===A[0][4];)f+=b+E+A.shift()[3],y=!0;y&&(f+=b+E+I+"/"+u[4]+T),d={type:o?"top":"link",data:a,elem:n,view:i,ctx:s,attr:c,isLk:o,_toLk:1,_noUpd:u[2]},p=void 0,u[6]&&(p=u[10]||void 0,d.convert=u[5]||"",!c&&void 0!==p&&en(n)&&(d.convertBack=p=p.slice(1))),d.expr=c+f,(h=l.links[f])||(l.links[f]=h=v.tmplFn(f,l,!0,p,y)),d.fn=h,un(d,h),rt.lastIndex=_}}}function un(e,t){function n(n,i){zt.call(e,n,i,t)}n.noArray=!0,e.isLk&&On(e.view=new v.View(v.extendCtx(e.ctx,e.view.ctx),"link",e.view,e.data,e.expr,void 0,nn)),e._ctxCb=v._gccb(e.view),e._hdl=n,n(!0)}function cn(e,t){var n;return e?(n=e.indexOf(t))+1?e.slice(0,n)+e.slice(n+t.length):e:""}function pn(e){return e&&(""+e===e?e:e.tagName===Et?e.type.slice(3):1===e.nodeType&&e.getAttribute(pt)||"")}function fn(e,t,n){var i,r,o=[];if(r=t?e:pn(e))return i=o.elCnt=e.tagName!==Et,i="@"===r.charAt(0)||i,o._tkns=r,r.replace(n||Yt,(function(e,t,n,r,a,s){o.push({elCnt:i,id:r,ch:a,open:t,close:n,path:s,token:e})})),o}function hn(e,t){e&&("jsv"===e.type?e.parentNode.removeChild(e):t&&""===e.getAttribute(at)&&e.removeAttribute(at))}function dn(e,t){for(var n=e;t&&n&&1!==n.nodeType;)n=n.previousSibling;return n&&(1!==n.nodeType?((n=document.createElement(Et)).type="jsv",e.parentNode.insertBefore(n,e)):!pn(n)&&!n.getAttribute(at)&&n.setAttribute(at,"")),n}function gn(e,n,i){var r,o,a,s,l,u,c=e.tagCtx,p=(c.view,c.props),f=e.linkCtx;if(e._.unlinked&&(void 0!==e.linkedElement&&(e.linkedElem=e._.inline?e.contents(!0,e.linkedElement||"*").first():t(f.elem)),e.onBind&&e.onBind(c,f,e.ctx,n,i)),e.onAfterLink&&e.onAfterLink(c,f,e.ctx,n,i),r=e.targetTag?e.targetTag.linkedElem:e.linkedElem,o=e.displayElem||r,r&&r[0]){if(void 0!==(s=e.cvtArgs()[0])&&!e._.chging)for(l=r.length;l--;)a=r[l],e._.unlinked&&a!==f.elem&&(u=a._jsvLkEl,e._.inline&&(!u||u!==e&&u.targetTag!==e)&&(a._jsvLkEl=e,yn(Vt[e._tgId],e,a),a._jsvBnd="&"+e._tgId+"+")),void 0!==s&&(void 0!==a.value?a.type===_t?a[vt]=s&&"false"!==s:a.type===yt?a[vt]=a.value===s:t(a).val(s):a.contentEditable===It&&(a.innerHTML=s),f._val=s),p.name&&(a.name=a.name||p.name);e.setSize&&(p.height&&o.height(p.height),p.width&&o.width(p.width)),void 0!==p.title&&o.attr("title",p.title),p.class&&(i&&o.hasClass(i.oldValue)&&o.removeClass(i.oldValue),o.addClass(p.class)),p.id&&(r[0].id=p.id)}e._.unlinked=void 0}function vn(e){setTimeout((function(){Xt(e)}),0)}function _n(e,t,n){t&&(t=""+t===t?t:"keydown",e[n](t,"keydown"===t?vn:Xt))}function yn(e,n,i,r){var o,a,s,l,u,c,p,f,h,d=e.linkCtx,g=d._ctxCb,y=d.data,m=d.fn.paths[0];if(n=n||i._jsvLkEl,e&&m&&!e.to){if(p=i._jsvTr||!1,n&&(r=n.convertBack||r,c=n.tagCtx.props.trigger),p!==(c=(c=void 0===c?_.trigger:c)&&("INPUT"===i.tagName&&i.type!==_t&&i.type!==yt||"textarea"===i.type||i.contentEditable===It)&&c||!1)&&(_n(u=t(i),p,"off"),_n(u,i._jsvTr=c,"on")),o=(m=m._jsvto||m[0])&&m.length){if((s=m[o-1])._jsv){for(l=s;s.sb&&s.sb._jsv;)a=s=s.sb;s=(a=s.sb||a&&a.path)?a.slice(1):l.path}if(a)f=[l,s];else{for(;(f=g(a=s.split("^").join("."),y))&&(h=f.length);){if(f[0]._cp){if(f=f[0],g=v._gccb(f[0]),s=f[1],f=[f[0].data,f[1]],s._jsv){for((l=s).data=f[0],l._cpCtx=g;s.sb&&s.sb._jsv;)a=s=s.sb;f=[l,s=(a=s.sb||a&&a.path)?a.slice(1):l.path]}}else f=h>2?[f[h-3],f[h-2]]:[f[h-2]];y=f[0],s=f[1]}f=f||[y,a]}}else f=[];e.to=[f,r]}}function mn(e,t,n){var i,r,o=e.tagCtx.view,a=e.tagCtxs||[e.tagCtx],s=a.length,u=!t;if(t=t||e._.bnd.call(o.tmpl,(e.linkCtx||o).data,o,v),n)a=e.tagCtxs=t,e.tagCtx=a[0];else for(;s--;)i=a[s],r=t[s],l(i.props).setProperty(r.props),ie(i.ctx,r.ctx),i.args=r.args,u&&(i.tmpl=r.tmpl);return v._ths(e,a[0]),a}function En(e){for(var t,n,i,r=[],o=e.length,a=o;a--;)r.push(e[a]);for(a=o;a--;)if((n=r[a]).parentNode){if(i=n._jsvBnd)for(i=i.slice(1).split("&"),n._jsvBnd="",t=i.length;t--;)In(i[t],n._jsvLkEl,n);An(pn(n)+(n._df||""))}}function In(e,n,i){var r,o,a,s,l,u,c,f,h,d,g,v,_=Vt[e];if(n)n=n.targetTag||n,i._jsvLkEl=void 0;else if(_){for(r in delete Vt[e],_.bnd)s=_.bnd[r],l=_.cbId,p(s)?t([s]).off(Ue+l).off(De+l):t(s).off(De+l),delete _.bnd[r];if(o=_.linkCtx){if(a=o.tag){if(u=a.tagCtxs)for(c=u.length;c--;)(f=u[c].map)&&f.unmap();h=a.linkedElem,a.onUnbind&&a.onUnbind(a.tagCtx,o,a.ctx,!0),a.onDispose&&a.onDispose(),a._elCnt||(a._prv&&a._prv.parentNode.removeChild(a._prv),a._nxt&&a._nxt.parentNode.removeChild(a._nxt))}(g=(d=h&&h[0]||o.elem)&&d._jsvTr)&&(_n(h||t(d),g,"off"),d._jsvTr=void 0),"link"===(v=o.view).type?v.parent.removeViews(v._.key,void 0,!0):delete v._.bnds[e]}delete Ve[_.cbId]}}function Tn(e){e?((e=e.jquery?e:t(e)).each((function(){for(var e;(e=ot(this,!0))&&e.parent;)e.parent.removeViews(e._.key,void 0,!0);En(this.getElementsByTagName("*"))})),En(e)):(it&&(t(it).off(ft,Xt).off("blur","[contenteditable]",Xt),it=void 0),o.removeViews(),En(document.body.getElementsByTagName("*")))}function bn(e,t,n,i,r,o){var a,s,l,u,c,p,f,h=0,d=e===t;if(e){for(a=0,s=(l=fn(e)||[]).length;a<s;a++){if((p=(u=l[a]).id)===i&&u.ch===r){if(!o)break;s=0}d||(c="_"===u.ch?ut[p]:Vt[p].linkCtx.tag,u.open?c._prv=t:u.close&&(c._nxt=t)),h+=p.length+2}h&&e.setAttribute(pt,e.getAttribute(pt).slice(h)),(s=(f=t?t.getAttribute(pt):n._df).indexOf("/"+i+r)+1)&&(f=l._tkns.slice(0,h)+f.slice(s+(o?-1:i.length+1))),f&&(t?t.setAttribute(pt,f):Qt(n,f))}else Qt(n,cn(n._df,"#"+i+r)),!o&&!t&&Qt(n,cn(n._df,"/"+i+r))}function An(e){var t,n,i,r;if(r=fn(e,!0,Ht))for(t=0,n=r.length;t<n;t++)"_"===(i=r[t]).ch?(i=ut[i.id])&&i.type&&i.parent.removeViews(i._.key,void 0,!0):In(i.id)}function On(e,n){e.contents=function(e,n){e!==!!e&&(n=e,e=void 0);var i,r=t(this.nodes());return r[0]&&(i=n?r.filter(n):r,r=e&&n?i.add(r.find(n)):i),r},e.nodes=function(e,t,n){var i,r=this,o=r._elCnt,a=!t&&o,s=[];for(t=t||r._prv,n=n||r._nxt,i=a?t===r._nxt?r.parentElem.lastSibling:t:!1===r._.inline?t||r.linkCtx.elem.firstChild:t&&t.nextSibling;i&&(!n||i!==n);)(e||o||i.tagName!==Et)&&s.push(i),i=i.nextSibling;return s},e.childTags=function(e,t){e!==!!e&&(t=e,e=void 0);var n=this,i=n.link?n:n.tagCtx.view,r=n._prv,o=n._elCnt,a=[];return i.link(void 0,n.parentElem,o?r&&r.previousSibling:r,n._nxt,void 0,{get:{tags:a,deep:e,name:t,id:n.link?n._.id+"_":n._tgId+"^"}}),a},e.refresh=function(e){var t,n=this,i=n.linkCtx,r=n.tagCtx.view;return n.disposed&&_e("Removed tag"),void 0===e&&(e=v._tag(n,r,r.tmpl,mn(n),!0)),e+""===e&&(n.onUnbind&&n.onUnbind(n.tagCtx,i,n.ctx),t=$t(e,i,n._.inline?H:i.attr||en(n.parentElem,!0),n)),gn(n),t||n},e.update=function(e){var t=this.linkedElem;t&&Xt({target:t[0]},0,e)},n?e.domChange=function(){var e=this.parentElem,n=t.hasData(e)&&t._data(e).events,i="jsv-domchange";n&&n[i]&&t(e).triggerHandler(i,arguments)}:(e.addViews=function(e,t){var n=this,i=t.length,r=n.views;!n._.useKey&&i&&(r.length+i===n.data.length&&!1!==tn(n,e,n.tmpl,r,t,n.ctx)&&(n._.srt||n.fixIndex(e+i)))},e.removeViews=function(e,n,i,r){function o(e){var n,r,o,a,s,l,u=p[e];if(u&&u.link){if(n=u._.id,i||(l=u.nodes()),u.removeViews(void 0,void 0,!0),u.type=void 0,a=u._prv,s=u._nxt,o=u.parentElem,i||(u._elCnt&&bn(a,s,o,n,"_"),t(l).remove()),!u._elCnt)try{a.parentNode.removeChild(a),s.parentNode.removeChild(s)}catch{}for(r in Zt(u),u._.bnds)In(r);delete ut[n]}}var a,s,l,u=this,c=!u._.useKey,p=u.views;if(c&&(l=p.length),void 0===e)if(c){for(a=l;a--;)o(a);u.views=[]}else{for(s in p)o(s);u.views={}}else if(void 0===n&&(c?n=1:(o(e),delete p[e])),c&&n&&(r||l-n===u.data.length)){for(a=e+n;a-- >e;)o(a);p.splice(e,n),u._.sort||u.fixIndex(e)}},e.refresh=function(){var e=this,t=e.parent;t&&(tn(e,e.index,e.tmpl,t.views,e.data,void 0,!0),Zt(e))},e.fixIndex=function(e){for(var t=this.views,n=t.length;e<n--;)t[n].index!==n&&l(t[n]).setProperty("index",n)},e.link=sn)}function Cn(e){return this.tagCtx.view}return s=l.observe,v.onStore.template=function(e,n){n.link=on,e&&(t.link[e]=function(){return on.apply(n,arguments)})},v.viewInfos=fn,(m.delimiters=function(){var e=Nt.apply(0,arguments);return Nt!==re&&(e=re.apply(0,arguments)),rt=new RegExp("(?:^|\\s*)([\\w-]*)(\\"+A+")?(\\"+I+v.rTag+"(:\\w*)?\\"+T+")","g"),e})(),v.addSetting("trigger"),h.merge=function(e){var t,n=this.linkCtx._val||"",i=this.tagCtx.props.toggle;return i&&(t="(\\s(?="+(t=i.replace(/[\\^$.|?*+()[{]/g,"\\$&"))+"$)|(\\s)|^)("+t+"(\\s|$))",e=(n=n.replace(new RegExp(t),"$2"))+(e?(n&&" ")+i:"")),e},g({on:{attr:mt,init:function(e){for(var n,i=this,r=0,o=e.args,a=o.length;r<a&&!c(o[r]);r++);i._hi=a>r&&r+1,i._.inline&&(v.rTmpl.exec(n=e.tmpl.markup)||(i.template="<button>"+(t.trim(n)||e.params.args[r]||"noop")+"</button>"),i.attr=H)},onAfterLink:function(e,n){var i,r,o,a=this,s=a._hi,l=e.args,u=l.length,c=e.props,p=c.data,f=e.view,h=c.context;s&&(i=l[s-1],r=l.slice(s),l=l.slice(0,s-1),a._sel=l[1],o=a.activeElem=a.activeElem||t(a._.inline?(a._sel=l[1]||"*",a.parentElem):n.elem),h||(h=(h=/^(.*)[\.^][\w$]+$/.exec(e.params.args.slice(-r.length-1)[0]))&&v.tmplFn(I+":"+h[1]+T,f.tmpl,!0)(n.data,f)),a._evs&&a.onUnbind(),o.on(a._evs=l[0]||"click",a._sel,p??null,a._hlr=function(e){var t,o=!a._.inline;if(!o)for(t=a.contents("*"),u=t.length;!o&&u--;)t[u].contains(e.target)&&(o=!0);if(o)return i.apply(h||n.data,[].concat(r,e,{change:e.type,view:f,linkCtx:n},r.slice.call(arguments,1)))}))},onUpdate:function(){return!1},onUnbind:function(){var e=this;e.activeElem&&e.activeElem.off(e._evs,e._sel,e._hlr)},flow:!0,contentCtx:Cn,dataBoundOnly:!0},radiogroup:{init:function(e){this.name=e.props.name||"jsv"+Math.random()},onBind:function(e,n){var i,r=this,o=r.linkedElem=r._.inline?r.contents(!0,"input[type=radio]"):t(n.elem).find("input[type=radio]"),a=o.length;for(r._.inline?i=(i=r.contents("*")[0])&&t.view(i).ctx.tag===r.parent?i:r.parentElem:i=n.elem;a--;)o[a].name=o[a].name||r.name;t(i).on("jsv-domchange",(function(e,t){var n,s=t.ctx.parentTags;if(!r._.inline||i!==r.parentElem||s&&s[r.tagName]===r)for(o=r.linkedElem=r.contents(!0,"input[type=radio]"),a=o.length;a--;)(n=o[a])._jsvLkEl=r,n.name=n.name||r.name,yn(Vt[r._tgId],r,n),n._jsvBnd="&"+r._tgId+"+",n.checked=r.cvtArgs()[0]===n.value}))},onUpdate:function(e,t,n){return!1},contentCtx:Cn,dataBoundOnly:!0}}),ie(g.for,{onArrayChange:function(e,t,n,i){var r,o=e.target,a=o.length,s=this,l=t.change;if(s._.noVws||s.tagCtxs[1]&&("insert"===l&&a===t.items.length||"remove"===l&&!a))s.refresh();else for(r in s._.arrVws)(r=s._.arrVws[r]).data===o&&r._.onArrayChange.apply(r,arguments);s.domChange(n,i,t),e.done=!0},onAfterLink:function(e,t){var n,i,r,o,a=this,l=a._ars||{},u=a.tagCtxs,c=u.length,f=a.selected||0;for(n=0;n<=f;n++)o=(e=u[n]).map?e.map.tgt:e.args.length?e.args[0]:e.view.data,(r=l[n])&&o!==r[0]&&(s(r[0],r[1],!0),delete l[n]),!l[n]&&p(o)&&(s(o,i=function(n,i){var r=e;a.onArrayChange(n,i,r,t)}),l[n]=[o,i]);for(n=f+1;n<c;n++)(r=l[n])&&(s(r[0],r[1],!0),delete l[n]);a._ars=l},onDispose:function(){var e,t=this;for(e in t._ars)s(t._ars[e][0],t._ars[e][1],!0)}}),ie(g.if,{onUpdate:function(e,t,n){var i,r,o;for(i=0;r=this.tagCtxs[i];i++)if(o=r.props.tmpl!==n[i].props.tmpl||r.args.length&&!(r=r.args[0])!=!n[i].args[0],!this.convert&&r||o)return o;return!1},onAfterLink:function(e,t,n,i,r){r&&this.domChange(e,t,r)}}),g("props",{baseTag:"for",dataMap:a.map({getTgt:g.props.dataMap.getTgt,obsSrc:function(e,t,n){if("set"===n.change){for(var i=e.tgt,r=i.length;r--&&i[r].key!==n.path;);-1===r?n.path&&!n.remove&&l(i).insert({key:n.path,prop:n.value}):n.remove?l(i).remove(r):l(i[r]).setProperty("prop",n.value)}},obsTgt:function(e,t,n){var i,r=e.src,o=n.change;"set"===o?"prop"===n.path?l(r).setProperty(t.target.key,n.value):(l(r).removeProperty(n.oldValue),l(r).setProperty(n.value,t.target.prop)):"remove"===o?(i=n.items[0],l(r).removeProperty(i.key),delete r[i.key]):"insert"===o&&((i=n.items[0]).key&&l(r).setProperty(i.key,i.prop))},tgtFlt:function(e){return e.indexOf(".")<0}}),flow:!0}),ie(t,{view:ot=function(e,n,i){function r(e,t){if(e)for(s=fn(e,t,Ft),u=0,c=s.length;u<c&&(!(a=ut[s[u].id])||!(a=a&&i?a.get(!0,i):a));u++);}n!==!!n&&(i=n,n=void 0);var a,s,l,u,c,p,f,h=0,d=document.body;if(e&&e!==d&&o._.useKey>1&&(e=""+e===e?t(e)[0]:e.jquery?e[0]:e)){if(n){if(r(e._df,!0),!a)for(p=(f=Pt?e.querySelectorAll(Ot):t(Ot,e).get()).length,l=0;!a&&l<p;l++)r(f[l]);return a}for(;e;){if(s=fn(e,void 0,Bt))for(p=s.length;p--;)if((a=s[p]).open){if(h<1)return(a=ut[a.id])&&i?a.get(i):a||o;h--}else h++;e=e.previousSibling||e.parentNode}}return o},link:an,unlink:Tn,cleanData:function(e){e.length&&Lt&&En(e),xt.apply(t,arguments)}}),ie(t.fn,{link:function(e,t,n,i,r,o,a){return an(e,this,t,n,i,r,o,a)},unlink:function(){return Tn(this)},view:function(e,t){return ot(this[0],e,t)}}),t.each([H,"replaceWith","empty","remove"],(function(e,n){var i=t.fn[n];t.fn[n]=function(){var e;Lt=1;try{e=i.apply(this,arguments)}finally{Lt=0}return e}})),On(ie(o=v.topView,{tmpl:{links:{}}})),ut={0:o},a.getCtx=function(e){return e&&e._cp&&(e=e[1](e[0].data,e[0],v)),e},v._cp=function(e,t,n){if(n.linked){t=I+":"+t+T;var i=n.tmpl,r=o.tmpl.links,a=r[t];a||(r[t]=a=v.tmplFn(t,i,!0)),(e=[n,a])._cp=!0}return e},v._ceo=function e(t){var n,i=t,r=t.length;if(r)for(i=[];r--;)(n=t[r])._jsv&&((n=ie({},n)).prm=e(n.prm)),i.unshift(n);return i},v._gccb=function(e){return function(t,n,i){var r,o,a,s,l,u,p;if(e&&t){if(t._jsv)return t._jsv.call(e.tmpl,n,e,v);if("~"===t.charAt(0))return"~tag"===t.slice(0,4)&&(o=e.ctx,"."===t.charAt(4)&&(r=t.slice(5).split("."),o=o.tag),r)?o?[o,r.join("."),n]:[]:(t=t.slice(1).split("."),(s=e.hlp(l=t.shift(),!0))&&(s._cp?(t.length&&(u="."+t.join("."),(l=s[p=s.length-1])._jsv?(l.sb=u,l.bnd=!!i):(s[p]=(l+u).replace("#data.",""),"#view"===l.slice(0,5)&&(s[p]=s[p].slice(6),s.splice(p,0,e)))),a=[s]):(t.length||c(s))&&(a=[s,t.join("."),n])),a||[]);if("#"===t.charAt(0))return"#data"===t?[]:[e,t.replace(kt,""),n]}}},ct=v.advSet,v.advSet=function(){ct.call(v),e._jsv=y._jsv?ie(e._jsv||{},{views:ut,bindings:Vt}):void 0,at=y.linkAttr,st=Ot+",["+at+"]",(lt=y._wm).optgroup=lt.option,lt.tbody=lt.tfoot=lt.colgroup=lt.caption=lt.thead,lt.th=lt.td},m.advanced({linkAttr:"data-link",useViews:!1,noValidate:!1,_wm:{option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],svg_ns:[1,"<svg>","</svg>"],div:t.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},_fe:{input:{from:function(e){return e.type===_t?e[vt]:e.value},to:"value"},textarea:St,select:St,optgroup:{to:"label"}}}),t}),window)}));var u=(0,s.c)((0,r.a)()),c=(0,o.a)();l()(c),function(e){e.fn.checkboxButton=function(t){return this.each((function(){e(this).on("click",(function(n){let i=n.target.tagName,r=e(this).find(":checkbox");"INPUT"!==i&&(n.preventDefault(),r.prop("checked",!r.prop("checked")));let o=r.is(":checked");t.call(this,o)}),0)}))},e.fn.disable=function(){return this.each((function(){let t=e(this);t.addClass("disabled"),t.data("tabindex",t.attr("tabindex")),t.removeAttr("tabindex")}))},e.fn.ellipsis=function(t){return this.each((function(){let n=e(this),i=n.text();if(i.length>t){let e=i.substr(0,t);e=e.substr(0,Math.min(e.length,e.lastIndexOf(" "))),n.empty().html(e+"&hellip;")}}))},e.fn.ellipsisFill=function(t){let n=!0;return t||(n=!1),this.each((function(){let i=e(this);n||(t=i.text()),i.empty();let r=e('<span title="'+t+'"></span>');if(i.append(r),i.css("overflow","hidden"),r.css("white-space","nowrap"),r.html(t),r.width()>i.width()){let e=null;for(;r.width()>i.width();){let t=r.html();if(t=t.substring(0,t.lastIndexOf(" "))+"&hellip;",t===e)break;r.html(t),e=t}}}))},e.fn.ellipsisHtmlFixed=function(t,n){return this.each((function(){let i=e(this),r=i.html(),o=e("<span></span>");if(o.html(i.html().replace(/\s[\s]*/g," ").trim()),o.text().trim().length<=t)return;for(;o.text().trim().length>t;)o.removeLastWord(t);let a=o.html(),s=!1;i.toggle=function(){i.empty();let t=e('<a href="#" class="toggle"></a>');s?(i.html(r+" "),t.text("less"),t.switchClass("less","more")):(i.html(a+"&hellip; "),t.text("more"),t.switchClass("more","less")),t.one("click",(function(e){e.preventDefault(),i.toggle()})),s=!s,i.append(t),n&&n()},i.toggle()}))},e.fn.enable=function(){return this.each((function(){let t=e(this);t.removeClass("disabled"),t.attr("tabindex",t.data("tabindex"))}))},e.fn.equaliseHeight=function(t,n){let i=-1,r=Number.MAX_VALUE,o=[];t&&this.each((function(){e(this).height("auto")})),this.each((function(){let t=e(this).height();o.push(t),i=i>t?i:t,r=r<t?r:t}));let a=i;if(n){o.sort((function(e,t){return e-t}));let e=Math.floor(o.length/2);a=o.length%2?o[e]:(o[e-1]+o[e])/2}return this.each((function(){e(this).height(a)})),this},e.fn.getVisibleElementWithGreatestTabIndex=function(){let t=e(this),n=0,i=null;return t.find("*:visible[tabindex]").each((function(t,r){let o=e(r),a=parseInt(o.attr("tabindex"));a>n&&(n=a,i=o)})),i},e.fn.horizontalMargins=function(){let t=e(this);return parseInt(t.css("marginLeft"))+parseInt(t.css("marginRight"))},e.fn.leftMargin=function(){let t=e(this);return parseInt(t.css("marginLeft"))},e.fn.rightMargin=function(){let t=e(this);return parseInt(t.css("marginRight"))},e.fn.horizontalPadding=function(){let t=e(this);return parseInt(t.css("paddingLeft"))+parseInt(t.css("paddingRight"))},e.fn.leftPadding=function(){let t=e(this);return parseInt(t.css("paddingLeft"))},e.fn.rightPadding=function(){let t=e(this);return parseInt(t.css("paddingRight"))},e.mlp={x:0,y:0},e((function t(){let n=this===document?e(this):e(this).contents();n.mousemove((function(t){e.mlp={x:t.pageX,y:t.pageY}})),n.find("iframe").on("load",t)})),e.fn.ismouseover=function(){let t=!1;return this.eq(0).each((function(){let n=e(this).is("iframe")?e(this).contents().find("body"):e(this),i=n.offset();t=i.left<=e.mlp.x&&i.left+n.outerWidth()>e.mlp.x&&i.top<=e.mlp.y&&i.top+n.outerHeight()>e.mlp.y})),t};let t,n=e.fn.on;e.fn.on=function(){let e=Array.apply(null,arguments),i=e[e.length-1];if(isNaN(i)||1===i&&e.pop())return n.apply(this,e);let r=e.pop(),o=e.pop();return e.push((function(){let e=this,n=arguments;clearTimeout(t),t=setTimeout((function(){o.apply(e,n)}),r)})),n.apply(this,e)},e.fn.onEnter=function(t){return this.each((function(){e(this).on("keyup",(function(e){13===e.keyCode&&(e.preventDefault(),t())}),0)}))},e.fn.onPressed=function(t){return this.each((function(){let n=e(this);n.on("click",(function(e){e.preventDefault(),t(e)}),0),n.on("keydown",(function(e){13===e.keyCode&&(e.preventDefault(),t(e))}),0)}))},e.fn.removeLastWord=function(t=8,n=0){return this.each((function(){let i=e(this);if(i.contents().length>0){let e=i.contents().last();if(3===e[0].nodeType){let n=e.text().trim().split(" ");if(n.length>1)return n.splice(n.length-1,1),void(e[0].data=n.join(" "));if("undefined"!=typeof t&&1===n.length&&n[0].length>t)return void(e[0].data=n.join(" ").substring(0,t))}e.removeLastWord(t,n+1)}else n>0&&i.remove()}))},e.fn.switchClass=function(t,n){return this.each((function(){e(this).removeClass(t).addClass(n)}))},e.fn.targetBlank=function(){return this.each((function(){e(this).find("a").prop("target","_blank")}))},e.fn.toggleExpandText=function(t,n,i,r){return this.each((function(){let o=e(this),a=o.html();if(t>a.length)return;let s=!1,l=a.substr(0,t);l=l.substr(0,Math.min(l.length,l.lastIndexOf(" "))),o.toggle=function(){o.empty();let t=e('<a href="#" class="toggle"></a>');s?(o.html(a+"&nbsp;"),t.text(n),t.switchClass("less","more")):(o.html(l+"&nbsp;"),t.text(i),t.switchClass("more","less")),t.one("click",(function(e){e.preventDefault(),o.toggle()})),s=!s,o.append(t),r&&r()},o.toggle()}))},e.fn.toggleExpandTextByLines=function(t,n,i,r){return this.each((function(){let o=e(this),a=o.html(),s=e('<span>&hellip; <a href="#" class="toggle more">morepad</a></span>'),l=[a],u=o.height();for(;o.text().length>0;){o.removeLastWord();let e=o.html();o.append(s),u>o.height()&&(l.unshift(e),u=o.height()),s.remove()}if(l.length<=t)return void o.html(a);let c=l[t-1],p=!1;o.toggle=function(){o.empty();let t=e('<a href="#" class="toggle"></a>');p?(o.html(a+" "),t.text(n),t.switchClass("less","more")):(o.html(c+"&hellip; "),t.text(i),t.switchClass("more","less")),t.one("click",(function(e){e.preventDefault(),o.toggle()})),p=!p,o.append(t),r&&r()},o.toggle()}))},e.fn.toggleText=function(t,n){return this.each((function(){e(this).text()===t?e(this).text(n):e(this).text(t)}))},e.fn.updateAttr=function(t,n,i){return this.each((function(){let r=e(this),o=r.attr(t);o&&0===o.indexOf(n)&&(o=o.replace(n,i),r.attr(t,o))}))},e.fn.verticalMargins=function(){let t=e(this);return parseInt(t.css("marginTop"))+parseInt(t.css("marginBottom"))},e.fn.verticalPadding=function(){let t=e(this);return parseInt(t.css("paddingTop"))+parseInt(t.css("paddingBottom"))}}(c);var p={AV:{name:"uv-av-extension",loader:()=>Promise.all([n.e(5165),n.e(8386),n.e(5615),n.e(4580)]).then(n.bind(n,36910))},ALEPH:{name:"uv-aleph-extension",loader:()=>Promise.all([n.e(8386),n.e(2198),n.e(4919)]).then(n.bind(n,22198))},DEFAULT:{name:"uv-default-extension",loader:()=>Promise.all([n.e(8386),n.e(8860)]).then(n.bind(n,68860))},EBOOK:{name:"uv-ebook-extension",loader:()=>Promise.all([n.e(8386),n.e(7909)]).then(n.bind(n,57909))},MEDIAELEMENT:{name:"uv-mediaelement-extension",loader:()=>Promise.all([n.e(4051),n.e(8386),n.e(8384)]).then(n.bind(n,75202))},MODELVIEWER:{name:"uv-model-viewer-extension",loader:()=>Promise.all([n.e(6738),n.e(8386),n.e(5615),n.e(8605)]).then(n.bind(n,7827))},OSD:{name:"uv-openseadragon-extension",loader:()=>Promise.all([n.e(4077),n.e(8386),n.e(5615),n.e(7097)]).then(n.bind(n,94155))},PDF:{name:"uv-pdf-extension",loader:()=>Promise.all([n.e(8386),n.e(4267)]).then(n.bind(n,84267))},SLIDEATLAS:{name:"uv-openseadragon-extension",loader:()=>Promise.all([n.e(4077),n.e(8386),n.e(5615),n.e(7097)]).then(n.bind(n,94155))}},f=class extends i.a{constructor(e,t,n){super(e,t,n),this.options=e,this.adapter=t,this.isFullScreen=!1,this.disposed=!1,this._pubsub=new class{constructor(){this.events={},this.onPublishHandler=()=>{}}publish(e,t){let n=this.events[e];n&&n.forEach((e=>{e.call(this,t)})),this.onPublishHandler.call(this,e,t)}subscribe(e,t){let n=this.events[e];void 0===n&&(n=this.events[e]=[]),n.push(t)}subscribeAll(e){this.onPublishHandler=e}unsubscribe(e,t){let n=this.events[e];if(void 0===n)return;let i=n.indexOf(t);n.splice(i)}unsubscribeAll(){this.onPublishHandler=()=>{}}dispose(){this.events={}}},this._init(),this.resize()}_init(){return this._extensionRegistry={},this._extensionRegistry[u.ExternalResourceType.CANVAS]=p.OSD,this._extensionRegistry[u.ExternalResourceType.DOCUMENT]=p.PDF,this._extensionRegistry[u.ExternalResourceType.IMAGE]=p.OSD,this._extensionRegistry[u.ExternalResourceType.MOVING_IMAGE]=p.MEDIAELEMENT,this._extensionRegistry[u.ExternalResourceType.PHYSICAL_OBJECT]=p.MODELVIEWER,this._extensionRegistry[u.ExternalResourceType.SOUND]=p.MEDIAELEMENT,this._extensionRegistry[u.MediaType.AUDIO_MP4]=p.AV,this._extensionRegistry[u.MediaType.DICOM]=p.ALEPH,this._extensionRegistry[u.MediaType.DRACO]=p.MODELVIEWER,this._extensionRegistry[u.MediaType.EPUB]=p.EBOOK,this._extensionRegistry[u.MediaType.GIRDER]=p.SLIDEATLAS,this._extensionRegistry[u.MediaType.GLB]=p.MODELVIEWER,this._extensionRegistry[u.MediaType.GLTF]=p.MODELVIEWER,this._extensionRegistry[u.MediaType.JPG]=p.OSD,this._extensionRegistry[u.MediaType.MP3]=p.AV,this._extensionRegistry[u.MediaType.MPEG_DASH]=p.AV,this._extensionRegistry[u.MediaType.OPF]=p.EBOOK,this._extensionRegistry[u.MediaType.PDF]=p.PDF,this._extensionRegistry[u.MediaType.USDZ]=p.MODELVIEWER,this._extensionRegistry[u.MediaType.VIDEO_MP4]=p.AV,this._extensionRegistry[u.MediaType.WEBM]=p.AV,this._extensionRegistry[u.RenderingFormat.PDF]=p.PDF,this.on(a.a.CREATED,(e=>{this.hideSpinner()}),!1),this.on(a.a.RELOAD,(e=>{e.isReload=!0,this.set(e)}),!1),this.set(this.options.data),!0}async _getExtensionByType(e,t){let n=new((await e.loader()).default);return n.format=t,n.type=e,n}_getExtensionByFormat(e){return this._extensionRegistry[e]?this._getExtensionByType(this._extensionRegistry[e],e):this._getExtensionByType(p.DEFAULT,e)}set(e){if(this.extension){let t=Object.assign({},this.extension.data,e);t.isReload||t.iiifManifestId!==this.extension.data.iiifManifestId||t.manifestIndex!==this.extension.data.manifestIndex||t.collectionIndex!==this.extension.data.collectionIndex?(this.extension.data=t,this.showSpinner(),this._reload(this.extension.data)):(this.extension.data=t,this.extension.render())}else{if(!e.iiifManifestId)return void console.warn("iiifManifestId is required.");this._reload(e)}}publish(e,t){this._pubsub.publish(e,t)}subscribe(e,t){return this._pubsub.subscribe(e,t),()=>{this._pubsub.unsubscribe(e,t)}}subscribeAll(e){return this._pubsub.subscribeAll(e),()=>{this._pubsub.unsubscribeAll()}}dispose(){super.dispose(),this._pubsub.dispose(),this.disposed=!0}async _reload(e){this._pubsub.dispose(),e.target="",this.subscribe(a.a.RELOAD,(e=>{this.fire(a.a.RELOAD,e)})),c(this.options.target).empty();let t,n=this,i=await(0,r.h)({manifestUri:e.iiifManifestId,collectionIndex:e.collectionIndex,manifestIndex:e.manifestIndex||0,canvasIndex:e.canvasIndex||0,rangeId:e.rangeId,locale:e.locales?e.locales[0].name:void 0}),s=i.getTrackingLabel();if(s&&(s+=(window.location,window.parent.location,document.referrer),window.trackingLabel=s),t=i.getCurrentCanvas(),!t)return void n._error(`Canvas ${e.canvasIndex} not found.`);let l,u,f=t.getContent();if(f.length){let e=f[0].getBody();if(e&&e.length)if(u=e[0].getFormat(),u){if(l=await n._getExtensionByFormat(u),!l){let t=e[0].getType();t&&(l=await n._getExtensionByFormat(t))}}else{let t=e[0].getType();t&&(l=await n._getExtensionByFormat(t))}}else{let e=t.getType();if(e&&(l=await n._getExtensionByFormat(e)),!l){let e=t.getProperty("format");l=await n._getExtensionByFormat(e)}}let h=i.getRanges().length>0;l.type===p.AV&&!h&&(l=await n._getExtensionByType(p.MEDIAELEMENT,u)),l||(l=await n._getExtensionByFormat(p.DEFAULT.name)),e.locales||(e.locales=[],e.locales.push(o.e));let d=await l.loadConfig(e.locales[0].name);e.config=await n.configure(d),n._createExtension(l,e,i)}_error(e){this.fire(a.a.ERROR,e)}_createExtension(e,t,n){this.extension=e,this.extension&&(this.extension.extensionHost=this,this.extension.data=t,this.extension.helper=n,this.extension.create())}exitFullScreen(){this.extension&&this.extension.exitFullScreen()}resize(){this.extension&&!this.disposed&&this.extension.resize()}}},47903:function(e,t,n){n.d(t,{a:function(){return a},b:function(){return p},c:function(){return s},d:function(){return i},e:function(){return l},f:function(){return C},g:function(){return S},h:function(){return L}});var i,r,o=n(75285),a=(0,o.b)((e=>{var t;Object.defineProperty(e,"__esModule",{value:!0}),(t=e.AnnotationMotivation||(e.AnnotationMotivation={})).BOOKMARKING="oa:bookmarking",t.CLASSIFYING="oa:classifying",t.COMMENTING="oa:commenting",t.DESCRIBING="oa:describing",t.EDITING="oa:editing",t.HIGHLIGHTING="oa:highlighting",t.IDENTIFYING="oa:identifying",t.LINKING="oa:linking",t.MODERATING="oa:moderating",t.PAINTING="sc:painting",t.QUESTIONING="oa:questioning",t.REPLYING="oa:replying",t.TAGGING="oa:tagging",t.TRANSCRIBING="oad:transcribing",function(e){e.AUTO_ADVANCE="auto-advance",e.CONTINUOUS="continuous",e.FACING_PAGES="facing-pages",e.HIDDEN="hidden",e.INDIVIDUALS="individuals",e.MULTI_PART="multi-part",e.NO_NAV="no-nav",e.NON_PAGED="non-paged",e.PAGED="paged",e.REPEAT="repeat",e.SEQUENCE="sequence",e.THUMBNAIL_NAV="thumbnail-nav",e.TOGETHER="together",e.UNORDERED="unordered"}(e.Behavior||(e.Behavior={})),function(e){e.CANVAS="canvas",e.CHOICE="choice",e.OA_CHOICE="oa:choice",e.CONTENT_AS_TEXT="contentastext",e.DATASET="dataset",e.DOCUMENT="document",e.IMAGE="image",e.MODEL="model",e.MOVING_IMAGE="movingimage",e.PDF="pdf",e.PHYSICAL_OBJECT="physicalobject",e.SOUND="sound",e.TEXT="text",e.TEXTUALBODY="textualbody",e.VIDEO="video"}(e.ExternalResourceType||(e.ExternalResourceType={})),function(e){e.ANNOTATION="annotation",e.CANVAS="canvas",e.COLLECTION="collection",e.MANIFEST="manifest",e.RANGE="range",e.SEQUENCE="sequence"}(e.IIIFResourceType||(e.IIIFResourceType={})),function(e){e.AUDIO_MP4="audio/mp4",e.CORTO="application/corto",e.DICOM="application/dicom",e.DRACO="application/draco",e.EPUB="application/epub+zip",e.GIRDER="image/vnd.kitware.girder",e.GLB="model/gltf-binary",e.GLTF="model/gltf+json",e.IIIF_PRESENTATION_2='application/ld+json;profile="http://iiif.io/api/presentation/2/context.json"',e.IIIF_PRESENTATION_3='application/ld+json;profile="http://iiif.io/api/presentation/3/context.json"',e.JPG="image/jpeg",e.M3U8="application/vnd.apple.mpegurl",e.MP3="audio/mp3",e.MPEG_DASH="application/dash+xml",e.OBJ="text/plain",e.OPF="application/oebps-package+xml",e.PDF="application/pdf",e.PLY="application/ply",e.THREEJS="application/vnd.threejs+json",e.USDZ="model/vnd.usd+zip",e.VIDEO_MP4="video/mp4",e.WEBM="video/webm"}(e.MediaType||(e.MediaType={})),function(e){e.DOC="application/msword",e.DOCX="application/vnd.openxmlformats-officedocument.wordprocessingml.document",e.PDF="application/pdf"}(e.RenderingFormat||(e.RenderingFormat={})),function(e){e.IMAGE_0_COMPLIANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/compliance.html#level0",e.IMAGE_0_COMPLIANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/compliance.html#level1",e.IMAGE_0_COMPLIANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/compliance.html#level2",e.IMAGE_0_CONFORMANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/conformance.html#level0",e.IMAGE_0_CONFORMANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/conformance.html#level1",e.IMAGE_0_CONFORMANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/conformance.html#level2",e.IMAGE_1_COMPLIANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",e.IMAGE_1_COMPLIANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",e.IMAGE_1_COMPLIANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",e.IMAGE_1_CONFORMANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",e.IMAGE_1_CONFORMANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",e.IMAGE_1_CONFORMANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",e.IMAGE_1_LEVEL_0="http://iiif.io/api/image/1/level0.json",e.IMAGE_1_PROFILE_LEVEL_0="http://iiif.io/api/image/1/profiles/level0.json",e.IMAGE_1_LEVEL_1="http://iiif.io/api/image/1/level1.json",e.IMAGE_1_PROFILE_LEVEL_1="http://iiif.io/api/image/1/profiles/level1.json",e.IMAGE_1_LEVEL_2="http://iiif.io/api/image/1/level2.json",e.IMAGE_1_PROFILE_LEVEL_2="http://iiif.io/api/image/1/profiles/level2.json",e.IMAGE_2_LEVEL_0="http://iiif.io/api/image/2/level0.json",e.IMAGE_2_PROFILE_LEVEL_0="http://iiif.io/api/image/2/profiles/level0.json",e.IMAGE_2_LEVEL_1="http://iiif.io/api/image/2/level1.json",e.IMAGE_2_PROFILE_LEVEL_1="http://iiif.io/api/image/2/profiles/level1.json",e.IMAGE_2_LEVEL_2="http://iiif.io/api/image/2/level2.json",e.IMAGE_2_PROFILE_LEVEL_2="http://iiif.io/api/image/2/profiles/level2.json",e.AUTH_0_CLICK_THROUGH="http://iiif.io/api/auth/0/login/clickthrough",e.AUTH_0_LOGIN="http://iiif.io/api/auth/0/login",e.AUTH_0_LOGOUT="http://iiif.io/api/auth/0/logout",e.AUTH_0_RESTRICTED="http://iiif.io/api/auth/0/login/restricted",e.AUTH_0_TOKEN="http://iiif.io/api/auth/0/token",e.AUTH_1_CLICK_THROUGH="http://iiif.io/api/auth/1/clickthrough",e.AUTH_1_EXTERNAL="http://iiif.io/api/auth/1/external",e.AUTH_1_KIOSK="http://iiif.io/api/auth/1/kiosk",e.AUTH_1_LOGIN="http://iiif.io/api/auth/1/login",e.AUTH_1_LOGOUT="http://iiif.io/api/auth/1/logout",e.AUTH_1_PROBE="http://iiif.io/api/auth/1/probe",e.AUTH_1_TOKEN="http://iiif.io/api/auth/1/token",e.SEARCH_0="http://iiif.io/api/search/0/search",e.SEARCH_0_AUTO_COMPLETE="http://iiif.io/api/search/0/autocomplete",e.SEARCH_1="http://iiif.io/api/search/1/search",e.SEARCH_1_AUTO_COMPLETE="http://iiif.io/api/search/1/autocomplete",e.TRACKING_EXTENSIONS="http://universalviewer.io/tracking-extensions-profile",e.UI_EXTENSIONS="http://universalviewer.io/ui-extensions-profile",e.PRINT_EXTENSIONS="http://universalviewer.io/print-extensions-profile",e.SHARE_EXTENSIONS="http://universalviewer.io/share-extensions-profile",e.OTHER_MANIFESTATIONS="http://iiif.io/api/otherManifestations.json",e.IXIF="http://wellcomelibrary.org/ld/ixif/0/alpha.json"}(e.ServiceProfile||(e.ServiceProfile={})),function(e){e.BOTTOM_TO_TOP="bottom-to-top",e.LEFT_TO_RIGHT="left-to-right",e.RIGHT_TO_LEFT="right-to-left",e.TOP_TO_BOTTOM="top-to-bottom"}(e.ViewingDirection||(e.ViewingDirection={})),function(e){e.CONTINUOUS="continuous",e.INDIVIDUALS="individuals",e.NON_PAGED="non-paged",e.PAGED="paged",e.TOP="top"}(e.ViewingHint||(e.ViewingHint={}))})),s=(0,o.b)(((e,t)=>{var i,r;i="undefined"!=typeof self?self:e,r=function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t||4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}([function(e,t,n){function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),i(n(9)),i(n(10)),i(n(11)),i(n(12)),i(n(13)),i(n(14)),i(n(15)),i(n(16)),i(n(17)),i(n(31)),i(n(32)),i(n(33)),i(n(34)),i(n(35)),i(n(38)),i(n(39)),i(n(40)),i(n(41)),i(n(42)),i(n(43)),i(n(44)),i(n(45)),i(n(46)),i(n(47)),i(n(48)),i(n(49)),i(n(50)),i(n(3))},function(e,t,n){var i;Object.defineProperty(t,"__esModule",{value:!0}),(i=t.AnnotationMotivation||(t.AnnotationMotivation={})).BOOKMARKING="oa:bookmarking",i.CLASSIFYING="oa:classifying",i.COMMENTING="oa:commenting",i.DESCRIBING="oa:describing",i.EDITING="oa:editing",i.HIGHLIGHTING="oa:highlighting",i.IDENTIFYING="oa:identifying",i.LINKING="oa:linking",i.MODERATING="oa:moderating",i.PAINTING="sc:painting",i.QUESTIONING="oa:questioning",i.REPLYING="oa:replying",i.TAGGING="oa:tagging",i.TRANSCRIBING="oad:transcribing",function(e){e.AUTO_ADVANCE="auto-advance",e.CONTINUOUS="continuous",e.FACING_PAGES="facing-pages",e.HIDDEN="hidden",e.INDIVIDUALS="individuals",e.MULTI_PART="multi-part",e.NO_NAV="no-nav",e.NON_PAGED="non-paged",e.PAGED="paged",e.REPEAT="repeat",e.SEQUENCE="sequence",e.THUMBNAIL_NAV="thumbnail-nav",e.TOGETHER="together",e.UNORDERED="unordered"}(t.Behavior||(t.Behavior={})),function(e){e.CANVAS="canvas",e.CHOICE="choice",e.OA_CHOICE="oa:choice",e.CONTENT_AS_TEXT="contentastext",e.DATASET="dataset",e.DOCUMENT="document",e.IMAGE="image",e.MODEL="model",e.MOVING_IMAGE="movingimage",e.PDF="pdf",e.PHYSICAL_OBJECT="physicalobject",e.SOUND="sound",e.TEXT="text",e.TEXTUALBODY="textualbody",e.VIDEO="video"}(t.ExternalResourceType||(t.ExternalResourceType={})),function(e){e.ANNOTATION="annotation",e.CANVAS="canvas",e.COLLECTION="collection",e.MANIFEST="manifest",e.RANGE="range",e.SEQUENCE="sequence"}(t.IIIFResourceType||(t.IIIFResourceType={})),function(e){e.AUDIO_MP4="audio/mp4",e.CORTO="application/corto",e.DICOM="application/dicom",e.DRACO="application/draco",e.EPUB="application/epub+zip",e.GLB="model/gltf-binary",e.GLTF="model/gltf+json",e.IIIF_PRESENTATION_2='application/ld+json;profile="http://iiif.io/api/presentation/2/context.json"',e.IIIF_PRESENTATION_3='application/ld+json;profile="http://iiif.io/api/presentation/3/context.json"',e.JPG="image/jpeg",e.M3U8="application/vnd.apple.mpegurl",e.MP3="audio/mp3",e.MPEG_DASH="application/dash+xml",e.OBJ="text/plain",e.OPF="application/oebps-package+xml",e.PDF="application/pdf",e.PLY="application/ply",e.THREEJS="application/vnd.threejs+json",e.USDZ="model/vnd.usd+zip",e.VIDEO_MP4="video/mp4",e.WEBM="video/webm"}(t.MediaType||(t.MediaType={})),function(e){e.DOC="application/msword",e.DOCX="application/vnd.openxmlformats-officedocument.wordprocessingml.document",e.PDF="application/pdf"}(t.RenderingFormat||(t.RenderingFormat={})),function(e){e.IMAGE_0_COMPLIANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/compliance.html#level0",e.IMAGE_0_COMPLIANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/compliance.html#level1",e.IMAGE_0_COMPLIANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/compliance.html#level2",e.IMAGE_0_CONFORMANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/conformance.html#level0",e.IMAGE_0_CONFORMANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/conformance.html#level1",e.IMAGE_0_CONFORMANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/conformance.html#level2",e.IMAGE_1_COMPLIANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",e.IMAGE_1_COMPLIANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",e.IMAGE_1_COMPLIANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",e.IMAGE_1_CONFORMANCE_LEVEL_0="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",e.IMAGE_1_CONFORMANCE_LEVEL_1="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",e.IMAGE_1_CONFORMANCE_LEVEL_2="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",e.IMAGE_1_LEVEL_0="http://iiif.io/api/image/1/level0.json",e.IMAGE_1_PROFILE_LEVEL_0="http://iiif.io/api/image/1/profiles/level0.json",e.IMAGE_1_LEVEL_1="http://iiif.io/api/image/1/level1.json",e.IMAGE_1_PROFILE_LEVEL_1="http://iiif.io/api/image/1/profiles/level1.json",e.IMAGE_1_LEVEL_2="http://iiif.io/api/image/1/level2.json",e.IMAGE_1_PROFILE_LEVEL_2="http://iiif.io/api/image/1/profiles/level2.json",e.IMAGE_2_LEVEL_0="http://iiif.io/api/image/2/level0.json",e.IMAGE_2_PROFILE_LEVEL_0="http://iiif.io/api/image/2/profiles/level0.json",e.IMAGE_2_LEVEL_1="http://iiif.io/api/image/2/level1.json",e.IMAGE_2_PROFILE_LEVEL_1="http://iiif.io/api/image/2/profiles/level1.json",e.IMAGE_2_LEVEL_2="http://iiif.io/api/image/2/level2.json",e.IMAGE_2_PROFILE_LEVEL_2="http://iiif.io/api/image/2/profiles/level2.json",e.AUTH_0_CLICK_THROUGH="http://iiif.io/api/auth/0/login/clickthrough",e.AUTH_0_LOGIN="http://iiif.io/api/auth/0/login",e.AUTH_0_LOGOUT="http://iiif.io/api/auth/0/logout",e.AUTH_0_RESTRICTED="http://iiif.io/api/auth/0/login/restricted",e.AUTH_0_TOKEN="http://iiif.io/api/auth/0/token",e.AUTH_1_CLICK_THROUGH="http://iiif.io/api/auth/1/clickthrough",e.AUTH_1_EXTERNAL="http://iiif.io/api/auth/1/external",e.AUTH_1_KIOSK="http://iiif.io/api/auth/1/kiosk",e.AUTH_1_LOGIN="http://iiif.io/api/auth/1/login",e.AUTH_1_LOGOUT="http://iiif.io/api/auth/1/logout",e.AUTH_1_PROBE="http://iiif.io/api/auth/1/probe",e.AUTH_1_TOKEN="http://iiif.io/api/auth/1/token",e.SEARCH_0="http://iiif.io/api/search/0/search",e.SEARCH_0_AUTO_COMPLETE="http://iiif.io/api/search/0/autocomplete",e.SEARCH_1="http://iiif.io/api/search/1/search",e.SEARCH_1_AUTO_COMPLETE="http://iiif.io/api/search/1/autocomplete",e.TRACKING_EXTENSIONS="http://universalviewer.io/tracking-extensions-profile",e.UI_EXTENSIONS="http://universalviewer.io/ui-extensions-profile",e.PRINT_EXTENSIONS="http://universalviewer.io/print-extensions-profile",e.SHARE_EXTENSIONS="http://universalviewer.io/share-extensions-profile",e.OTHER_MANIFESTATIONS="http://iiif.io/api/otherManifestations.json",e.IXIF="http://wellcomelibrary.org/ld/ixif/0/alpha.json"}(t.ServiceProfile||(t.ServiceProfile={})),function(e){e.BOTTOM_TO_TOP="bottom-to-top",e.LEFT_TO_RIGHT="left-to-right",e.RIGHT_TO_LEFT="right-to-left",e.TOP_TO_BOTTOM="top-to-bottom"}(t.ViewingDirection||(t.ViewingDirection={})),function(e){e.CONTINUOUS="continuous",e.INDIVIDUALS="individuals",e.NON_PAGED="non-paged",e.PAGED="paged",e.TOP="top"}(t.ViewingHint||(t.ViewingHint={}))},function(e,t,n){var i=n(21).Symbol;e.exports=i},function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{l(i.next(e))}catch(t){o(t)}}function s(e){try{l(i.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((i=i.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=n(1),s=n(36);n(37);var l=function(){function e(){}return e.getMediaType=function(e){return(e=(e=e.toLowerCase()).split(";")[0]).trim()},e.getImageQuality=function(e){return e===a.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_1||e===a.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_2||e===a.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_1||e===a.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_2||e===a.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_1||e===a.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_2||e===a.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_1||e===a.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_2||e===a.ServiceProfile.IMAGE_1_LEVEL_1||e===a.ServiceProfile.IMAGE_1_PROFILE_LEVEL_1||e===a.ServiceProfile.IMAGE_1_LEVEL_2||e===a.ServiceProfile.IMAGE_1_PROFILE_LEVEL_2?"native":"default"},e.getInexactLocale=function(e){return-1!==e.indexOf("-")?e.substr(0,e.indexOf("-")):e},e.getLocalisedValue=function(e,t){if(!Array.isArray(e))return e;for(var n=0;n<e.length;n++){var i=e[n];if(t===i["@language"])return i["@value"]}var r=t.substr(0,t.indexOf("-"));for(n=0;n<e.length;n++){var o=e[n];if(o["@language"]===r)return o["@value"]}return null},e.generateTreeNodeIds=function(t,n){var i;void 0===n&&(n=0),i=t.parentNode?t.parentNode.id+"-"+n:"0",t.id=i;for(var r=0;r<t.nodes.length;r++){var o=t.nodes[r];e.generateTreeNodeIds(o,r)}},e.normaliseType=function(e){return-1!==(e=(e||"").toLowerCase()).indexOf(":")?e.split(":")[1]:e},e.normaliseUrl=function(e){return-1!==(e=e.substr(e.indexOf("://"))).indexOf("#")&&(e=e.split("#")[0]),e},e.normalisedUrlsMatch=function(t,n){return e.normaliseUrl(t)===e.normaliseUrl(n)},e.isImageProfile=function(t){return!!(e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_0)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_1)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_2)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_0)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_2)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_0)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_1)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_2)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_1)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_2)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_1_LEVEL_0)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_1_PROFILE_LEVEL_0)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_1_LEVEL_1)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_1_PROFILE_LEVEL_1)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_1_LEVEL_2)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_1_PROFILE_LEVEL_2)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_2_LEVEL_0)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_2_PROFILE_LEVEL_0)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_2_LEVEL_1)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_2_PROFILE_LEVEL_1)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_2_LEVEL_2)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_2_PROFILE_LEVEL_2))},e.isLevel0ImageProfile=function(t){return!!(e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_0)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_0)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_0)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_0)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_1_LEVEL_0)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_1_PROFILE_LEVEL_0)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_2_LEVEL_0)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_2_PROFILE_LEVEL_0))},e.isLevel1ImageProfile=function(t){return!!(e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_1)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_1)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_1)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_1)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_1_LEVEL_1)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_1_PROFILE_LEVEL_1)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_2_LEVEL_1)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_2_PROFILE_LEVEL_1))},e.isLevel2ImageProfile=function(t){return!!(e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_0_COMPLIANCE_LEVEL_2)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_1_COMPLIANCE_LEVEL_2)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_0_CONFORMANCE_LEVEL_2)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_1_CONFORMANCE_LEVEL_2)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_1_LEVEL_2)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_1_PROFILE_LEVEL_2)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_2_LEVEL_2)||e.normalisedUrlsMatch(t,a.ServiceProfile.IMAGE_2_PROFILE_LEVEL_2))},e.parseManifest=function(e,t){return o.Deserialiser.parse(e,t)},e.checkStatus=function(e){if(e.ok)return e;var t=new Error(e.statusText);return t.response=e,Promise.reject(t)},e.loadManifest=function(t){return new Promise((function(n,i){fetch(t).then(e.checkStatus).then((function(e){return e.json()})).then((function(e){n(e)})).catch((function(e){i()}))}))},e.loadExternalResourcesAuth1=function(t,n,i,r,o,a,s,l){return new Promise((function(u,c){var p=t.map((function(t){return e.loadExternalResourceAuth1(t,n,i,r,o,a,s,l)}));Promise.all(p).then((function(){u(t)})).catch((function(e){c(e)}))}))},e.loadExternalResourceAuth1=function(t,n,o,a,l,u,c,p){return i(this,void 0,void 0,(function(){var i;return r(this,(function(r){switch(r.label){case 0:return[4,a(t)];case 1:return(i=r.sent())?[4,t.getData(i)]:[3,6];case 2:return r.sent(),t.status!==s.OK?[3,3]:[2,t];case 3:return[4,e.doAuthChain(t,n,o,l,u,c,p)];case 4:r.sent(),r.label=5;case 5:if(t.status===s.OK||t.status===s.MOVED_TEMPORARILY)return[2,t];throw e.createAuthorizationFailedError();case 6:return[4,t.getData()];case 7:return r.sent(),t.status!==s.MOVED_TEMPORARILY&&t.status!==s.UNAUTHORIZED?[3,9]:[4,e.doAuthChain(t,n,o,l,u,c,p)];case 8:r.sent(),r.label=9;case 9:if(t.status===s.OK||t.status===s.MOVED_TEMPORARILY)return[2,t];throw e.createAuthorizationFailedError()}}))}))},e.doAuthChain=function(t,n,o,a,l,u,c){return i(this,void 0,void 0,(function(){var i,p,f,h,d,g,v,_;return r(this,(function(r){switch(r.label){case 0:return t.isAccessControlled()?((i=t.externalService)&&(i.options=t.options),(p=t.kioskService)&&(p.options=t.options),(f=t.clickThroughService)&&(f.options=t.options),(h=t.loginService)&&(h.options=t.options),t.isResponseHandled||t.status!==s.MOVED_TEMPORARILY?[3,2]:[4,u(t)]):[2,t];case 1:case 3:case 6:case 10:case 14:return r.sent(),[2,t];case 2:return d=null,g=null,(d=i)?(g=d,[4,e.attemptResourceWithToken(t,o,d)]):[3,4];case 4:return(d=p)?(g=d,(v=n(d))?[4,a(v)]:[3,7]):[3,7];case 5:case 9:case 13:return r.sent(),[4,e.attemptResourceWithToken(t,o,d)];case 7:return(d=f)?(g=d,[4,l(t,d)]):[3,11];case 8:return(_=r.sent())?[4,a(_)]:[3,11];case 11:return(d=h)?(g=d,[4,l(t,d)]):[3,15];case 12:return(_=r.sent())?[4,a(_)]:[3,15];case 15:return g&&c(t,g),[2]}}))}))},e.attemptResourceWithToken=function(e,t,n){return i(this,void 0,void 0,(function(){var i,o;return r(this,(function(r){switch(r.label){case 0:return(i=n.getService(a.ServiceProfile.AUTH_1_TOKEN))?[4,t(e,i)]:[3,3];case 1:return(o=r.sent())&&o.accessToken?[4,e.getData(o)]:[3,3];case 2:return r.sent(),[2,e];case 3:return[2]}}))}))},e.loadExternalResourcesAuth09=function(t,n,i,r,o,a,s,l,u,c){return new Promise((function(p,f){var h=t.map((function(t){return e.loadExternalResourceAuth09(t,n,i,r,o,a,s,l,u,c)}));Promise.all(h).then((function(){p(t)})).catch((function(e){f(e)}))}))},e.loadExternalResourceAuth09=function(t,n,i,r,o,a,l,u,c,p){return new Promise((function(f,h){p&&p.pessimisticAccessControl?t.getData().then((function(){t.isAccessControlled()?t.clickThroughService?(f(i(t)),f(r(t))):o(t).then((function(){a(t,!0).then((function(n){t.getData(n).then((function(){f(c(t))})).catch((function(t){h(e.createInternalServerError(t))}))})).catch((function(t){h(e.createInternalServerError(t))}))})).catch((function(t){h(e.createInternalServerError(t))})):f(t)})).catch((function(t){h(e.createInternalServerError(t))})):u(t,n).then((function(p){p?t.getData(p).then((function(){t.status===s.OK?f(c(t)):e.authorize(t,n,i,r,o,a,l,u).then((function(){f(c(t))})).catch((function(t){h(e.createAuthorizationFailedError())}))})).catch((function(t){h(e.createAuthorizationFailedError())})):e.authorize(t,n,i,r,o,a,l,u).then((function(){f(c(t))})).catch((function(t){h(e.createAuthorizationFailedError())}))})).catch((function(t){h(e.createAuthorizationFailedError())}))}))},e.createError=function(e,t){var n=new Error;return n.message=t,n.name=String(e),n},e.createAuthorizationFailedError=function(){return e.createError(o.StatusCode.AUTHORIZATION_FAILED,"Authorization failed")},e.createRestrictedError=function(){return e.createError(o.StatusCode.RESTRICTED,"Restricted")},e.createInternalServerError=function(t){return e.createError(o.StatusCode.INTERNAL_SERVER_ERROR,t)},e.authorize=function(t,n,i,r,o,a,l,u){return new Promise((function(c,p){t.getData().then((function(){t.isAccessControlled()?u(t,n).then((function(u){u?t.getData(u).then((function(){t.status===s.OK?c(t):e.showAuthInteraction(t,n,i,r,o,a,l,c,p)})).catch((function(t){p(e.createInternalServerError(t))})):a(t,!1).then((function(u){u?l(t,u,n).then((function(){t.getData(u).then((function(){t.status===s.OK?c(t):e.showAuthInteraction(t,n,i,r,o,a,l,c,p)})).catch((function(t){p(e.createInternalServerError(t))}))})).catch((function(t){p(e.createInternalServerError(t))})):e.showAuthInteraction(t,n,i,r,o,a,l,c,p)}))})).catch((function(t){p(e.createInternalServerError(t))})):c(t)}))}))},e.showAuthInteraction=function(t,n,i,r,o,a,l,u,c){t.status!==s.MOVED_TEMPORARILY||t.isResponseHandled?t.clickThroughService&&!t.isResponseHandled?i(t).then((function(){a(t,!0).then((function(i){l(t,i,n).then((function(){t.getData(i).then((function(){u(t)})).catch((function(t){c(e.createInternalServerError(t))}))})).catch((function(t){c(e.createInternalServerError(t))}))})).catch((function(t){c(e.createInternalServerError(t))}))})):o(t).then((function(){a(t,!0).then((function(i){l(t,i,n).then((function(){t.getData(i).then((function(){u(t)})).catch((function(t){c(e.createInternalServerError(t))}))})).catch((function(t){c(e.createInternalServerError(t))}))})).catch((function(t){c(e.createInternalServerError(t))}))})):u(t)},e.getService=function(e,t){for(var n=this.getServices(e),i=0;i<n.length;i++){var r=n[i];if(r.getProfile()===t)return r}return null},e.getResourceById=function(t,n){return e.traverseAndFind(t.__jsonld,"@id",n)},e.traverseAndFind=function(t,n,i){if(t.hasOwnProperty(n)&&t[n]===i)return t;for(var r=0;r<Object.keys(t).length;r++)if("object"==typeof t[Object.keys(t)[r]]){var o=e.traverseAndFind(t[Object.keys(t)[r]],n,i);if(null!=o)return o}},e.getServices=function(t,n){var i=void 0===n?{}:n,r=i.onlyService,a=void 0!==r&&r,s=i.onlyServices,l=void 0!==s&&s,u=i.skipParentResources,c=[];(void 0===u||!u)&&t&&t.options&&t.options.resource&&t.options.resource!==t&&c.push.apply(c,e.getServices(t.options.resource,{onlyServices:!0}));var p=l?[]:(t.__jsonld||t).service||[];if(Array.isArray(p)||(p=[p]),a||p.push.apply(p,(t.__jsonld||t).services||[]),0===p.length)return c;for(var f=0;f<p.length;f++){var h=p[f];if("string"==typeof h){var d=this.getResourceById(t.options.resource,h);d&&c.push(new o.Service(d.__jsonld||d,t.options))}else c.push(new o.Service(h,t.options))}return c},e.getTemporalComponent=function(e){var t=/t=([^&]+)/g.exec(e),n=null;return t&&t[1]&&(n=t[1].split(",")),n},e}();t.Utils=l},function(e,t,n){var i=n(19),r=n(20);e.exports=function e(t,n,o,a,s){var l=-1,u=t.length;for(o||(o=r),s||(s=[]);++l<u;){var c=t[l];n>0&&o(c)?n>1?e(c,n-1,o,a,s):i(s,c):a||(s[s.length]=c)}return s}},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t,n){n.r(t),t.default=function(e,t){return t=t||{},new Promise((function(n,i){var r=new XMLHttpRequest,o=[],a=[],s={},l=function(){return{ok:2==(r.status/100|0),statusText:r.statusText,status:r.status,url:r.responseURL,text:function(){return Promise.resolve(r.responseText)},json:function(){return Promise.resolve(JSON.parse(r.responseText))},blob:function(){return Promise.resolve(new Blob([r.response]))},clone:l,headers:{keys:function(){return o},entries:function(){return a},get:function(e){return s[e.toLowerCase()]},has:function(e){return e.toLowerCase()in s}}}};for(var u in r.open(t.method||"get",e,!0),r.onload=function(){r.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,(function(e,t,n){o.push(t=t.toLowerCase()),a.push([t,n]),s[t]=s[t]?s[t]+","+n:n})),n(l())},r.onerror=i,r.withCredentials="include"==t.credentials,t.headers)r.setRequestHeader(u,t.headers[u]);r.send(t.body||null)}))}},function(e,t,n){e.exports=n(8)},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(0));var i=n(3);t.loadManifest=function(e){return i.Utils.loadManifest(e)},t.parseManifest=function(e,t){return i.Utils.parseManifest(e,t)}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.__jsonld=e,this.context=this.getProperty("context"),this.id=this.getProperty("id")}return e.prototype.getProperty=function(e){var t=null;return this.__jsonld&&((t=this.__jsonld[e])||(t=this.__jsonld["@"+e])),t},e}();t.JSONLDResource=i},function(e,t,n){var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=n(1),s=function(e){function t(t,n){var i=e.call(this,t)||this;return i.options=n,i}return r(t,e),t.prototype.getIIIFResourceType=function(){return o.Utils.normaliseType(this.getProperty("type"))},t.prototype.getLabel=function(){var e=this.getProperty("label");return e?o.PropertyValue.parse(e,this.options.locale):new o.PropertyValue([],this.options.locale)},t.prototype.getDefaultLabel=function(){return this.getLabel().getValue(this.options.locale)},t.prototype.getMetadata=function(){var e=this.getProperty("metadata"),t=[];if(!e)return t;for(var n=0;n<e.length;n++){var i=e[n],r=new o.LabelValuePair(this.options.locale);r.parse(i),t.push(r)}return t},t.prototype.getRendering=function(e){for(var t=this.getRenderings(),n=0;n<t.length;n++){var i=t[n];if(i.getFormat()===e)return i}return null},t.prototype.getRenderings=function(){var e,t=[];if(!(e=this.__jsonld?this.__jsonld.rendering:this.rendering))return t;Array.isArray(e)||(e=[e]);for(var n=0;n<e.length;n++){var i=e[n];t.push(new o.Rendering(i,this.options))}return t},t.prototype.getRequiredStatement=function(){var e=null,t=this.getProperty("requiredStatement");return t&&(e=new o.LabelValuePair(this.options.locale)).parse(t),e},t.prototype.getService=function(e){return o.Utils.getService(this,e)},t.prototype.getServices=function(){return o.Utils.getServices(this)},t.prototype.getThumbnail=function(){var e=this.getProperty("thumbnail");return Array.isArray(e)&&(e=e[0]),e?new o.Thumbnail(e,this.options):null},t.prototype.isAnnotation=function(){return this.getIIIFResourceType()===a.IIIFResourceType.ANNOTATION},t.prototype.isCanvas=function(){return this.getIIIFResourceType()===a.IIIFResourceType.CANVAS},t.prototype.isCollection=function(){return this.getIIIFResourceType()===a.IIIFResourceType.COLLECTION},t.prototype.isManifest=function(){return this.getIIIFResourceType()===a.IIIFResourceType.MANIFEST},t.prototype.isRange=function(){return this.getIIIFResourceType()===a.IIIFResourceType.RANGE},t.prototype.isSequence=function(){return this.getIIIFResourceType()===a.IIIFResourceType.SEQUENCE},t}(o.JSONLDResource);t.ManifestResource=s},function(e,t,n){var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=function(e){function t(t,n){return e.call(this,t,n)||this}return r(t,e),t.prototype.getFormat=function(){var e=this.getProperty("format");return e?e.toLowerCase():null},t.prototype.getResources=function(){var e=[];if(!this.__jsonld.resources)return e;for(var t=0;t<this.__jsonld.resources.length;t++){var n=this.__jsonld.resources[t],i=new o.Annotation(n,this.options);e.push(i)}return e},t.prototype.getType=function(){var e=this.getProperty("type");return e?o.Utils.normaliseType(e):null},t.prototype.getWidth=function(){return this.getProperty("width")},t.prototype.getHeight=function(){return this.getProperty("height")},t.prototype.getMaxWidth=function(){return this.getProperty("maxWidth")},t.prototype.getMaxHeight=function(){return this.getProperty("maxHeight")?null:this.getMaxWidth()},t}(o.ManifestResource);t.Resource=a},function(e,t,n){var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=n(1),s=function(e){function t(t,n){var i=e.call(this,t,n)||this;i.index=-1,i.isLoaded=!1;var r={defaultLabel:"-",locale:"en-GB",resource:i,pessimisticAccessControl:!1};return i.options=Object.assign(r,n),i}return r(t,e),t.prototype.getAttribution=function(){var e=this.getProperty("attribution");return e?o.PropertyValue.parse(e,this.options.locale):new o.PropertyValue([],this.options.locale)},t.prototype.getDescription=function(){var e=this.getProperty("description");return e?o.PropertyValue.parse(e,this.options.locale):new o.PropertyValue([],this.options.locale)},t.prototype.getHomepage=function(){var e=this.getProperty("homepage");return e?"string"==typeof e?e:(Array.isArray(e)&&e.length&&(e=e[0]),e["@id"]||e.id):null},t.prototype.getIIIFResourceType=function(){return o.Utils.normaliseType(this.getProperty("type"))},t.prototype.getLogo=function(){var e=this.getProperty("logo");if(!e){var t=this.getProperty("provider");if(!t)return null;e=t.logo}return e?"string"==typeof e?e:(Array.isArray(e)&&e.length&&(e=e[0]),e["@id"]||e.id):null},t.prototype.getLicense=function(){return o.Utils.getLocalisedValue(this.getProperty("license"),this.options.locale)},t.prototype.getNavDate=function(){return new Date(this.getProperty("navDate"))},t.prototype.getRelated=function(){return this.getProperty("related")},t.prototype.getSeeAlso=function(){return this.getProperty("seeAlso")},t.prototype.getTrackingLabel=function(){var e=this.getService(a.ServiceProfile.TRACKING_EXTENSIONS);return e?e.getProperty("trackingLabel"):""},t.prototype.getDefaultTree=function(){return this.defaultTree=new o.TreeNode("root"),this.defaultTree.data=this,this.defaultTree},t.prototype.getRequiredStatement=function(){var e=null,t=this.getProperty("requiredStatement");if(t)(e=new o.LabelValuePair(this.options.locale)).parse(t);else{var n=this.getAttribution();n&&((e=new o.LabelValuePair(this.options.locale)).value=n)}return e},t.prototype.isCollection=function(){return this.getIIIFResourceType()===a.IIIFResourceType.COLLECTION},t.prototype.isManifest=function(){return this.getIIIFResourceType()===a.IIIFResourceType.MANIFEST},t.prototype.load=function(){var e=this;return new Promise((function(t){if(e.isLoaded)t(e);else{var n=e.options;n.navDate=e.getNavDate();var i=e.__jsonld.id;i||(i=e.__jsonld["@id"]),o.Utils.loadManifest(i).then((function(i){e.parentLabel=e.getLabel().getValue(n.locale);var r=o.Deserialiser.parse(i,n);(e=Object.assign(e,r)).index=n.index,t(e)}))}}))},t}(o.ManifestResource);t.IIIFResource=s},function(e,t,n){var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=function(e){function t(t,n){return e.call(this,t,n)||this}return r(t,e),t.prototype.getBody=function(){var e=[],t=this.getProperty("body");if(t)if(Array.isArray(t))for(var n=0;n<t.length;n++)if((a=t[n]).items)for(var i=0;i<a.items.length;i++){var r=a.items[i];e.push(new o.AnnotationBody(r,this.options))}else e.push(new o.AnnotationBody(a,this.options));else if(t.items)for(n=0;n<t.items.length;n++){var a=t.items[n];e.push(new o.AnnotationBody(a,this.options))}else e.push(new o.AnnotationBody(t,this.options));return e},t.prototype.getMotivation=function(){return this.getProperty("motivation")||null},t.prototype.getOn=function(){return this.getProperty("on")},t.prototype.getTarget=function(){return this.getProperty("target")},t.prototype.getResource=function(){return new o.Resource(this.getProperty("resource"),this.options)},t}(o.ManifestResource);t.Annotation=a},function(e,t,n){var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=function(e){function t(t,n){return e.call(this,t,n)||this}return r(t,e),t.prototype.getFormat=function(){var e=this.getProperty("format");return e?o.Utils.getMediaType(e):null},t.prototype.getType=function(){return this.getProperty("type")?o.Utils.normaliseType(this.getProperty("type")):null},t.prototype.getWidth=function(){return this.getProperty("width")},t.prototype.getHeight=function(){return this.getProperty("height")},t}(o.ManifestResource);t.AnnotationBody=a},function(e,t,n){var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=function(e){function t(t,n,i){var r=e.call(this,n)||this;return r.label=t,r.options=i,r}return r(t,e),t.prototype.getIIIFResourceType=function(){return o.Utils.normaliseType(this.getProperty("type"))},t.prototype.getLabel=function(){return this.label},t.prototype.getResources=function(){var e=this;return this.getProperty("resources").map((function(t){return new o.Annotation(t,e.options)}))},t.prototype.load=function(){var e=this;return new Promise((function(t,n){if(e.isLoaded)t(e);else{var i=e.__jsonld.id;i||(i=e.__jsonld["@id"]),o.Utils.loadManifest(i).then((function(n){e.__jsonld=n,e.context=e.getProperty("context"),e.id=e.getProperty("id"),e.isLoaded=!0,t(e)})).catch(n)}}))},t}(o.JSONLDResource);t.AnnotationList=a},function(e,t,n){var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n){return e.call(this,t,n)||this}return r(t,e),t.prototype.getItems=function(){return this.getProperty("items")},t}(n(0).ManifestResource);t.AnnotationPage=o},function(e,t,n){var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=n(0),s=n(18),l=n(30),u=function(e){function t(t,n){return e.call(this,t,n)||this}return r(t,e),t.prototype.getCanonicalImageUri=function(e){var t,n=null,i="default",r=e;if(this.externalResource&&this.externalResource.data&&this.externalResource.data["@id"])n=this.externalResource.data["@id"],r||(r=this.externalResource.data.width),this.externalResource.data["@context"]&&(this.externalResource.data["@context"].indexOf("/1.0/context.json")>-1||this.externalResource.data["@context"].indexOf("/1.1/context.json")>-1||this.externalResource.data["@context"].indexOf("/1/context.json")>-1)&&(i="native");else{var o=this.getImages();if(o&&o.length){var s=o[0].getResource(),l=s.getServices();r||(r=s.getWidth());var u=l?l.find((function(e){return a.Utils.isImageProfile(e.getProfile())})):null;if(u)n=u.id,i=a.Utils.getImageQuality(u.getProfile());else if(r===s.getWidth())return s.id}if(!n){var c=this.getProperty("thumbnail");if(c){if("string"==typeof c)return c;if(c["@id"])return c["@id"];if(c.length)return c[0].id}}}return t=r+",",n&&n.endsWith("/")&&(n=n.substr(0,n.length-1)),[n,"full",t,0,i+".jpg"].join("/")},t.prototype.getMaxDimensions=function(){var e,t=null;return this.externalResource&&this.externalResource.data&&this.externalResource.data.profile&&(e=this.externalResource.data.profile,Array.isArray(e)&&(e=e.filter((function(e){return e.maxWidth}))[0])&&(t=new a.Size(e.maxWidth,e.maxHeight?e.maxHeight:e.maxWidth))),t},t.prototype.getContent=function(){var e=[],t=this.__jsonld.items||this.__jsonld.content;if(!t)return e;var n=null;if(t.length&&(n=new a.AnnotationPage(t[0],this.options)),!n)return e;for(var i=n.getItems(),r=0;r<i.length;r++){var o=i[r],s=new a.Annotation(o,this.options);e.push(s)}return e},t.prototype.getDuration=function(){return this.getProperty("duration")},t.prototype.getImages=function(){var e=[];if(!this.__jsonld.images)return e;for(var t=0;t<this.__jsonld.images.length;t++){var n=this.__jsonld.images[t],i=new a.Annotation(n,this.options);e.push(i)}return e},t.prototype.getIndex=function(){return this.getProperty("index")},t.prototype.getOtherContent=function(){var e=this,t=(Array.isArray(this.getProperty("otherContent"))?this.getProperty("otherContent"):[this.getProperty("otherContent")]).filter((function(e){return e&&"string"==typeof(t=e["@type"])&&t.toLowerCase()==t.toLowerCase();var t})).map((function(t,n){return new a.AnnotationList(t.label||"Annotation list "+n,t,e.options)})).map((function(e){return e.load()}));return Promise.all(t)},t.prototype.getWidth=function(){return this.getProperty("width")},t.prototype.getHeight=function(){return this.getProperty("height")},t.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},Object.defineProperty(t.prototype,"imageResources",{get:function(){var e=this,n=l.default([this.getImages().map((function(e){return e.getResource()})),this.getContent().map((function(e){return e.getBody()}))]);return s.default(n.map((function(n){switch(n.getProperty("type").toLowerCase()){case o.ExternalResourceType.CHOICE:case o.ExternalResourceType.OA_CHOICE:return new t({images:s.default([n.getProperty("default"),n.getProperty("item")]).map((function(e){return{resource:e}}))},e.options).getImages().map((function(e){return e.getResource()}));default:return n}})))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resourceAnnotations",{get:function(){return l.default([this.getImages(),this.getContent()])},enumerable:!0,configurable:!0}),t.prototype.resourceAnnotation=function(e){return this.resourceAnnotations.find((function(t){return t.getResource().id===e||s.default(new Array(t.getBody())).some((function(t){return t.id===e}))}))},t.prototype.onFragment=function(e){var t=this.resourceAnnotation(e);if(t){var n=t.getProperty("on"),i=t.getProperty("target"),r=(n||i).match(/xywh=(.*)$/);if(r)return r[1].split(",").map((function(e){return parseInt(e,10)}))}},Object.defineProperty(t.prototype,"iiifImageResources",{get:function(){return this.imageResources.filter((function(e){return e&&e.getServices()[0]&&e.getServices()[0].id}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageServiceIds",{get:function(){return this.iiifImageResources.map((function(e){return e.getServices()[0].id}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"aspectRatio",{get:function(){return this.getWidth()/this.getHeight()},enumerable:!0,configurable:!0}),t}(a.Resource);t.Canvas=u},function(e,t,n){var i=n(4);e.exports=function(e){return null!=e&&e.length?i(e,1):[]}},function(e,t){e.exports=function(e,t){for(var n=-1,i=t.length,r=e.length;++n<i;)e[r+n]=t[n];return e}},function(e,t,n){var i=n(2),r=n(24),o=n(29),a=i?i.isConcatSpreadable:void 0;e.exports=function(e){return o(e)||r(e)||!!(a&&e&&e[a])}},function(e,t,n){var i=n(22),r="object"==typeof self&&self&&self.Object===Object&&self,o=i||r||Function("return this")();e.exports=o},function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(this,n(23))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch{"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var i=n(25),r=n(5),o=Object.prototype,a=o.hasOwnProperty,s=o.propertyIsEnumerable,l=i(function(){return arguments}())?i:function(e){return r(e)&&a.call(e,"callee")&&!s.call(e,"callee")};e.exports=l},function(e,t,n){var i=n(26),r=n(5);e.exports=function(e){return r(e)&&"[object Arguments]"==i(e)}},function(e,t,n){var i=n(2),r=n(27),o=n(28),a=i?i.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?r(e):o(e)}},function(e,t,n){var i=n(2),r=Object.prototype,o=r.hasOwnProperty,a=r.toString,s=i?i.toStringTag:void 0;e.exports=function(e){var t=o.call(e,s),n=e[s];try{e[s]=void 0;var i=!0}catch{}var r=a.call(e);return i&&(t?e[s]=n:delete e[s]),r}},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},function(e,t){var n=Array.isArray;e.exports=n},function(e,t,n){var i=n(4);e.exports=function(e){return null!=e&&e.length?i(e,1/0):[]}},function(e,t,n){var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=n(0),s=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.items=[],i._collections=null,i._manifests=null,t.__collection=i,i}return r(t,e),t.prototype.getCollections=function(){return this._collections?this._collections:this._collections=this.items.filter((function(e){return e.isCollection()}))},t.prototype.getManifests=function(){return this._manifests?this._manifests:this._manifests=this.items.filter((function(e){return e.isManifest()}))},t.prototype.getCollectionByIndex=function(e){for(var t,n=this.getCollections(),i=0;i<n.length;i++){var r=n[i];r.index===e&&(t=r)}if(t)return t.options.index=e,t.load();throw new Error("Collection index not found")},t.prototype.getManifestByIndex=function(e){for(var t,n=this.getManifests(),i=0;i<n.length;i++){var r=n[i];r.index===e&&(t=r)}if(t)return t.options.index=e,t.load();throw new Error("Manifest index not found")},t.prototype.getTotalCollections=function(){return this.getCollections().length},t.prototype.getTotalManifests=function(){return this.getManifests().length},t.prototype.getTotalItems=function(){return this.items.length},t.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?this.getProperty("viewingDirection"):o.ViewingDirection.LEFT_TO_RIGHT},t.prototype.getBehavior=function(){var e=this.getProperty("behavior");return Array.isArray(e)&&(e=e[0]),e||null},t.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},t.prototype.getDefaultTree=function(){return e.prototype.getDefaultTree.call(this),this.defaultTree.data.type=a.Utils.normaliseType(a.TreeNodeType.COLLECTION),this._parseManifests(this),this._parseCollections(this),a.Utils.generateTreeNodeIds(this.defaultTree),this.defaultTree},t.prototype._parseManifests=function(e){if(e.getManifests()&&e.getManifests().length)for(var t=0;t<e.getManifests().length;t++){var n=e.getManifests()[t],i=n.getDefaultTree();i.label=n.parentLabel||n.getLabel().getValue(this.options.locale)||"manifest "+(t+1),i.navDate=n.getNavDate(),i.data.id=n.id,i.data.type=a.Utils.normaliseType(a.TreeNodeType.MANIFEST),e.defaultTree.addNode(i)}},t.prototype._parseCollections=function(e){if(e.getCollections()&&e.getCollections().length)for(var t=0;t<e.getCollections().length;t++){var n=e.getCollections()[t],i=n.getDefaultTree();i.label=n.parentLabel||n.getLabel().getValue(this.options.locale)||"collection "+(t+1),i.navDate=n.getNavDate(),i.data.id=n.id,i.data.type=a.Utils.normaliseType(a.TreeNodeType.COLLECTION),e.defaultTree.addNode(i)}},t}(a.IIIFResource);t.Collection=s},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this.start=e,this.end=t}return e.prototype.getLength=function(){return this.end-this.start},e}();t.Duration=i},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=function(){function e(e){this.defaultLocale=e}return e.prototype.parse=function(e){this.resource=e,this.label=i.PropertyValue.parse(this.resource.label,this.defaultLocale),this.value=i.PropertyValue.parse(this.resource.value,this.defaultLocale)},e.prototype.getLabel=function(e){return null===this.label?null:(Array.isArray(e)&&!e.length&&(e=void 0),this.label.getValue(e||this.defaultLocale))},e.prototype.setLabel=function(e){null===this.label&&(this.label=new i.PropertyValue([])),this.label.setValue(e,this.defaultLocale)},e.prototype.getValue=function(e,t){return void 0===t&&(t="<br/>"),null===this.value?null:(Array.isArray(e)&&!e.length&&(e=void 0),this.value.getValue(e||this.defaultLocale,t))},e.prototype.getValues=function(e){return null===this.value?[]:(Array.isArray(e)&&!e.length&&(e=void 0),this.value.getValues(e||this.defaultLocale))},e.prototype.setValue=function(e){null===this.value&&(this.value=new i.PropertyValue([])),this.value.setValue(e,this.defaultLocale)},e}();t.LabelValuePair=r},function(e,t,n){var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.getValue=function(e,t){return e.getValue(t,"<br/>")},t.getValues=function(e,t){return e.getValues(t)},t}(Array);t.LanguageMap=o},function(e,t,n){var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),r=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,r++)i[r]=o[a];return i};Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),s=function(){function e(e,t,n){void 0===n&&(n="none"),Array.isArray(e)&&1===e.length?this._value=e[0]:this._value=e,"none"!==t&&"@none"!==t||(t=void 0),this._locale=t,this._defaultLocale=n}return e.parseV2Value=function(t,n){return"string"==typeof t?new e(t,void 0,n):t["@value"]?new e(t["@value"],t["@language"],n):null},Object.defineProperty(e.prototype,"value",{get:function(){return Array.isArray(this._value)?this._value.join("<br/>"):this._value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"locale",{get:function(){return void 0===this._locale?this._defaultLocale:this._locale},enumerable:!0,configurable:!0}),e.prototype.addValue=function(e){Array.isArray(this._value)||(this._value=[this._value]),Array.isArray(e)?this._value=this._value.concat(e):this._value.push(e)},e}();t.LocalizedValue=s;var l=function(e){function t(n,i){void 0===n&&(n=[]);var r=e.apply(this,n)||this;return r.__proto__=t.prototype,r._defaultLocale=i,r}return r(t,e),t.parse=function(e,n){if(!e)return new t([],n);if(Array.isArray(e)){var i=(r=e.map((function(e){return s.parseV2Value(e,n)})).filter((function(e){return null!==e}))).reduce((function(e,t){var n=t._locale;return n||(n="none"),e[n]?e[n].addValue(t._value):e[n]=t,e}),{});return new t(Object.values(i),n)}return"string"==typeof e?new t([new s(e,void 0,n)],n):e["@language"]||e["@value"]?new t(null!==(r=s.parseV2Value(e))?[r]:[],n):new t(Object.keys(e).map((function(t){var i=e[t];if(!Array.isArray(i))throw new Error("A IIIF v3 localized property value must have an array as the value for a given language.");return new s(i,t,n)})),n);var r},t.prototype.getSuitableLocale=function(e){for(var t=o(this).map((function(e){return e._locale})).filter((function(e){return void 0!==e})),n=function(e){var n=t.find((function(t){return t===e}));if(n)return{value:n}},i=0,r=e;i<r.length;i++){var s=n(r[i]);if("object"==typeof s)return s.value}for(var l=function(e){var n=t.find((function(t){return a.Utils.getInexactLocale(t)===a.Utils.getInexactLocale(e)}));if(n)return{value:n}},u=0,c=e;u<c.length;u++){var p=l(c[u]);if("object"==typeof p)return p.value}},t.prototype.setValue=function(e,t){var n=void 0;if(t){var i=this.getSuitableLocale([t]);i&&(n=this.find((function(e){return e._locale===i})))}else n=this.find((function(e){return void 0===e._locale}));n?n._value=e:this.push(new s(e,t,this._defaultLocale))},t.prototype.getValue=function(e,t){var n=this.getValues(e);return 0===n.length?null:t?n.join(t):n[0]},t.prototype.getValues=function(e){if(!this.length)return[];var t;if(t=e?Array.isArray(e)?e:[e]:[],1===this.length&&void 0===this[0]._locale){var n=this[0]._value;return Array.isArray(n)?n:[n]}var i=this.getSuitableLocale(t);if(i)return n=this.find((function(e){return e._locale===i}))._value,Array.isArray(n)?n:[n];if(!this.find((function(e){return void 0===e._locale})))return n=this[0]._value,Array.isArray(n)?n:[n];var r=this.find((function(e){return void 0===e._locale}));return r?Array.isArray(r._value)?r._value:[r._value]:[]},t}(Array);t.PropertyValue=l},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.CONTINUE=100,t.SWITCHING_PROTOCOLS=101,t.PROCESSING=102,t.OK=200,t.CREATED=201,t.ACCEPTED=202,t.NON_AUTHORITATIVE_INFORMATION=203,t.NO_CONTENT=204,t.RESET_CONTENT=205,t.PARTIAL_CONTENT=206,t.MULTI_STATUS=207,t.MULTIPLE_CHOICES=300,t.MOVED_PERMANENTLY=301,t.MOVED_TEMPORARILY=302,t.SEE_OTHER=303,t.NOT_MODIFIED=304,t.USE_PROXY=305,t.TEMPORARY_REDIRECT=307,t.BAD_REQUEST=400,t.UNAUTHORIZED=401,t.PAYMENT_REQUIRED=402,t.FORBIDDEN=403,t.NOT_FOUND=404,t.METHOD_NOT_ALLOWED=405,t.NOT_ACCEPTABLE=406,t.PROXY_AUTHENTICATION_REQUIRED=407,t.REQUEST_TIME_OUT=408,t.CONFLICT=409,t.GONE=410,t.LENGTH_REQUIRED=411,t.PRECONDITION_FAILED=412,t.REQUEST_ENTITY_TOO_LARGE=413,t.REQUEST_URI_TOO_LARGE=414,t.UNSUPPORTED_MEDIA_TYPE=415,t.REQUESTED_RANGE_NOT_SATISFIABLE=416,t.EXPECTATION_FAILED=417,t.IM_A_TEAPOT=418,t.UNPROCESSABLE_ENTITY=422,t.LOCKED=423,t.FAILED_DEPENDENCY=424,t.UNORDERED_COLLECTION=425,t.UPGRADE_REQUIRED=426,t.PRECONDITION_REQUIRED=428,t.TOO_MANY_REQUESTS=429,t.REQUEST_HEADER_FIELDS_TOO_LARGE=431,t.INTERNAL_SERVER_ERROR=500,t.NOT_IMPLEMENTED=501,t.BAD_GATEWAY=502,t.SERVICE_UNAVAILABLE=503,t.GATEWAY_TIME_OUT=504,t.HTTP_VERSION_NOT_SUPPORTED=505,t.VARIANT_ALSO_NEGOTIATES=506,t.INSUFFICIENT_STORAGE=507,t.BANDWIDTH_LIMIT_EXCEEDED=509,t.NOT_EXTENDED=510,t.NETWORK_AUTHENTICATION_REQUIRED=511},function(e,t,n){e.exports=window.fetch||(window.fetch=n(6).default||n(6))},function(e,t,n){var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=n(0),s=function(e){function t(t,n){var i=e.call(this,t,n)||this;if(i.index=0,i._allRanges=null,i.items=[],i._topRanges=[],i.__jsonld.structures&&i.__jsonld.structures.length)for(var r=i._getTopRanges(),o=0;o<r.length;o++){var a=r[o];i._parseRanges(a,String(o))}return i}return r(t,e),t.prototype.getPosterCanvas=function(){var e=this.getProperty("posterCanvas");return e&&(e=new a.Canvas(e,this.options)),e},t.prototype.getAccompanyingCanvas=function(){var e=this.getProperty("accompanyingCanvas");return e&&(e=new a.Canvas(e,this.options)),e},t.prototype.getBehavior=function(){var e=this.getProperty("behavior");return Array.isArray(e)&&(e=e[0]),e||null},t.prototype.getDefaultTree=function(){if(e.prototype.getDefaultTree.call(this),this.defaultTree.data.type=a.Utils.normaliseType(a.TreeNodeType.MANIFEST),!this.isLoaded)return this.defaultTree;var t=this.getTopRanges();return t.length&&t[0].getTree(this.defaultTree),a.Utils.generateTreeNodeIds(this.defaultTree),this.defaultTree},t.prototype._getTopRanges=function(){var e=[];if(this.__jsonld.structures&&this.__jsonld.structures.length){for(var t=0;t<this.__jsonld.structures.length;t++){var n=this.__jsonld.structures[t];n.viewingHint===o.ViewingHint.TOP&&e.push(n)}if(!e.length){var i={};i.ranges=this.__jsonld.structures,e.push(i)}}return e},t.prototype.getTopRanges=function(){return this._topRanges},t.prototype._getRangeById=function(e){if(this.__jsonld.structures&&this.__jsonld.structures.length)for(var t=0;t<this.__jsonld.structures.length;t++){var n=this.__jsonld.structures[t];if(n["@id"]===e||n.id===e)return n}return null},t.prototype._parseRanges=function(e,t,n){var i,r=null;if("string"==typeof e&&(r=e,e=this._getRangeById(r)),e){(i=new a.Range(e,this.options)).parentRange=n,i.path=t,n?n.items.push(i):this._topRanges.push(i);var o=e.items||e.members;if(o)for(var s=0;s<o.length;s++){var l=o[s];if(l["@type"]&&"sc:range"===l["@type"].toLowerCase()||l.type&&"range"===l.type.toLowerCase())this._parseRanges(l,t+"/"+s,i);else if(l["@type"]&&"sc:canvas"===l["@type"].toLowerCase()||l.type&&"canvas"===l.type.toLowerCase()){i.canvases||(i.canvases=[]);var u=l.id||l["@id"];i.canvases.push(u)}}else if(e.ranges)for(s=0;s<e.ranges.length;s++)this._parseRanges(e.ranges[s],t+"/"+s,i)}else console.warn("Range:",r,"does not exist")},t.prototype.getAllRanges=function(){if(null!=this._allRanges)return this._allRanges;this._allRanges=[];for(var e=this.getTopRanges(),t=function(t){var i=e[t];i.id&&n._allRanges.push(i);var r=function(e,t){e.add(t);var n=t.getRanges();return n.length?n.reduce(r,e):e},o=Array.from(i.getRanges().reduce(r,new Set));n._allRanges=n._allRanges.concat(o)},n=this,i=0;i<e.length;i++)t(i);return this._allRanges},t.prototype.getRangeById=function(e){for(var t=this.getAllRanges(),n=0;n<t.length;n++){var i=t[n];if(i.id===e)return i}return null},t.prototype.getRangeByPath=function(e){for(var t=this.getAllRanges(),n=0;n<t.length;n++){var i=t[n];if(i.path===e)return i}return null},t.prototype.getSequences=function(){if(this.items.length)return this.items;var e=this.__jsonld.mediaSequences||this.__jsonld.sequences;if(e)for(var t=0;t<e.length;t++){var n=e[t],i=new a.Sequence(n,this.options);this.items.push(i)}else this.__jsonld.items&&(i=new a.Sequence(this.__jsonld.items,this.options),this.items.push(i));return this.items},t.prototype.getSequenceByIndex=function(e){return this.getSequences()[e]},t.prototype.getTotalSequences=function(){return this.getSequences().length},t.prototype.getManifestType=function(){var e=this.getService(o.ServiceProfile.UI_EXTENSIONS);return e?e.getProperty("manifestType"):a.ManifestType.EMPTY},t.prototype.isMultiSequence=function(){return this.getTotalSequences()>1},t.prototype.isPagingEnabled=function(){var e=this.getViewingHint();if(e)return e===o.ViewingHint.PAGED;var t=this.getBehavior();return!!t&&t===o.Behavior.PAGED},t.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")},t.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},t}(a.IIIFResource);t.Manifest=s},function(e,t,n){var i;Object.defineProperty(t,"__esModule",{value:!0}),(i=t.ManifestType||(t.ManifestType={})).EMPTY="",i.MANUSCRIPT="manuscript",i.MONOGRAPH="monograph"},function(e,t,n){var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=n(1),s=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i._ranges=null,i.canvases=null,i.items=[],i}return r(t,e),t.prototype.getCanvasIds=function(){return this.__jsonld.canvases?this.__jsonld.canvases:this.canvases?this.canvases:[]},t.prototype.getDuration=function(){if(this.canvases&&this.canvases.length){for(var e=[],t=[],n=0,i=this.canvases;n<i.length;n++)if(d=i[n]){var r=d.match(/(.*)#t=([0-9.]+),?([0-9.]+)?/)||[void 0,d],a=r[1],s=r[2],l=r[3];a&&(e.push(parseFloat(s)),t.push(parseFloat(l)))}if(e.length&&t.length)return new o.Duration(Math.min.apply(Math,e),Math.max.apply(Math,t))}else{e=[],t=[];for(var u=0,c=v=this.getRanges();u<c.length;u++)(_=c[u].getDuration())&&(e.push(_.start),t.push(_.end));if(e.length&&t.length)return new o.Duration(Math.min.apply(Math,e),Math.max.apply(Math,t))}var p,f;if(this.canvases&&this.canvases.length)for(var h=0;h<this.canvases.length;h++){var d=this.canvases[h],g=o.Utils.getTemporalComponent(d);g&&g.length>1&&(0===h&&(p=Number(g[0])),h===this.canvases.length-1&&(f=Number(g[1])))}else{var v=this.getRanges();for(h=0;h<v.length;h++){var _;(_=v[h].getDuration())&&(0===h&&(p=_.start),h===v.length-1&&(f=_.end))}}if(void 0!==p&&void 0!==f)return new o.Duration(p,f)},t.prototype.getRanges=function(){return this._ranges?this._ranges:this._ranges=this.items.filter((function(e){return e.isRange()}))},t.prototype.getBehavior=function(){var e=this.getProperty("behavior");return Array.isArray(e)&&(e=e[0]),e||null},t.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")},t.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},t.prototype.getTree=function(e){e.data=this,this.treeNode=e;var t=this.getRanges();if(t&&t.length)for(var n=0;n<t.length;n++){var i=t[n],r=new o.TreeNode;e.addNode(r),this._parseTreeNode(r,i)}return o.Utils.generateTreeNodeIds(e),e},t.prototype.spansTime=function(e){var t=this.getDuration();return!!(t&&e>=t.start&&e<=t.end)},t.prototype._parseTreeNode=function(e,t){e.label=t.getLabel().getValue(this.options.locale),e.data=t,e.data.type=o.Utils.normaliseType(o.TreeNodeType.RANGE),t.treeNode=e;var n=t.getRanges();if(n&&n.length)for(var i=0;i<n.length;i++){var r=n[i];if(r.getBehavior()!==a.Behavior.NO_NAV){var s=new o.TreeNode;e.addNode(s),this._parseTreeNode(s,r)}}},t}(o.ManifestResource);t.Range=s},function(e,t,n){var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n){return e.call(this,t,n)||this}return r(t,e),t.prototype.getFormat=function(){return this.getProperty("format")},t}(n(0).ManifestResource);t.Rendering=o},function(e,t,n){var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),a=n(0),s=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.items=[],i._thumbnails=null,i}return r(t,e),t.prototype.getCanvases=function(){if(this.items.length)return this.items;var e=this.__jsonld.canvases||this.__jsonld.elements;if(e)for(var t=0;t<e.length;t++){var n=e[t];(i=new a.Canvas(n,this.options)).index=t,this.items.push(i)}else if(this.__jsonld)for(t=0;t<this.__jsonld.length;t++){var i;n=this.__jsonld[t],(i=new a.Canvas(n,this.options)).index=t,this.items.push(i)}return this.items},t.prototype.getCanvasById=function(e){for(var t=0;t<this.getTotalCanvases();t++){var n=this.getCanvasByIndex(t),i=a.Utils.normaliseUrl(n.id);if(a.Utils.normaliseUrl(e)===i)return n}return null},t.prototype.getCanvasByIndex=function(e){return this.getCanvases()[e]},t.prototype.getCanvasIndexById=function(e){for(var t=0;t<this.getTotalCanvases();t++)if(this.getCanvasByIndex(t).id===e)return t;return null},t.prototype.getCanvasIndexByLabel=function(e,t){e=e.trim(),isNaN(e)||(e=parseInt(e,10).toString(),t&&(e+="r"));for(var n,i,r,o=/(\d*)\D+(\d*)/,a=0;a<this.getTotalCanvases();a++){var s=this.getCanvasByIndex(a);if(s.getLabel().getValue(this.options.locale)===e||(n=o.exec(e))&&(i=n[1],(r=n[2])&&new RegExp("^"+i+"\\D+"+r+"$").test(s.getLabel().toString())))return a}return-1},t.prototype.getLastCanvasLabel=function(e){for(var t=this.getTotalCanvases()-1;t>=0;t--){var n=this.getCanvasByIndex(t).getLabel().getValue(this.options.locale);if(e){if(/^[a-zA-Z0-9]*$/.test(n))return n}else if(n)return n}return this.options.defaultLabel},t.prototype.getLastPageIndex=function(){return this.getTotalCanvases()-1},t.prototype.getNextPageIndex=function(e,t){var n;if(t){var i=this.getPagedIndices(e),r=this.getViewingDirection();n=r&&r===o.ViewingDirection.RIGHT_TO_LEFT?i[0]+1:i[i.length-1]+1}else n=e+1;return n>this.getLastPageIndex()?-1:n},t.prototype.getPagedIndices=function(e,t){var n=[];if(t){n=this.isFirstCanvas(e)||this.isLastCanvas(e)?[e]:e%2?[e,e+1]:[e-1,e];var i=this.getViewingDirection();i&&i===o.ViewingDirection.RIGHT_TO_LEFT&&(n=n.reverse())}else n.push(e);return n},t.prototype.getPrevPageIndex=function(e,t){var n;if(t){var i=this.getPagedIndices(e),r=this.getViewingDirection();n=r&&r===o.ViewingDirection.RIGHT_TO_LEFT?i[i.length-1]-1:i[0]-1}else n=e-1;return n},t.prototype.getStartCanvasIndex=function(){var e=this.getStartCanvas();if(e)for(var t=0;t<this.getTotalCanvases();t++)if(this.getCanvasByIndex(t).id===e)return t;return 0},t.prototype.getThumbs=function(e,t){for(var n=[],i=this.getTotalCanvases(),r=0;r<i;r++){var o=this.getCanvasByIndex(r),s=new a.Thumb(e,o);n.push(s)}return n},t.prototype.getThumbnails=function(){if(null!=this._thumbnails)return this._thumbnails;this._thumbnails=[];for(var e=this.getCanvases(),t=0;t<e.length;t++){var n=e[t].getThumbnail();n&&this._thumbnails.push(n)}return this._thumbnails},t.prototype.getStartCanvas=function(){return this.getProperty("startCanvas")},t.prototype.getTotalCanvases=function(){return this.getCanvases().length},t.prototype.getViewingDirection=function(){return this.getProperty("viewingDirection")?this.getProperty("viewingDirection"):this.options.resource.getViewingDirection?this.options.resource.getViewingDirection():null},t.prototype.getViewingHint=function(){return this.getProperty("viewingHint")},t.prototype.isCanvasIndexOutOfRange=function(e){return e>this.getTotalCanvases()-1},t.prototype.isFirstCanvas=function(e){return 0===e},t.prototype.isLastCanvas=function(e){return e===this.getTotalCanvases()-1},t.prototype.isMultiCanvas=function(){return this.getTotalCanvases()>1},t.prototype.isPagingEnabled=function(){var e=this.getViewingHint();return!!e&&e===o.ViewingHint.PAGED},t.prototype.isTotalCanvasesEven=function(){return this.getTotalCanvases()%2==0},t}(a.ManifestResource);t.Sequence=s},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=function(){function e(){}return e.parse=function(e,t){return"string"==typeof e&&(e=JSON.parse(e)),this.parseJson(e,t)},e.parseJson=function(e,t){var n;if(t&&t.navDate&&!isNaN(t.navDate.getTime())&&(e.navDate=t.navDate.toString()),e["@type"])switch(e["@type"]){case"sc:Collection":n=this.parseCollection(e,t);break;case"sc:Manifest":n=this.parseManifest(e,t);break;default:return null}else switch(e.type){case"Collection":n=this.parseCollection(e,t);break;case"Manifest":n=this.parseManifest(e,t);break;default:return null}return n.isLoaded=!0,n},e.parseCollection=function(e,t){var n=new i.Collection(e,t);return t?(n.index=t.index||0,t.resource&&(n.parentCollection=t.resource.parentCollection)):n.index=0,this.parseCollections(n,t),this.parseManifests(n,t),this.parseItems(n,t),n},e.parseCollections=function(e,t){var n;if(e.__jsonld.collections?n=e.__jsonld.collections:e.__jsonld.items&&(n=e.__jsonld.items.filter((function(e){return"collection"===e.type.toLowerCase()}))),n)for(var i=0;i<n.length;i++){t&&(t.index=i);var r=this.parseCollection(n[i],t);r.index=i,r.parentCollection=e,e.items.push(r)}},e.parseManifest=function(e,t){return new i.Manifest(e,t)},e.parseManifests=function(e,t){var n;if(e.__jsonld.manifests?n=e.__jsonld.manifests:e.__jsonld.items&&(n=e.__jsonld.items.filter((function(e){return"manifest"===e.type.toLowerCase()}))),n)for(var i=0;i<n.length;i++){var r=this.parseManifest(n[i],t);r.index=i,r.parentCollection=e,e.items.push(r)}},e.parseItem=function(e,t){if(e["@type"]){if("sc:manifest"===e["@type"].toLowerCase())return this.parseManifest(e,t);if("sc:collection"===e["@type"].toLowerCase())return this.parseCollection(e,t)}else if(e.type){if("manifest"===e.type.toLowerCase())return this.parseManifest(e,t);if("collection"===e.type.toLowerCase())return this.parseCollection(e,t)}return null},e.parseItems=function(e,t){var n=e.__jsonld.members||e.__jsonld.items;if(n)for(var i=function(i){t&&(t.index=i);var o=r.parseItem(n[i],t);return o?e.items.filter((function(e){return e.id===o.id}))[0]?"continue":(o.index=i,o.parentCollection=e,void e.items.push(o)):{value:void 0}},r=this,o=0;o<n.length;o++){var a=i(o);if("object"==typeof a)return a.value}},e}();t.Deserialiser=r},function(e,t,n){var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),a=function(e){function t(t,n){return e.call(this,t,n)||this}return r(t,e),t.prototype.getProfile=function(){var e=this.getProperty("profile");return e||(e=this.getProperty("dcterms:conformsTo")),Array.isArray(e)?e[0]:e},t.prototype.getConfirmLabel=function(){return o.Utils.getLocalisedValue(this.getProperty("confirmLabel"),this.options.locale)},t.prototype.getDescription=function(){return o.Utils.getLocalisedValue(this.getProperty("description"),this.options.locale)},t.prototype.getFailureDescription=function(){return o.Utils.getLocalisedValue(this.getProperty("failureDescription"),this.options.locale)},t.prototype.getFailureHeader=function(){return o.Utils.getLocalisedValue(this.getProperty("failureHeader"),this.options.locale)},t.prototype.getHeader=function(){return o.Utils.getLocalisedValue(this.getProperty("header"),this.options.locale)},t.prototype.getServiceLabel=function(){return o.Utils.getLocalisedValue(this.getProperty("label"),this.options.locale)},t.prototype.getInfoUri=function(){var e=this.id;return e.endsWith("/")||(e+="/"),e+"info.json"},t}(o.ManifestResource);t.Service=a},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.Size=function(e,t){this.width=e,this.height=t}},function(e,t,n){var i;Object.defineProperty(t,"__esModule",{value:!0}),(i=t.StatusCode||(t.StatusCode={}))[i.AUTHORIZATION_FAILED=1]="AUTHORIZATION_FAILED",i[i.FORBIDDEN=2]="FORBIDDEN",i[i.INTERNAL_SERVER_ERROR=3]="INTERNAL_SERVER_ERROR",i[i.RESTRICTED=4]="RESTRICTED"},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.Thumb=function(e,t){this.data=t,this.index=t.index,this.width=e;var n=t.getHeight()/t.getWidth();this.height=n?Math.floor(this.width*n):e,this.uri=t.getCanonicalImageUri(e),this.label=t.getLabel().getValue(),this.viewingHint=t.getViewingHint()}},function(e,t,n){var i,r=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n){return e.call(this,t,n)||this}return r(t,e),t}(n(0).Resource);t.Thumbnail=o},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),r=function(){function e(e,t){this.label=e,this.data=t||{},this.nodes=[]}return e.prototype.addNode=function(e){this.nodes.push(e),e.parentNode=this},e.prototype.isCollection=function(){return this.data.type===i.Utils.normaliseType(i.TreeNodeType.COLLECTION)},e.prototype.isManifest=function(){return this.data.type===i.Utils.normaliseType(i.TreeNodeType.MANIFEST)},e.prototype.isRange=function(){return this.data.type===i.Utils.normaliseType(i.TreeNodeType.RANGE)},e}();t.TreeNode=r},function(e,t,n){var i;Object.defineProperty(t,"__esModule",{value:!0}),(i=t.TreeNodeType||(t.TreeNodeType={})).COLLECTION="collection",i.MANIFEST="manifest",i.RANGE="range"}])},"object"==typeof e&&"object"==typeof t?t.exports=r():"function"==typeof define&&n.amdO?define("manifesto",[],r):"object"==typeof e?e.manifesto=r():i.manifesto=r()})),l=(0,o.b)(((e,t)=>{var i,r;i=window,r=function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t||4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.CONTINUE=100,t.SWITCHING_PROTOCOLS=101,t.PROCESSING=102,t.OK=200,t.CREATED=201,t.ACCEPTED=202,t.NON_AUTHORITATIVE_INFORMATION=203,t.NO_CONTENT=204,t.RESET_CONTENT=205,t.PARTIAL_CONTENT=206,t.MULTI_STATUS=207,t.MULTIPLE_CHOICES=300,t.MOVED_PERMANENTLY=301,t.MOVED_TEMPORARILY=302,t.SEE_OTHER=303,t.NOT_MODIFIED=304,t.USE_PROXY=305,t.TEMPORARY_REDIRECT=307,t.BAD_REQUEST=400,t.UNAUTHORIZED=401,t.PAYMENT_REQUIRED=402,t.FORBIDDEN=403,t.NOT_FOUND=404,t.METHOD_NOT_ALLOWED=405,t.NOT_ACCEPTABLE=406,t.PROXY_AUTHENTICATION_REQUIRED=407,t.REQUEST_TIME_OUT=408,t.CONFLICT=409,t.GONE=410,t.LENGTH_REQUIRED=411,t.PRECONDITION_FAILED=412,t.REQUEST_ENTITY_TOO_LARGE=413,t.REQUEST_URI_TOO_LARGE=414,t.UNSUPPORTED_MEDIA_TYPE=415,t.REQUESTED_RANGE_NOT_SATISFIABLE=416,t.EXPECTATION_FAILED=417,t.IM_A_TEAPOT=418,t.UNPROCESSABLE_ENTITY=422,t.LOCKED=423,t.FAILED_DEPENDENCY=424,t.UNORDERED_COLLECTION=425,t.UPGRADE_REQUIRED=426,t.PRECONDITION_REQUIRED=428,t.TOO_MANY_REQUESTS=429,t.REQUEST_HEADER_FIELDS_TOO_LARGE=431,t.INTERNAL_SERVER_ERROR=500,t.NOT_IMPLEMENTED=501,t.BAD_GATEWAY=502,t.SERVICE_UNAVAILABLE=503,t.GATEWAY_TIME_OUT=504,t.HTTP_VERSION_NOT_SUPPORTED=505,t.VARIANT_ALSO_NEGOTIATES=506,t.INSUFFICIENT_STORAGE=507,t.BANDWIDTH_LIMIT_EXCEEDED=509,t.NOT_EXTENDED=510,t.NETWORK_AUTHENTICATION_REQUIRED=511}])},"object"==typeof e&&"object"==typeof t?t.exports=r():"function"==typeof define&&n.amdO?define("httpstatuscodes",[],r):"object"==typeof e?e.httpstatuscodes=r():i.httpstatuscodes=r()})),u=function(e){this.isVisible=!0;var t=e.target.match(/.*[^n]xyz=(-?\d+(?:\.\d+)?),(-?\d+(?:\.\d+)?),(-?\d+(?:\.\d+)?)/),n=e.target.match(/.*nxyz=(-?\d+(?:\.\d+)?),(-?\d+(?:\.\d+)?),(-?\d+(?:\.\d+)?)/);this.bodyValue=e.bodyValue,this.x=Number(t[1]),this.y=Number(t[2]),this.z=Number(t[3]),this.nx=Number(n[1]),this.ny=Number(n[2]),this.nz=Number(n[3])},c=function(e){var t;this.isVisible=!0,e.on?(t=e.on.match(/.*xywh=(\d*),(\d*),(\d*),(\d*)/),this.chars=e.resource.chars):(t=e.target.match(/.*xywh=(\d*),(\d*),(\d*),(\d*)/),this.chars=e.bodyValue),this.x=Number(t[1]),this.y=Number(t[2]),this.width=Number(t[3]),this.height=Number(t[4])},p=function(){function e(e){this.rects=[],this.points3D=[],this.canvasId=e}return e.prototype.addRect=function(e){var t=new c(e);t.canvasId=this.canvasId,t.canvasIndex=this.canvasIndex,t.index=this.rects.length,this.rects.push(t),this.rects.sort((function(e,t){return e.index-t.index}))},e.prototype.addPoint3D=function(e){var t=new u(e);t.canvasId=this.canvasId,t.canvasIndex=this.canvasIndex,t.index=this.points3D.length,this.points3D.push(t),this.points3D.sort((function(e,t){return e.index-t.index}))},e}(),f=(0,o.c)(s()),h=function(){function e(){this.isEnabled=!1,this.ranges=[],this.canvases=[]}return e.prototype.allCanvasesSelected=function(){return this.canvases.length>0&&this.getAllSelectedCanvases().length===this.canvases.length},e.prototype.allRangesSelected=function(){return this.ranges.length>0&&this.getAllSelectedRanges().length===this.ranges.length},e.prototype.allSelected=function(){return this.allRangesSelected()&&this.allCanvasesSelected()},e.prototype.getAll=function(){return this.canvases.concat(this.ranges)},e.prototype.getAllSelectedCanvases=function(){return this.canvases.filter((function(e){return e.multiSelected}))},e.prototype.getAllSelectedRanges=function(){return this.ranges.filter((function(e){return e.multiSelected}))},e.prototype.getCanvasById=function(e){return this.canvases.filter((function(t){return f.Utils.normaliseUrl(t.id)===f.Utils.normaliseUrl(e)}))[0]},e.prototype.getCanvasesByIds=function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n];t.push(this.getCanvasById(i))}return t},e.prototype.getRangeCanvases=function(e){var t=e.getCanvasIds();return this.getCanvasesByIds(t)},e.prototype.selectAll=function(e){this.selectRanges(this.ranges,e),this.selectCanvases(this.canvases,e)},e.prototype.selectCanvas=function(e,t){this.canvases.filter((function(t){return t.id===e.id}))[0].multiSelected=t},e.prototype.selectAllCanvases=function(e){this.selectCanvases(this.canvases,e)},e.prototype.selectCanvases=function(e,t){for(var n=0;n<e.length;n++){e[n].multiSelected=t}},e.prototype.selectRange=function(e,t){var n=this.ranges.filter((function(t){return t.id===e.id}))[0];n.multiSelected=t;var i=this.getRangeCanvases(n);this.selectCanvases(i,t)},e.prototype.selectAllRanges=function(e){this.selectRanges(this.ranges,e)},e.prototype.selectRanges=function(e,t){for(var n=0;n<e.length;n++){var i=e[n];i.multiSelected=t;var r=this.getCanvasesByIds(i.getCanvasIds());this.selectCanvases(r,t)}},e.prototype.setEnabled=function(e){this.isEnabled=e;for(var t=this.getAll(),n=0;n<t.length;n++){var i=t[n];i.multiSelectEnabled=this.isEnabled,e||(i.multiSelected=!1)}},e}(),d=function(){function e(e,t){this.items=[],this.resource=e,this.label=t}return e.prototype.addItem=function(e){this.items.push(e)},e.prototype.addMetadata=function(e,t){void 0===t&&(t=!1);for(var n=0;n<e.length;n++){var i=e[n];i.isRootLevel=t,this.addItem(i)}},e}();(r=i||(i={})).DATE="date",r.NONE="none";var g=(0,o.c)(a()),v=function(){function e(){}return e.manifestNotLoaded="Manifest has not loaded yet",e}(),_=(0,o.c)(s()),y=function(){return y=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},y.apply(this,arguments)},m=function(){function e(e){this.options=e,this.iiifResource=this.options.iiifResource,this.manifestUri=this.options.manifestUri,this.manifest=this.options.manifest,this.collectionIndex=this.options.collectionIndex||0,this.manifestIndex=this.options.manifestIndex||0,this.sequenceIndex=this.options.sequenceIndex||0,this.canvasIndex=this.options.canvasIndex||0}return e.prototype.getAutoCompleteService=function(){var e=this.getSearchService(),t=null;return e&&((t=e.getService(g.ServiceProfile.SEARCH_0_AUTO_COMPLETE))||(t=e.getService(g.ServiceProfile.SEARCH_1_AUTO_COMPLETE))),t},e.prototype.getAttribution=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);var e=this.manifest.getAttribution();return e?e.getValue(this.options.locale):null},e.prototype.getCanvases=function(){return this.getCurrentSequence().getCanvases()},e.prototype.getCanvasById=function(e){return this.getCurrentSequence().getCanvasById(e)},e.prototype.getCanvasesById=function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n],r=this.getCanvasById(i);r&&t.push(r)}return t},e.prototype.getCanvasByIndex=function(e){return this.getCurrentSequence().getCanvasByIndex(e)},e.prototype.getCanvasIndexById=function(e){return this.getCurrentSequence().getCanvasIndexById(e)},e.prototype.getCanvasIndexByLabel=function(e){var t=this.getManifestType()===_.ManifestType.MANUSCRIPT;return this.getCurrentSequence().getCanvasIndexByLabel(e,t)},e.prototype.getCanvasRange=function(e,t){var n=this.getCanvasRanges(e);if(t){for(var i=0;i<n.length;i++){var r=n[i];if(r.path===t)return r}return null}return n[0]},e.prototype.getCanvasRanges=function(e){if(!this.manifest)throw new Error(v.manifestNotLoaded);return e.ranges||(e.ranges=this.manifest.getAllRanges().filter((function(t){return t.getCanvasIds().some((function(t){return _.Utils.normaliseUrl(t)===_.Utils.normaliseUrl(e.id)}))}))),e.ranges},e.prototype.getCollectionIndex=function(e){if((!e.parentCollection||e.parentCollection.parentCollection)&&e.parentCollection)return e.parentCollection.index},e.prototype.getCurrentCanvas=function(){return this.getCurrentSequence().getCanvasByIndex(this.canvasIndex)},e.prototype.getCurrentSequence=function(){return this.getSequenceByIndex(this.sequenceIndex)},e.prototype.getDescription=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);var e=this.manifest.getDescription();return e?e.getValue(this.options.locale):null},e.prototype.getLabel=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);var e=this.manifest.getLabel();return e?e.getValue(this.options.locale):null},e.prototype.getLastCanvasLabel=function(e){return this.getCurrentSequence().getLastCanvasLabel(e)},e.prototype.getFirstPageIndex=function(){return 0},e.prototype.getLastPageIndex=function(){return this.getTotalCanvases()-1},e.prototype.getLicense=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);return this.manifest.getLicense()},e.prototype.getLogo=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);return this.manifest.getLogo()},e.prototype.getManifestType=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);var e=this.manifest.getManifestType();return e===_.ManifestType.EMPTY&&(e=_.ManifestType.MONOGRAPH),e},e.prototype.getMetadata=function(e){if(!this.manifest)throw new Error(v.manifestNotLoaded);var t=[],n=this.manifest.getMetadata(),i=new d(this.manifest),r=this.options.locale;(n&&n.length&&i.addMetadata(n,!0),this.manifest.getDescription().length)&&((s=new _.LabelValuePair(r)).label=new _.PropertyValue([new _.LocalizedValue("description",r)]),s.value=this.manifest.getDescription(),s.isRootLevel=!0,i.addItem(s));this.manifest.getAttribution().length&&((s=new _.LabelValuePair(r)).label=new _.PropertyValue([new _.LocalizedValue("attribution",r)]),s.value=this.manifest.getAttribution(),s.isRootLevel=!0,i.addItem(s));var o=this.manifest.getLicense();if(o){var a={label:"license",value:e&&e.licenseFormatter?e.licenseFormatter.format(o):o};(s=new _.LabelValuePair(r)).parse(a),s.isRootLevel=!0,i.addItem(s)}if(this.manifest.getLogo()){var s;a={label:"logo",value:'<img alt="logo" src="'+this.manifest.getLogo()+'"/>'};(s=new _.LabelValuePair(r)).parse(a),s.isRootLevel=!0,i.addItem(s)}return t.push(i),e?this._parseMetadataOptions(e,t):t},e.prototype.getAllRequiredStatements=function(){var e=[],t=this.getCurrentRange();if(t){var n=t.getRequiredStatement?t.getRequiredStatement():null;n&&e.push(y(y({},this.parseStatement(n)),{source:"Range"}))}var i=this.getCurrentCanvas();if(i){var r=i.getRequiredStatement?i.getRequiredStatement():null;r&&e.push(y(y({},this.parseStatement(r)),{source:"Canvas"}))}if(this.manifest){var o=this.manifest.getRequiredStatement();o&&o&&e.push(y(y({},this.parseStatement(o)),{source:"Manifest"}))}return e},e.prototype.getMostSpecificRequiredStatement=function(){var e=this.getAllRequiredStatements(),t=e.find((function(e){return"Range"===e.source}));if(t)return t;var n=e.find((function(e){return"Canvas"===e.source}));return n||(e.find((function(e){return"Manifest"===e.source}))||null)},e.prototype.getRequiredStatement=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);var e=this.manifest.getRequiredStatement();return e?this.parseStatement(e):null},e.prototype.parseStatement=function(e){return{label:e.label?e.getLabel():"",value:e.value&&e.value.length?e.getValue():""}},e.prototype._parseMetadataOptions=function(e,t){var n=this.getCurrentSequence(),i=n.getMetadata();if(i&&i.length){var r=new d(n);r.addMetadata(i),t.push(r)}if(e.range){var o=this._getRangeMetadata([],e.range);o=o.reverse(),t=t.concat(o)}if(e.canvases&&e.canvases.length)for(var a=0;a<e.canvases.length;a++){var s=e.canvases[a],l=s.getMetadata();if(l&&l.length){var u=new d(s);u.addMetadata(s.getMetadata()),t.push(u)}for(var c=s.getImages(),p=0;p<c.length;p++){var f=c[p],h=f.getMetadata();if(h&&h.length){var g=new d(f);g.addMetadata(h),t.push(g)}}}return t},e.prototype._getRangeMetadata=function(e,t){var n=t.getMetadata();if(n&&n.length){var i=new d(t);i.addMetadata(n),e.push(i)}else if(t.parentRange)return this._getRangeMetadata(e,t.parentRange);return e},e.prototype.getMultiSelectState=function(){return this._multiSelectState||(this._multiSelectState=new h,this._multiSelectState.ranges=this.getRanges().slice(0),this._multiSelectState.canvases=this.getCurrentSequence().getCanvases().slice(0)),this._multiSelectState},e.prototype.getCurrentRange=function(){return this.rangeId?this.getRangeById(this.rangeId):null},e.prototype.getPosterCanvas=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);return this.manifest.getPosterCanvas()},e.prototype.getAccompanyingCanvas=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);return this.manifest.getAccompanyingCanvas()},e.prototype.getPosterImage=function(){var e=this.getPosterCanvas();if(e){var t=e.getContent();if(t&&t.length)return t[0].getBody()[0].id}return null},e.prototype.getAccompanyingCanvasImage=function(){var e=this.getAccompanyingCanvas();if(e){var t=e.getContent();if(t&&t.length)return t[0].getBody()[0].id}return null},e.prototype.getPreviousRange=function(e){var t=null;if(t=e||this.getCurrentRange()){var n=this.getFlattenedTree();if(n)for(var i=0;i<n.length;i++){var r=n[i];if(r&&r.data.id===t.id){for(;i>0;){return n[--i].data}break}}}return null},e.prototype.getNextRange=function(e){var t=null;if(t=e||this.getCurrentRange()){var n=this.getFlattenedTree();if(n)for(var i=0;i<n.length;i++){var r=n[i];if(r&&r.data.id===t.id){for(;i<n.length-1;){var o=n[++i];if(o.data.canvases&&o.data.canvases.length)return o.data}break}}}return null},e.prototype.getFlattenedTree=function(e){var t=null;return(t=e||this.getTree())?this._flattenTree(t,"nodes"):null},e.prototype._flattenTree=function(e,t){var n=this,i=[e];return e[t]&&e[t].length>0?i.concat(e[t].map((function(e){return n._flattenTree(e,t)})).reduce((function(e,t){return e.concat(t)}),[])):i},e.prototype.getRanges=function(){return this.manifest.getAllRanges()},e.prototype.getRangeByPath=function(e){if(!this.manifest)throw new Error(v.manifestNotLoaded);return this.manifest.getRangeByPath(e)},e.prototype.getRangeById=function(e){if(!this.manifest)throw new Error(v.manifestNotLoaded);return this.manifest.getRangeById(e)},e.prototype.getRangeCanvases=function(e){var t=e.getCanvasIds();return this.getCanvasesById(t)},e.prototype.getRelated=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);return this.manifest.getRelated()},e.prototype.getSearchService=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);var e=this.manifest.getService(g.ServiceProfile.SEARCH_0);return e||(e=this.manifest.getService(g.ServiceProfile.SEARCH_1)),e},e.prototype.getSeeAlso=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);return this.manifest.getSeeAlso()},e.prototype.getSequenceByIndex=function(e){if(!this.manifest)throw new Error(v.manifestNotLoaded);return this.manifest.getSequenceByIndex(e)},e.prototype.getShareServiceUrl=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);var e=null,t=this.manifest.getService(g.ServiceProfile.SHARE_EXTENSIONS);return t&&(t.length&&(t=t[0]),e=t.__jsonld.shareUrl),e},e.prototype._getSortedTreeNodesByDate=function(e,t){var n=this.getFlattenedTree(t);if(n){var i=n.filter((function(e){return e.data.type===_.TreeNodeType.MANIFEST}));this.createDecadeNodes(e,n),this.sortDecadeNodes(e),this.createYearNodes(e,n),this.sortYearNodes(e),this.createMonthNodes(e,i),this.sortMonthNodes(e),this.createDateNodes(e,i),this.pruneDecadeNodes(e)}},e.prototype.getStartCanvasIndex=function(){return this.getCurrentSequence().getStartCanvasIndex()},e.prototype.getThumbs=function(e,t){return this.getCurrentSequence().getThumbs(e,t)},e.prototype.getTopRanges=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);return this.manifest.getTopRanges()},e.prototype.getTotalCanvases=function(){return this.getCurrentSequence().getTotalCanvases()},e.prototype.getTrackingLabel=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);return this.manifest.getTrackingLabel()},e.prototype._getTopRanges=function(){return this.iiifResource.getTopRanges()},e.prototype.getTree=function(e,t){if(void 0===e&&(e=0),void 0===t&&(t=i.NONE),!this.iiifResource)return null;var n;if(this.iiifResource.isCollection())n=this.iiifResource.getDefaultTree();else{var r=this._getTopRanges(),o=new _.TreeNode;if(o.label="root",o.data=this.iiifResource,!r.length)return o;n=r[e].getTree(o)}var a=new _.TreeNode;if(t.toString()===i.DATE.toString())if(this.treeHasNavDates(n))return this._getSortedTreeNodesByDate(a,n),a;return n},e.prototype.treeHasNavDates=function(e){var t=this.getFlattenedTree(e);return!!t&&t.some((function(e){return!isNaN(e.navDate)}))},e.prototype.getViewingDirection=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);var e=this.getCurrentSequence().getViewingDirection();return e||(e=this.manifest.getViewingDirection()),e},e.prototype.getViewingHint=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);var e=this.getCurrentSequence().getViewingHint();return e||(e=this.manifest.getViewingHint()),e},e.prototype.hasParentCollection=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);return!!this.manifest.parentCollection},e.prototype.hasRelatedPage=function(){var e=this.getRelated();return!!e&&(e.length&&(e=e[0]),"text/html"===e.format)},e.prototype.hasResources=function(){return this.getCurrentCanvas().getResources().length>0},e.prototype.isBottomToTop=function(){var e=this.getViewingDirection();return!!e&&e===g.ViewingDirection.BOTTOM_TO_TOP},e.prototype.isCanvasIndexOutOfRange=function(e){return this.getCurrentSequence().isCanvasIndexOutOfRange(e)},e.prototype.isContinuous=function(){var e=this.getViewingHint();return!!e&&e===g.ViewingHint.CONTINUOUS},e.prototype.isFirstCanvas=function(e){return"undefined"!=typeof e?this.getCurrentSequence().isFirstCanvas(e):this.getCurrentSequence().isFirstCanvas(this.canvasIndex)},e.prototype.isHorizontallyAligned=function(){return this.isLeftToRight()||this.isRightToLeft()},e.prototype.isLastCanvas=function(e){return"undefined"!=typeof e?this.getCurrentSequence().isLastCanvas(e):this.getCurrentSequence().isLastCanvas(this.canvasIndex)},e.prototype.isLeftToRight=function(){var e=this.getViewingDirection();return!!e&&e===g.ViewingDirection.LEFT_TO_RIGHT},e.prototype.isMultiCanvas=function(){return this.getCurrentSequence().isMultiCanvas()},e.prototype.isMultiSequence=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);return this.manifest.isMultiSequence()},e.prototype.isPaged=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);var e=this.getViewingHint();return e?e===g.ViewingHint.PAGED:this.manifest.isPagingEnabled()},e.prototype.isPagingAvailable=function(){return this.isPagingEnabled()&&this.getTotalCanvases()>2},e.prototype.isPagingEnabled=function(){if(!this.manifest)throw new Error(v.manifestNotLoaded);return this.manifest.isPagingEnabled()||this.getCurrentSequence().isPagingEnabled()},e.prototype.isRightToLeft=function(){var e=this.getViewingDirection();return!!e&&e===g.ViewingDirection.RIGHT_TO_LEFT},e.prototype.isTopToBottom=function(){var e=this.getViewingDirection();return!!e&&e===g.ViewingDirection.TOP_TO_BOTTOM},e.prototype.isTotalCanvasesEven=function(){return this.getCurrentSequence().isTotalCanvasesEven()},e.prototype.isUIEnabled=function(e){if(!this.manifest)throw new Error(v.manifestNotLoaded);var t=this.manifest.getService(g.ServiceProfile.UI_EXTENSIONS);if(t){var n=t.getProperty("disableUI");if(n&&(-1!==n.indexOf(e)||-1!==n.indexOf(e.toLowerCase())))return!1}return!0},e.prototype.isVerticallyAligned=function(){return this.isTopToBottom()||this.isBottomToTop()},e.prototype.createDateNodes=function(e,t){for(var n=0;n<t.length;n++){var i=t[n],r=this.getNodeYear(i),o=this.getNodeMonth(i),a=new _.TreeNode;a.id=i.id,a.label=this.getNodeDisplayDate(i),a.data=i.data,a.data.type=_.TreeNodeType.MANIFEST,a.data.year=r,a.data.month=o;var s=this.getDecadeNode(e,r);if(s){var l=this.getYearNode(s,r);if(l){var u=this.getMonthNode(l,o);u&&u.addNode(a)}}}},e.prototype.createDecadeNodes=function(e,t){for(var n=0;n<t.length;n++){var i=t[n];if(i.navDate){var r=this.getNodeYear(i),o=Number(r.toString().substr(0,3)+"9");if(!this.getDecadeNode(e,r)){var a=new _.TreeNode;a.label=r+" - "+o,a.navDate=i.navDate,a.data.startYear=r,a.data.endYear=o,e.addNode(a)}}}},e.prototype.createMonthNodes=function(e,t){for(var n=0;n<t.length;n++){var i=t[n];if(i.navDate){var r=this.getNodeYear(i),o=this.getNodeMonth(i),a=this.getDecadeNode(e,r),s=null;if(a&&(s=this.getYearNode(a,r)),a&&s&&!this.getMonthNode(s,o)){var l=new _.TreeNode;l.label=this.getNodeDisplayMonth(i),l.navDate=i.navDate,l.data.year=r,l.data.month=o,s.addNode(l)}}}},e.prototype.createYearNodes=function(e,t){for(var n=0;n<t.length;n++){var i=t[n];if(i.navDate){var r=this.getNodeYear(i),o=this.getDecadeNode(e,r);if(o&&!this.getYearNode(o,r)){var a=new _.TreeNode;a.label=r.toString(),a.navDate=i.navDate,a.data.year=r,o.addNode(a)}}}},e.prototype.getDecadeNode=function(e,t){for(var n=0;n<e.nodes.length;n++){var i=e.nodes[n];if(t>=i.data.startYear&&t<=i.data.endYear)return i}return null},e.prototype.getMonthNode=function(e,t){for(var n=0;n<e.nodes.length;n++){var i=e.nodes[n];if(t===this.getNodeMonth(i))return i}return null},e.prototype.getNodeDisplayDate=function(e){return e.navDate.toDateString()},e.prototype.getNodeDisplayMonth=function(e){return["January","February","March","April","May","June","July","August","September","October","November","December"][e.navDate.getMonth()]},e.prototype.getNodeMonth=function(e){return e.navDate.getMonth()},e.prototype.getNodeYear=function(e){return e.navDate.getFullYear()},e.prototype.getYearNode=function(e,t){for(var n=0;n<e.nodes.length;n++){var i=e.nodes[n];if(t===this.getNodeYear(i))return i}return null},e.prototype.pruneDecadeNodes=function(e){for(var t=[],n=0;n<e.nodes.length;n++){var i=e.nodes[n];i.nodes.length||t.push(i)}for(var r=0;r<t.length;r++){var o=t[r],a=e.nodes.indexOf(o);a>-1&&e.nodes.splice(a,1)}},e.prototype.sortDecadeNodes=function(e){e.nodes=e.nodes.sort((function(e,t){return e.data.startYear-t.data.startYear}))},e.prototype.sortMonthNodes=function(e){for(var t=this,n=0;n<e.nodes.length;n++)for(var i=e.nodes[n],r=0;r<i.nodes.length;r++){var o=i.nodes[r];o.nodes=o.nodes.sort((function(e,n){return t.getNodeMonth(e)-t.getNodeMonth(n)}))}},e.prototype.sortYearNodes=function(e){for(var t=this,n=0;n<e.nodes.length;n++){var i=e.nodes[n];i.nodes=i.nodes.sort((function(e,n){return t.getNodeYear(e)-t.getNodeYear(n)}))}},e}(),E=(0,o.c)(a()),I=(0,o.c)(s()),T=function(){function e(e){this._options=e,this._options.locale=this._options.locale||"en-GB"}return e.prototype.bootstrap=function(e,t){var n=this;return new Promise((function(i,r){e&&t&&(i=e,r=t),I.Utils.loadManifest(n._options.manifestUri).then((function(e){n._loaded(n,e,i,r)}))}))},e.prototype._loaded=function(e,t,n,i){var r=I.Utils.parseManifest(t,{locale:e._options.locale});if(r){e._options.iiifResource||(e._options.iiifResource=r);var o=e._options.collectionIndex,a=e._options.manifestIndex;if(r.getIIIFResourceType()===E.IIIFResourceType.COLLECTION){var s=r.getManifests(),l=r.getCollections();!s.length&&void 0===o&&(o=0),void 0!==o&&l&&l.length?r.getCollectionByIndex(o).then((function(t){t||i("Collection index not found"),0===t.getTotalManifests()&&0===a&&t.getTotalCollections()>0?(e._options.collectionIndex=0,e._options.manifestUri=t.id,e.bootstrap(n,i)):void 0!==a&&t.getManifestByIndex(a).then((function(t){e._options.manifest=t;var i=new m(e._options);n(i)}))})):r.getManifestByIndex(e._options.manifestIndex).then((function(t){e._options.manifest=t;var i=new m(e._options);n(i)}))}else{e._options.manifest=r;var u=new m(e._options);n(u)}}else console.error("Unable to load IIIF resource")},e}(),b=(0,o.c)(a()),A=(0,o.c)(l()),O=(0,o.c)(s()),C=function(){function e(e,t){this.authHoldingPage=null,this.clickThroughService=null,this.externalService=null,this.isProbed=!1,this.isResponseHandled=!1,this.kioskService=null,this.loginService=null,this.logoutService=null,this.probeService=null,this.restrictedService=null,this.tokenService=null,e.externalResource=this,this.dataUri=this._getDataUri(e),this.index=e.index,this.authAPIVersion=t.authApiVersion,this._parseAuthServices(e),this._parseCanvasDimensions(e)}return e.prototype._getImageServiceDescriptor=function(e){for(var t=null,n=0;n<e.length;n++){var i=e[n],r=i.id;r.endsWith("/")||(r+="/"),i.getProfile()&&O.Utils.isImageProfile(i.getProfile())&&(t=r+"info.json")}return t},e.prototype._getDataUri=function(e){var t=e.getContent(),n=e.getImages(),i=null;if(t&&t.length){var r=t[0].getBody();return r.length?(o=r[0].getServices()).length&&(i=this._getImageServiceDescriptor(o))?i:r[0].id:null}if(n&&n.length){var o,a=n[0].getResource();return(o=a.getServices()).length&&(i=this._getImageServiceDescriptor(o))?i:a.id}var s=e.getService(b.ServiceProfile.IXIF);return s?s.getInfoUri():e.id},e.prototype._parseAuthServices=function(e){if(.9===this.authAPIVersion)this.clickThroughService=O.Utils.getService(e,b.ServiceProfile.AUTH_0_CLICK_THROUGH),this.loginService=O.Utils.getService(e,b.ServiceProfile.AUTH_0_LOGIN),this.restrictedService=O.Utils.getService(e,b.ServiceProfile.AUTH_0_RESTRICTED),this.clickThroughService?(this.logoutService=this.clickThroughService.getService(b.ServiceProfile.AUTH_0_LOGOUT),this.tokenService=this.clickThroughService.getService(b.ServiceProfile.AUTH_0_TOKEN)):this.loginService?(this.logoutService=this.loginService.getService(b.ServiceProfile.AUTH_0_LOGOUT),this.tokenService=this.loginService.getService(b.ServiceProfile.AUTH_0_TOKEN)):this.restrictedService&&(this.logoutService=this.restrictedService.getService(b.ServiceProfile.AUTH_0_LOGOUT),this.tokenService=this.restrictedService.getService(b.ServiceProfile.AUTH_0_TOKEN));else{if(void 0!==e.isCanvas&&e.isCanvas()){var t=e.getContent();if(t&&t.length){var n=t[0].getBody();if(n&&n.length)e=n[0]}}this.clickThroughService=O.Utils.getService(e,b.ServiceProfile.AUTH_1_CLICK_THROUGH),this.loginService=O.Utils.getService(e,b.ServiceProfile.AUTH_1_LOGIN),this.externalService=O.Utils.getService(e,b.ServiceProfile.AUTH_1_EXTERNAL),this.kioskService=O.Utils.getService(e,b.ServiceProfile.AUTH_1_KIOSK),this.clickThroughService?(this.logoutService=this.clickThroughService.getService(b.ServiceProfile.AUTH_1_LOGOUT),this.tokenService=this.clickThroughService.getService(b.ServiceProfile.AUTH_1_TOKEN),this.probeService=this.clickThroughService.getService(b.ServiceProfile.AUTH_1_PROBE)):this.loginService?(this.logoutService=this.loginService.getService(b.ServiceProfile.AUTH_1_LOGOUT),this.tokenService=this.loginService.getService(b.ServiceProfile.AUTH_1_TOKEN),this.probeService=O.Utils.getService(e,b.ServiceProfile.AUTH_1_PROBE),this.probeService||(this.probeService=this.loginService.getService(b.ServiceProfile.AUTH_1_PROBE))):this.externalService?(this.logoutService=this.externalService.getService(b.ServiceProfile.AUTH_1_LOGOUT),this.tokenService=this.externalService.getService(b.ServiceProfile.AUTH_1_TOKEN),this.probeService=O.Utils.getService(e,b.ServiceProfile.AUTH_1_PROBE),this.probeService||(this.probeService=this.externalService.getService(b.ServiceProfile.AUTH_1_PROBE))):this.kioskService&&(this.logoutService=this.kioskService.getService(b.ServiceProfile.AUTH_1_LOGOUT),this.tokenService=this.kioskService.getService(b.ServiceProfile.AUTH_1_TOKEN),this.probeService=O.Utils.getService(e,b.ServiceProfile.AUTH_1_PROBE),this.probeService||(this.probeService=this.kioskService.getService(b.ServiceProfile.AUTH_1_PROBE)))}},e.prototype._parseCanvasDimensions=function(e){var t=e.getImages();if(t&&t.length){var n=t[0].getResource();this.width=n.getWidth(),this.height=n.getHeight()}else if((t=e.getContent()).length){var i=t[0].getBody();i.length&&(this.width=i[0].getWidth(),this.height=i[0].getHeight())}},e.prototype._parseDescriptorDimensions=function(e){void 0!==e.width&&(this.width=e.width),void 0!==e.height&&(this.height=e.height)},e.prototype.isAccessControlled=function(){return!!(this.clickThroughService||this.loginService||this.externalService||this.kioskService||this.probeService)},e.prototype.hasServiceDescriptor=function(){return!!this.dataUri&&this.dataUri.endsWith("info.json")},e.prototype.getData=function(e){var t=this;return t.data={},new Promise((function(n,i){if(t.dataUri)if(t.probeService){t.isProbed=!0;var r=new XMLHttpRequest;r.open("GET",t.probeService.id,!0),r.withCredentials=!0,r.onload=function(){var e=JSON.parse(r.responseText);unescape(e.contentLocation)!==t.dataUri?t.status=A.MOVED_TEMPORARILY:t.status=A.OK,n(t)},r.onerror=function(){t.status=r.status,n(t)},r.send()}else{var o="GET";if(!t.hasServiceDescriptor()){if(!t.isAccessControlled())return t.status=A.OK,void n(t);o="HEAD"}var a=new XMLHttpRequest;a.open(o,t.dataUri,!0),e&&a.setRequestHeader("Authorization","Bearer "+e.accessToken),a.onload=function(){if(a.responseText){var e=JSON.parse(a.responseText),i=unescape(e["@id"]);t.data=e,t._parseAuthServices(t.data),t._parseDescriptorDimensions(t.data),i.endsWith("/info.json")&&(i=i.substr(0,i.lastIndexOf("/")));var r=t.dataUri;r&&r.endsWith("/info.json")&&(r=r.substr(0,r.lastIndexOf("/"))),i!==r&&t.loginService?t.status=A.MOVED_TEMPORARILY:t.status=A.OK,n(t)}else t.status=A.OK,n(t)},a.onerror=function(){t.status=a.status,a.responseText&&t._parseAuthServices(JSON.parse(a.responseText)),n(t)},a.send()}else i("There is no dataUri to fetch")}))},e}(),S=function(){function e(e){this.labels=e}return e.prototype.format=function(e){return-1!=e.indexOf("<a")?e:'<a href="'+e+'">'+(this.labels[e]?this.labels[e]:e)+"</a>"},e}(),L=function(e){return new T(e).bootstrap()}}}]);